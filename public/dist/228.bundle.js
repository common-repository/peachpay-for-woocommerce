"use strict";(self.webpackChunkpeachpay_for_woocommerce=self.webpackChunkpeachpay_for_woocommerce||[]).push([[228],{9860:(e,t,n)=>{n.r(t),n.d(t,{createVerifyBuyerDetails:()=>Q,default:()=>E,handleTokenResult:()=>W,initSquarePaymentProvider:()=>E,squarePaymentRequestOptions:()=>O});var a=n(655),r=n(2121),i=n(9276),s=n(7418),c=n(6673),o=n(7462),u=n(9350),l=n(7629),d=n(9970),p=n(8401),h=n(7059),f=n(4241),m=n(4071),y=n(6204),v=n(9545),g=n(1212),b=new Set(["googlepay","applepay","afterpay","cashapp"]);function w(e){var t=this;h.h.subscribe((function(){return(0,a.mG)(t,void 0,void 0,(function(){return(0,a.Jh)(this,(function(t){switch(t.label){case 0:return function(e,t,n){"square"!==e||"payment"!==t&&"returning"!==t?(0,v.HD)(".square-btn-container",(function(e){e.classList.add("hide"),e.classList.remove("active")})):(0,v.HD)(".square-btn-container",(function(e){e.classList.remove("hide")}));"payment"!==t&&"returning"!==t||"square"!==e||"loading"===n?(0,v.HD)(".square-btn",(function(e){e.classList.add("hide")})):b.has(l.hv.selectedProviderMethod())?((0,v.HD)(".square-btn",(function(e){e.classList.add("hide")})),(0,v.HD)(".square-custom-btn-container",(function(e){e.classList.remove("hide")}))):((0,v.HD)(".square-btn",(function(e){e.classList.remove("hide")})),(0,v.HD)(".square-custom-btn-container",(function(e){e.classList.add("hide")})))}(l.hv.selectedProvider(),o.qA.modalUI.page(),o.qA.modalUI.loadingMode()),function(e,t){var n;if("square"!==e)return;"finished"===t?(0,v.HD)(".square-btn",(function(e){e.disabled=!1})):(0,v.HD)(".square-btn",(function(e){e.disabled=!0}));"loading"===t?((0,v.HD)(".pp-btn-spinner-container",(function(e){e.classList.remove("hide")})),(0,v.HD)(".square-custom-btn-container",(function(e){e.classList.add("hide")}))):((0,v.HD)(".pp-btn-spinner-container ",(function(e){e.classList.add("hide")})),(0,v.HD)(".square-custom-btn-container",(function(e){e.classList.remove("hide")})));b.has(l.hv.selectedProviderMethod())?"processing"===t?((0,v.HD)(".pp-btn-spinner-container",(function(e){e.classList.remove("hide")})),"cashapp"!==(null===(n=l.hv.selectedMethodConfiguration())||void 0===n?void 0:n.slug)&&(0,v.HD)(".square-custom-btn-container",(function(e){e.classList.add("hide")}))):((0,v.HD)(".pp-btn-spinner-container",(function(e){e.classList.add("hide")})),(0,v.HD)(".square-custom-btn-container",(function(e){e.classList.remove("hide")}))):"processing"===t?((0,v.HD)(".square-btn > .button-text",(function(e){e.innerHTML=(0,m.M)("Processing")})),(0,v.HD)(".square-btn-spinner",(function(e){e.classList.remove("hide")}))):((0,v.HD)(".square-btn > .button-text",(function(e){e.innerHTML="".concat((0,m.M)("Pay")," ").concat((0,g.o)(c.AQ.total()))})),(0,v.HD)(".square-btn-spinner",(function(e){e.classList.add("hide")})))}(l.hv.selectedProvider(),o.qA.modalUI.loadingMode()),[4,_(e)];case 1:return t.sent(),[2]}}))}))}))}function _(e){return(0,a.mG)(this,void 0,void 0,(function(){var t=this;return(0,a.Jh)(this,(function(n){return"square"!==l.hv.selectedProvider()||Object.entries(e).forEach((function(e){var n=(0,a.CR)(e,2),r=(n[0],n[1]);return(0,a.mG)(t,void 0,void 0,(function(){var e,t,n,i;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return r.state||(r.state={mountTarget:"",attached:!1}),e=function(){if(o.qA.customer.existing())return"#existing-customer-pay-button";if(o.qA.customer.mobile())return"#mobile-customer-pay-button";return"#new-customer-pay-button"}(),r.state.mountTarget&&r.state.mountTarget!==e?[4,null===(t=null==r?void 0:r.detach)||void 0===t?void 0:t.call(r)]:[3,2];case 1:a.sent(),r.state.mountTarget="",a.label=2;case 2:return l.hv.selectedProviderMethod()!==r.config.slug?[3,4]:r.state.mountTarget?[2]:[4,null===(n=null==r?void 0:r.attach)||void 0===n?void 0:n.call(r,e)];case 3:return a.sent(),r.state.mountTarget=e,[3,6];case 4:return r.state.mountTarget?[4,null===(i=null==r?void 0:r.detach)||void 0===i?void 0:i.call(r)]:[2];case 5:a.sent(),r.state.mountTarget="",a.label=6;case 6:return[2]}}))}))})),[2]}))}))}var q=n(3493),k=n(9402),L=n(3176);var x=n(1924);function A(){var e=o.L0.metadata("peachpay_square_afterpay_gateway","title");if(e&&"Afterpay"!==e&&"Clearpay"!==e)return e;switch(d.gx.billing.country()){case"GB":case"ES":case"FR":case"IT":return"Clearpay";default:return"Afterpay"}}const z=n.p+"img/4eb6a57eeeccfe1617eb-cashapp-green.svg",C=n.p+"img/efa03ef0d084294ce629-cashapp-green-logo-only.svg";var H=n(6857),S=n(3041);const T=n.p+"img/d067b36f63345d495b52-apple-pay-button.png";function D(){var e,t,n,r=null,i=((n=document.createElement("div")).innerHTML='<button class="square-apay-btn">\n        <style>\n            .square-apay-btn{\n                background-image: url('.concat(T,");\n                background-color: black;\n                border: none; height: 55px;\n                width: 15rem;\n                background-size: contain;\n                border-radius: 0.2rem;\n                background-position: center;\n            }\n\n            .square-apay-btn:hover{\n                opacity: 0.8;\n            }\n        </style>\n    </button>"),n.querySelector("button")),s={attached:!1,mountTarget:""},c={initialized:!1,name:null!==(e=o.L0.metadata("peachpay_square_applepay_gateway","title"))&&void 0!==e?e:(0,m.M)("Apple Pay"),slug:"applepay",gateway:"peachpay_square_applepay",description:'\n<img style="display: block; text-align: left; height: 1.5rem; " src="'.concat(S,'">\n<p style="text-align: left; margin: 0.5rem 0;">').concat((0,m.M)("Apple Pay selected for checkout."),'</p>\n<hr/>\n<p style="text-align: left; margin: 0.5rem 0 0;" class="muted">').concat((0,m.M)("Another step will appear after submitting your order to complete your purchase details."),"<p>\n    "),reusable:!0,assets:{badge:{src:H},title:{src:S}},defaultCurrency:o.L0.metadata("peachpay_square_applepay_gateway","default_currency"),currencies:null!==(t=o.L0.metadata("peachpay_square_applepay_gateway","supported_currencies"))&&void 0!==t?t:["ALL"]};return{state:s,config:c,activate:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var t,n,i;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:t=e.payments,n=e.paymentRequest,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.applePay(n)];case 2:return r=a.sent(),c.initialized=!0,h.h.dispatch((0,q.s)()),[3,4];case 3:return i=a.sent(),console.error(i),[3,4];case 4:return[2]}}))}))},attach:function(e){s.attached||(s.attached=!0,s.mountTarget=e,(0,v.MW)("".concat(e," .square-custom-btn-container"),(function(e){return e.insertAdjacentElement("afterbegin",i)})))},detach:function(){s.attached&&(s.attached=!1,i.remove())},tokenize:function(){return(0,a.mG)(this,void 0,void 0,(function(){var e,t;return(0,a.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),r?[4,r.tokenize()]:[2,[null,null,{paymentStatus:"creationfailed",note:"Failed to find Apple Pay instance while attempting to tokenize the payment."}]];case 1:return[2,W(n.sent())];case 2:return e=n.sent(),t={paymentStatus:"creationfailed",note:"An unknown exception occured while tokenizing the payment."},e instanceof Error&&(t.note=e.message),[2,[null,null,t]];case 3:return[2]}}))}))}}}var G=n(8883),M=n(5792);var J=n(410),R=n(3172);var P=n(3658);function E(e){return(0,a.mG)(this,void 0,void 0,(function(){var t,n,i,s,u,p,f;return(0,a.Jh)(this,(function(y){switch(y.label){case 0:return t=o.L0.metadata("peachpay_square_gateways","application_id"),n=o.L0.metadata("peachpay_square_gateways","location_id"),i=o.L0.metadata("peachpay_square_gateways","script_src"),t&&n&&i?[4,(0,v.ve)(i,"Square")]:[2];case 1:return y.sent(),window.Square?(s=window.Square.payments(t,n),u=s.paymentRequest(O()),p={Square:window.Square,payments:s,paymentRequest:u},f=function(){var e,t,n={};if(o.L0.enabled("peachpay_square_card_gateway")){var i=function(){var e,t,n={name:null!==(e=o.L0.metadata("peachpay_square_card_gateway","title"))&&void 0!==e?e:(0,m.M)("Card"),slug:"card",gateway:"peachpay_square_card",description:"",reusable:!0,assets:{title:{src:M},badge:{src:G}},defaultCurrency:o.L0.metadata("peachpay_square_card_gateway","default_currency"),currencies:null!==(t=o.L0.metadata("peachpay_square_card_gateway","supported_currencies"))&&void 0!==t?t:["ALL"]},r=null,i=null;return{config:n,activate:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var t,n,s;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return t=e.payments,n={style:{".input-container":{borderWidth:"1px"}}},(0,v.HD)('div.pp-pm-saved-option[data-provider="square"][data-method="card"][data-index=""]',(function(e){e.style.padding="0",e.style.border="unset"})),[4,t.card(n)];case 1:return(r=a.sent()).attach('#pp-pms-new div.pp-pm-saved-option[data-provider="square"][data-method="card"][data-index=""]').catch((function(){})),[4,t.card(n)];case 2:return(i=a.sent()).attach('#pp-pms-existing div.pp-pm-saved-option[data-provider="square"][data-method="card"][data-index=""]').catch((function(){})),s="",h.h.subscribe((function(){var e=l.hv.selectedPaymentMethod();e!==s&&(s=e,null==r||r.recalculateSize(),null==i||i.recalculateSize())})),[2]}}))}))},tokenize:function(e){var t;return(0,a.mG)(this,void 0,void 0,(function(){var n,s,c,u,l,d,p,h,f;return(0,a.Jh)(this,(function(m){switch(m.label){case 0:if(n=e.payments,!(s=o.qA.customer.existing()?i:r))return[2,[null,null,{paymentStatus:"creationfailed",note:"Square Card element not found while attempting to tokenize card."}]];m.label=1;case 1:return m.trys.push([1,3,,4]),[4,s.tokenize()];case 2:return c=m.sent(),[3,4];case 3:return u=m.sent(),[2,[null,null,{paymentStatus:"creationfailed",note:"Square Card element tokenization failed with error: ".concat(u.message)}]];case 4:if(l=(0,a.CR)(W(c),3),d=l[0],l[1],p=l[2],!d)return[2,[null,null,p]];m.label=5;case 5:return m.trys.push([5,7,,8]),[4,n.verifyBuyer(d,Q())];case 6:return h=m.sent(),[2,[d,null!==(t=null==h?void 0:h.token)&&void 0!==t?t:null,{}]];case 7:return f=m.sent(),[2,[null,null,{paymentStatus:"creationfailed",note:"Verifying Square buyer failed with error: ".concat(f.message)}]];case 8:return[2]}}))}))}}}();n.card=i}if(o.L0.enabled("peachpay_square_card_gateway")){var s=function(){var e,t,n=this,i=null,s={attached:!1,mountTarget:""},c={initialized:!1,name:null!==(e=o.L0.metadata("peachpay_square_googlepay_gateway","title"))&&void 0!==e?e:(0,m.M)("Google Pay"),slug:"googlepay",gateway:"peachpay_square_googlepay",description:'\n<img style="display: block; text-align: left; height: 1.5rem; " src="'.concat(R,'">\n<p style="text-align: left; margin: 0.5rem 0;">').concat((0,m.M)("Google Pay selected for checkout."),'</p>\n<hr/>\n<p style="text-align: left; margin: 0.5rem 0 0;" class="muted">').concat((0,m.M)("Another step will appear after submitting your order to complete your purchase details."),"<p>\n    "),reusable:!1,assets:{badge:{src:J},title:{src:R}},defaultCurrency:o.L0.metadata("peachpay_square_googlepay_gateway","default_currency"),currencies:null!==(t=o.L0.metadata("peachpay_square_googlepay_gateway","supported_currencies"))&&void 0!==t?t:["ALL"]},u=function(e,t){return(0,a.mG)(n,void 0,void 0,(function(){var n,r;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:if(s.attached===e&&t===s.mountTarget)return[2];if(s.attached=e,s.mountTarget=t,e)return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,null==i?void 0:i.detach()];case 2:return a.sent(),[3,4];case 3:return n=a.sent(),console.error(n),s.attached=!0,[2];case 4:return(0,v.HD)(".square-googlepay-wrapper").forEach((function(e){e.remove()})),[2];case 5:(0,v.HD)(".square-custom-btn-container").forEach((function(e){var t=document.createElement("div");t.className="square-googlepay-wrapper",t.style.height="100%",e.appendChild(t)})),a.label=6;case 6:return a.trys.push([6,8,,9]),[4,null==i?void 0:i.attach(s.mountTarget+" .square-googlepay-wrapper",{buttonColor:"black",buttonSizeMode:"fill"})];case 7:return a.sent(),[3,9];case 8:return r=a.sent(),console.error(r),(0,v.HD)(".square-googlepay-wrapper").forEach((function(e){e.remove()})),s.attached=!1,(0,L.W4)(r,{mountTarget:t,environment:o.qA.environment}),[3,9];case 9:return[2]}}))}))};return{config:c,activate:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var t,n,s;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:t=e.payments,n=e.paymentRequest,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.googlePay(n)];case 2:return i=a.sent(),c.initialized=!0,h.h.dispatch((0,q.s)()),[3,4];case 3:return s=a.sent(),console.error("Unexpected googlepay initialization error: ".concat((0,r.H)(s))),(0,L.W4)(s,{paymentRequest:e.paymentRequest,environment:o.qA.environment}),[3,4];case 4:return[2]}}))}))},attach:function(e){return(0,a.mG)(this,void 0,void 0,(function(){return(0,a.Jh)(this,(function(t){switch(t.label){case 0:return[4,u(!0,e)];case 1:return t.sent(),[2]}}))}))},detach:function(){return(0,a.mG)(this,void 0,void 0,(function(){return(0,a.Jh)(this,(function(e){switch(e.label){case 0:return[4,u(!1,"")];case 1:return e.sent(),[2]}}))}))},tokenize:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var e,t;return(0,a.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),i?[4,i.tokenize()]:[2,[null,null,{paymentStatus:"creationfailed",note:"Failed to find Google Pay instance while attempting to tokenize the payment."}]];case 1:return[2,W(n.sent())];case 2:return e=n.sent(),t={paymentStatus:"creationfailed",note:"An unknown exception occured while tokenizing the payment."},e instanceof Error&&(t.note=e.message),[2,[null,null,t]];case 3:return[2]}}))}))}}}();n.googlepay=s}if(o.L0.enabled("peachpay_square_applepay_gateway")){var u=D();n.applepay=u}if(o.L0.enabled("peachpay_square_ach_gateway")){var p=function(){var e,t,n=null,r={initialized:!1,name:null!==(e=o.L0.metadata("peachpay_square_ach_gateway","title"))&&void 0!==e?e:(0,m.M)("US Bank Account"),slug:"us_bank_account",gateway:"peachpay_square_ach",description:'\n\t<p style="margin: 0;">\n\t\t'.concat((0,m.M)("After selecting <b>Pay</b> a prompt will appear to select a bank account."),'\n\t</p>\n\t<hr>\n\t<p class="muted" style="margin: 0;">\n\t\t').concat((0,m.M)("Note: Payments may take up to 5 days to complete."),"\n\t</p>\n\t"),reusable:!1,assets:{badge:{src:k},title:{src:k}},defaultCurrency:o.L0.metadata("peachpay_square_ach_gateway","default_currency"),currencies:null!==(t=o.L0.metadata("peachpay_square_ach_gateway","supported_currencies"))&&void 0!==t?t:["ALL"]};return{config:r,activate:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var t,i;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:t=e.payments,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.ach({redirectURI:window.location.href,transactionId:"0"})];case 2:return(n=a.sent()).addEventListener("ontokenization",(function(e){})),r.initialized=!0,h.h.dispatch((0,q.s)()),[3,4];case 3:return i=a.sent(),(0,L.W4)(i,{paymentRequest:e.paymentRequest,environment:o.qA.environment}),[3,4];case 4:return[2]}}))}))},tokenize:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var e,t;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),n?[4,n.tokenize({accountHolderName:d.gx.billing.fullName()})]:[2,[null,null,{paymentStatus:"creationfailed",note:"Failed to find ACH Bank instance while attempting to tokenize the payment."}]];case 1:return[2,W(a.sent())];case 2:return e=a.sent(),t={paymentStatus:"creationfailed",note:"An unknown exception occured while tokenizing the payment."},e instanceof Error&&(t.note=e.message),[2,[null,null,t]];case 3:return[2]}}))}))}}}();n.ach=p}if(o.L0.enabled("peachpay_square_afterpay_gateway")){var f=function(){var e,t,n=this,r=null,i="",s={mountTarget:"",attached:!1},u={initialized:!1,name:A(),slug:"afterpay",gateway:"peachpay_square_afterpay",description:(t=A(),'\n<img style="display: block; text-align: left; height: 1.5rem; " src='.concat(x,'>\n<p style="text-align: left; margin: 0.5rem 0;">').concat(t," ").concat((0,m.M)("selected for checkout."),'</p>\n<hr/>\n<p style="text-align: left; margin: 0.5rem 0 0;" class="muted">').concat((0,m.M)("Another step will appear after submitting your order to complete your purchase details."),"<p>\n    ")),reusable:!1,assets:{title:{src:x},badge:{src:x}},defaultCurrency:o.L0.metadata("peachpay_square_afterpay_gateway","default_currency"),currencies:null!==(e=o.L0.metadata("peachpay_square_afterpay_gateway","supported_currencies"))&&void 0!==e?e:["ALL"]};h.h.subscribe((function(){u.name=A(),(0,v.HD)('.pp-pm-type[data-method="afterpay"][data-provider="square"]',(function(e){var t=e.querySelector("span");t&&(t.innerText=u.name)}))}));var l=function(e){return(0,a.mG)(n,void 0,void 0,(function(){var t,n,l,p,f,m;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:if(t=O(),n=JSON.stringify(t),l=u.initialized,i===n)return[2];if(i=n,!r)return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,r.destroy()];case 2:return a.sent(),[3,4];case 3:return p=a.sent(),console.error(p),[3,4];case 4:r=null,a.label=5;case 5:if(c.AQ.total()<1)return u.initialized=!1,[2];a.label=6;case 6:return a.trys.push([6,9,,10]),f=e.paymentRequest(O()),[4,e.afterpayClearpay(f)];case 7:return r=a.sent(),u.initialized=!0,[4,d(s.attached,s.mountTarget)];case 8:return a.sent(),[3,10];case 9:return m=a.sent(),console.error(m),u.initialized=!1,(0,L.W4)(m,{paymentRequestOptions:t,environment:o.qA.environment}),[3,10];case 10:return l!==u.initialized&&h.h.dispatch((0,q.s)()),[2]}}))}))},d=function(e,t){return(0,a.mG)(n,void 0,void 0,(function(){var n,i;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:if(e===s.attached&&t===s.mountTarget)return[2];if(s.attached=e,s.mountTarget=t,e)return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,null==r?void 0:r.detach()];case 2:return a.sent(),[3,4];case 3:return n=a.sent(),console.error(n),s.attached=!0,[2];case 4:return(0,v.HD)(".square-afterpay-wrapper").forEach((function(e){e.remove()})),[2];case 5:(0,v.HD)(".square-custom-btn-container").forEach((function(e){var t=document.createElement("div");t.className="square-afterpay-wrapper",t.style.width="250px",t.style.height="100%",e.appendChild(t)})),a.label=6;case 6:return a.trys.push([6,8,,9]),[4,null==r?void 0:r.attach(t+" .square-afterpay-wrapper",{buttonColor:"black",buttonType:"checkout_with_afterpay",finalCtaButtonType:"buy_now"})];case 7:return a.sent(),[3,9];case 8:return i=a.sent(),console.error(i),(0,v.HD)(".square-afterpay-wrapper").forEach((function(e){e.remove()})),s.attached=!1,(0,L.W4)(i,{mountTarget:t,environment:o.qA.environment}),[3,9];case 9:return[2]}}))}))};return{state:s,config:u,activate:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var t,n=this;return(0,a.Jh)(this,(function(r){switch(r.label){case 0:return t=e.payments,[4,l(t)];case 1:return r.sent(),h.h.subscribe((function(){return(0,a.mG)(n,void 0,void 0,(function(){return(0,a.Jh)(this,(function(e){switch(e.label){case 0:return"loading"===o.qA.modalUI.loadingMode()?[3,2]:[4,l(t)];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))})),[2]}}))}))},attach:function(e){return(0,a.mG)(this,void 0,void 0,(function(){return(0,a.Jh)(this,(function(t){switch(t.label){case 0:return[4,d(!0,e)];case 1:return t.sent(),[2]}}))}))},detach:function(){return(0,a.mG)(this,void 0,void 0,(function(){return(0,a.Jh)(this,(function(e){switch(e.label){case 0:return[4,d(!1,"")];case 1:return e.sent(),[2]}}))}))},tokenize:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var e,t;return(0,a.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),r?[4,r.tokenize()]:[2,[null,null,{paymentStatus:"creationfailed",note:"Failure processing Afterpay/Clearpay payment."}]];case 1:return[2,W(n.sent())];case 2:return e=n.sent(),t={paymentStatus:"creationfailed",note:"An unknown exception occured while tokenizing the payment."},e instanceof Error&&(t.note=e.message),[2,[null,null,t]];case 3:return[2]}}))}))}}}();n.afterpay=f}if(o.L0.enabled("peachpay_square_cashapp_gateway")){var y=function(){var e,t,n=this,i=null,s="",c={attached:!1,mountTarget:""},u={initialized:!1,name:null!==(e=o.L0.metadata("peachpay_square_cashapp_gateway","title"))&&void 0!==e?e:(0,m.M)("Cash App"),slug:"cashapp",gateway:"peachpay_square_cashapp",description:'\n<img style="display: block; text-align: left; height: 1.5rem; " src='.concat(z,'>\n<p style="text-align: left; margin: 0.5rem 0;">').concat((0,m.M)("Cash App selected for checkout."),'</p>\n<hr/>\n<p style="text-align: left; margin: 0.5rem 0 0;" class="muted">').concat((0,m.M)("After pressing the Cash App button you'll be prompted to scan a QR code or approve the payment through the Cash App mobile app."),"<p>\n    "),reusable:!1,assets:{title:{src:z},badge:{src:C}},defaultCurrency:o.L0.metadata("peachpay_square_cashapp_gateway","default_currency"),currencies:null!==(t=o.L0.metadata("peachpay_square_cashapp_gateway","supported_currencies"))&&void 0!==t?t:["ALL"]},l=null,d=null;function p(e){var t,n;return(0,a.mG)(this,void 0,void 0,(function(){var p,m,y,v,g;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return p=O(),m=JSON.stringify(p),y=u.initialized,s===m?[2]:(s=m,i?[4,i.destroy()]:[3,2]);case 1:a.sent(),i=null,a.label=2;case 2:if(0===parseFloat(p.total.amount))return u.initialized=!1,[2];a.label=3;case 3:return a.trys.push([3,6,,7]),v=e.paymentRequest(O()),[4,e.cashAppPay(v,{redirectURL:window.location.href})];case 4:return(i=a.sent()).addEventListener("ontokenization",(function(e){var t=e.detail;t.tokenResult&&l?l(t.tokenResult):d&&d("An unknown tokenization error occured")})),i.addEventListener("customerDismissed",(function(e){d&&d("Customer closed cashapp popup")})),u.initialized=!0,[4,f(null!==(t=null==c?void 0:c.attached)&&void 0!==t&&t,null!==(n=null==c?void 0:c.mountTarget)&&void 0!==n?n:"")];case 5:return a.sent(),[3,7];case 6:return g=a.sent(),u.initialized=!1,console.error("Unexpected cashapp initialization error: ".concat((0,r.H)(g))),(0,L.W4)(g,{paymentRequestOptions:p,environment:o.qA.environment}),[3,7];case 7:return y!==u.initialized&&h.h.dispatch((0,q.s)()),[2]}}))}))}var f=function(e,t){return(0,a.mG)(n,void 0,void 0,(function(){var n,r;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:if(c.attached===e&&t===c.mountTarget)return[2];if(c.attached=e,c.mountTarget=t,e)return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,null==i?void 0:i.detach()];case 2:return a.sent(),[3,4];case 3:return n=a.sent(),console.error(n),c.attached=!0,[2];case 4:return(0,v.HD)(".square-cashapp-wrapper").forEach((function(e){e.remove()})),[2];case 5:(0,v.HD)(".square-custom-btn-container").forEach((function(e){var t=document.createElement("div");t.className="square-cashapp-wrapper",e.appendChild(t)})),a.label=6;case 6:return a.trys.push([6,8,,9]),[4,null==i?void 0:i.attach(t+" .square-cashapp-wrapper",{shape:"semiround",size:"medium"})];case 7:return a.sent(),[3,9];case 8:return r=a.sent(),c.attached=!1,console.error(r),(0,v.HD)(".square-cashapp-wrapper").forEach((function(e){e.remove()})),(0,L.W4)(r,{mountTarget:t,environment:o.qA.environment}),[3,9];case 9:return[2]}}))}))};return{config:u,activate:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var t,n=this;return(0,a.Jh)(this,(function(r){switch(r.label){case 0:return[4,p(t=e.payments)];case 1:return r.sent(),h.h.subscribe((function(){return(0,a.mG)(n,void 0,void 0,(function(){return(0,a.Jh)(this,(function(e){switch(e.label){case 0:return"loading"===o.qA.modalUI.loadingMode()?[3,2]:[4,p(t)];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))})),[2]}}))}))},attach:function(e){return(0,a.mG)(this,void 0,void 0,(function(){return(0,a.Jh)(this,(function(t){switch(t.label){case 0:return[4,f(!0,e)];case 1:return t.sent(),[2]}}))}))},detach:function(){return(0,a.mG)(this,void 0,void 0,(function(){return(0,a.Jh)(this,(function(e){switch(e.label){case 0:return[4,f(!1,"")];case 1:return e.sent(),[2]}}))}))},tokenize:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var e,t,n,r;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),i?(e=new Promise((function(e,t){l=e,d=t})),t=W,[4,e]):[2,[null,null,{paymentStatus:"creationfailed",note:"Failed to find Cash App instance while attempting to tokenize the payment."}]];case 1:return[2,t.apply(void 0,[a.sent()])];case 2:return n=a.sent(),r={paymentStatus:"creationfailed",note:"An unknown exception occured while tokenizing the payment."},n instanceof Error&&(r.note=n.message),[2,[null,null,r]];case 3:return[2]}}))}))}}}();n.cashapp=y}var g={methods:{}};try{for(var b=(0,a.XA)(Object.entries(n)),w=b.next();!w.done;w=b.next()){var _=(0,a.CR)(w.value,2),H=_[0],S=_[1];g.methods[H]=S.config}}catch(t){e={error:t}}finally{try{w&&!w.done&&(t=b.return)&&t.call(b)}finally{if(e)throw e.error}}return h.h.dispatch((0,l.DK)({square:g})),n}(),[4,N(p,f,e)]):[2];case 2:return y.sent(),function(e){var t=e.paymentRequest,n="";h.h.subscribe((function(){var e=O(),a=JSON.stringify(e);n!==a&&"finished"===o.qA.modalUI.loadingMode()&&"square"===l.hv.selectedProvider()&&(n=a,t.update(e))}))}(p),w(f),h.h.dispatch((0,l.TA)()),[2]}}))}))}function N(e,t,n){return(0,a.mG)(this,void 0,void 0,(function(){var r,s,c,o,u,d,p,h,f=this;return(0,a.Jh)(this,(function(m){switch(m.label){case 0:r=[];try{for(s=(0,a.XA)(Object.entries(t)),c=s.next();!c.done;c=s.next())o=(0,a.CR)(c.value,2),o[0],(u=o[1]).activate&&r.push(null==u?void 0:u.activate(e))}catch(e){p={error:e}}finally{try{c&&!c.done&&(h=s.return)&&h.call(s)}finally{if(p)throw p.error}}m.label=1;case 1:return m.trys.push([1,3,,4]),[4,Promise.all(r)];case 2:return m.sent(),[3,4];case 3:return m.sent(),[3,4];case 4:return d=function(r){return(0,a.mG)(f,void 0,void 0,(function(){var s,c,o,u;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return(0,i.N6)()?(s=r.target,((null==s?void 0:s.closest("button"))||(null===(u=null===(o=null==s?void 0:s.closest("div"))||void 0===o?void 0:o.shadowRoot)||void 0===u?void 0:u.querySelector("button")))&&(c=t[l.hv.selectedProviderMethod()])&&"square"===l.hv.selectedProvider()?[4,I(e,c,n)]:[2]):[2];case 1:return a.sent(),[2]}}))}))},(0,v.HD)(".square-btn",(function(e){e.addEventListener("click",d)})),(0,v.HD)(".square-custom-btn-container",(function(e){e.addEventListener("click",d)})),[2]}}))}))}function I(e,t,n){return(0,a.mG)(this,void 0,void 0,(function(){var i,c,u,f,m,v,g,b,w,_;return(0,a.Jh)(this,(function(q){switch(q.label){case 0:return i="peachpay_square_cashapp"===t.config.gateway,"peachpay_square_cashapp"!==t.config.gateway&&h.h.dispatch((0,o.N5)()),[4,t.tokenize(e)];case 1:return c=a.CR.apply(void 0,[q.sent(),3]),u=c[0],f=c[1],m=c[2],i&&h.h.dispatch((0,o.N5)()),[4,n.startTransaction(t.config.gateway)];case 2:return v=q.sent(),u&&v?[3,4]:((0,P.j1)(m.note),[4,null==v?void 0:v.complete(m)]);case 3:return q.sent(),h.h.dispatch((0,o.tv)()),[2];case 4:return g={peachpay_session_id:p.Z5.sessionId(),peachpay_transaction_id:v.getId(),peachpay_square_source_id:u},f&&(g.peachpay_square_verification_id=f),[4,n.placeOrder(v,g)];case 5:return"failure"!==(b=q.sent()).result?[3,7]:[4,null==v?void 0:v.complete()];case 6:return q.sent(),h.h.dispatch((0,o.tv)()),[2];case 7:h.h.dispatch((0,d.ud)({provider:l.hv.selectedProvider(),method:l.hv.selectedProviderMethod()})),q.label=8;case 8:return q.trys.push([8,10,,12]),[4,(0,s.ll)()];case 9:return q.sent(),[3,12];case 10:return w=q.sent(),console.error(w),[4,v.complete({note:"Failed to update customer in browser :: ".concat((0,r.H)(w))})];case 11:return q.sent(),[3,12];case 12:return(0,y.c)(),_=n.getOrderRedirect(b),window.top?[4,v.complete()]:[3,14];case 13:q.sent(),window.top.location=_,q.label=14;case 14:return[2]}}))}))}function O(){var e,t;return{countryCode:null!==(t=null===(e=u.l9.general.wcLocationInfoData())||void 0===e?void 0:e.store_country)&&void 0!==t?t:"US",currencyCode:u.l9.currency.code(),lineItems:F(),discounts:U(),taxLineItems:[{label:(0,m.M)("Tax"),amount:c.AQ.totalTax().toFixed(2)}],total:{label:(0,m.M)("Total"),amount:c.AQ.total().toFixed(2)}}}function F(){var e,t,n,r=new Array;try{for(var i=(0,a.XA)(c.AQ.contents()),s=i.next();!s.done;s=i.next()){var o=s.value;r.push({label:o.name+" × "+(0,f.Qw)(o),amount:(Number.parseFloat(null!==(n=o.display_price)&&void 0!==n?n:o.price)*(0,f.Qw)(o)).toFixed(2)})}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r}function U(){var e,t,n=new Array;try{for(var r=(0,a.XA)(Object.entries(c.AQ.couponRecord())),i=r.next();!i.done;i=r.next()){var s=(0,a.CR)(i.value,2),o=s[0],u=s[1];u&&n.push({id:o,amount:u.toFixed(2),label:o})}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n}function Q(){var e={addressLines:[d.gx.billing.address1(),d.gx.billing.address2()],city:d.gx.billing.city(),countryCode:d.gx.billing.country(),email:d.gx.billing.email(),familyName:d.gx.billing.lastName(),givenName:d.gx.billing.firstName(),phone:d.gx.billing.phone(),state:d.gx.billing.state(),postalCode:d.gx.billing.postal()};return c.AQ.total()>0?{intent:"CHARGE",currencyCode:u.l9.currency.code(),amount:String(c.AQ.total()),billingContact:e}:{intent:"STORE",billingContact:e}}function W(e){var t=function(){var t="";return e.errors&&Array.isArray(e.errors)&&e.errors.forEach((function(e){t+=e.message+". "})),t};switch(e.status){case"OK":return[e.token,null,{}];case"Cancel":return[null,null,{note:"Customer canceled the Payment. "+t(),paymentStatus:"canceled"}];case"Abort":return[null,null,{note:"Tokenizing the payment method was aborted. "+t(),paymentStatus:"creationfailed"}];case"Error":return[null,null,{note:"Tokenizing the payment method encountered an error. "+t(),paymentStatus:"creationfailed"}];case"Invalid":return[null,null,{note:t(),paymentStatus:"creationfailed"}];default:return[null,null,{note:"Tokenizing the payment method encountered an unknown status. "+t(),paymentStatus:"creationfailed"}]}}},6857:(e,t,n)=>{e.exports=n.p+"img/d0db1eb027413f38ddb3-apple-pay.svg"},8883:(e,t,n)=>{e.exports=n.p+"img/d2a66f3e82ab3efab425-card.svg"},410:(e,t,n)=>{e.exports=n.p+"img/7aba4ceea17fbd040a20-google-pay.svg"},1924:(e,t,n)=>{e.exports=n.p+"img/070ee8f2835a668d3bed-afterpay.svg"},3041:(e,t,n)=>{e.exports=n.p+"img/0a580c7c9daca59b189c-apple-pay.svg"},9402:(e,t,n)=>{e.exports=n.p+"img/e7542fee9125d1af4d23-bank.svg"},5792:(e,t,n)=>{e.exports=n.p+"img/b2c8b12eb49165de87d5-credit-card-regular.svg"},3172:(e,t,n)=>{e.exports=n.p+"img/b6a9922efb467e7f87c3-google-pay.svg"}}]);
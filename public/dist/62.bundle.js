"use strict";(self.webpackChunkpeachpay_for_woocommerce=self.webpackChunkpeachpay_for_woocommerce||[]).push([[62],{6151:(e,t,n)=>{n.r(t),n.d(t,{createVerifyBuyerDetails:()=>Q,default:()=>G,handleTokenResult:()=>U});var a=n(655),r=n(2121),i=n(9276),o=n(9213),s=n(6673),c=n(7462),u=n(9350),l=n(7629),d=n(9970),p=n(8401),h=n(7059),f=n(7022),m=n(4071),y=n(6204),v=n(9545),g=n(1212),b=new Set(["googlepay","applepay","afterpay","cashapp"]);function w(e){h.h.subscribe((function(){!function(e,t,n){"square"!==e||"payment"!==t&&"returning"!==t?(0,v.HD)(".square-btn-container",(function(e){e.classList.add("hide"),e.classList.remove("active")})):(0,v.HD)(".square-btn-container",(function(e){e.classList.remove("hide")}));"payment"!==t&&"returning"!==t||"square"!==e||"loading"===n?(0,v.HD)(".square-btn",(function(e){e.classList.add("hide")})):b.has(l.hv.selectedProviderMethod())?((0,v.HD)(".square-btn",(function(e){e.classList.add("hide")})),(0,v.HD)(".square-custom-btn-container",(function(e){e.classList.remove("hide")}))):((0,v.HD)(".square-btn",(function(e){e.classList.remove("hide")})),(0,v.HD)(".square-custom-btn-container",(function(e){e.classList.add("hide")})))}(l.hv.selectedProvider(),c.qA.modalUI.page(),c.qA.modalUI.loadingMode()),function(e,t){var n;if("square"!==e)return;"finished"===t?(0,v.HD)(".square-btn",(function(e){e.disabled=!1})):(0,v.HD)(".square-btn",(function(e){e.disabled=!0}));"loading"===t?((0,v.HD)(".pp-btn-spinner-container",(function(e){e.classList.remove("hide")})),(0,v.HD)(".square-custom-btn-container",(function(e){e.classList.add("hide")}))):((0,v.HD)(".pp-btn-spinner-container ",(function(e){e.classList.add("hide")})),(0,v.HD)(".square-custom-btn-container",(function(e){e.classList.remove("hide")})));b.has(l.hv.selectedProviderMethod())?"processing"===t?((0,v.HD)(".pp-btn-spinner-container",(function(e){e.classList.remove("hide")})),"cashapp"!==(null===(n=l.hv.selectedMethodConfiguration())||void 0===n?void 0:n.slug)&&(0,v.HD)(".square-custom-btn-container",(function(e){e.classList.add("hide")}))):((0,v.HD)(".pp-btn-spinner-container",(function(e){e.classList.add("hide")})),(0,v.HD)(".square-custom-btn-container",(function(e){e.classList.remove("hide")}))):"processing"===t?((0,v.HD)(".square-btn > .button-text",(function(e){e.innerHTML=(0,m.M)("Processing")})),(0,v.HD)(".square-btn-spinner",(function(e){e.classList.remove("hide")}))):((0,v.HD)(".square-btn > .button-text",(function(e){e.innerHTML="".concat((0,m.M)("Pay")," ").concat((0,g.o)(s.AQ.total()))})),(0,v.HD)(".square-btn-spinner",(function(e){e.classList.add("hide")})))}(l.hv.selectedProvider(),c.qA.modalUI.loadingMode()),function(e){var t,n,r,i,o;if("square"!==l.hv.selectedProvider())return;var s=Object.entries(e).sort((function(e,t){var n,r,i,o,s,c=(0,a.CR)(e,2),u=(c[0],c[1]),l=(0,a.CR)(t,2);l[0];return(null!==(i=null===(r=null===(n=l[1].state)||void 0===n?void 0:n.mountTarget)||void 0===r?void 0:r.length)&&void 0!==i?i:0)-(null!==(s=null===(o=u.state)||void 0===o?void 0:o.mountTarget.length)&&void 0!==s?s:0)}));try{for(var c=(0,a.XA)(s),u=c.next();!u.done;u=c.next()){var d=(0,a.CR)(u.value,2),p=(d[0],d[1]);p.state||(p.state={mountTarget:""});var h=q();if(p.state.mountTarget&&p.state.mountTarget!==h&&(null===(r=null==p?void 0:p.detach)||void 0===r||r.call(p),p.state.mountTarget=""),l.hv.selectedProviderMethod()===p.config.slug){if(p.state.mountTarget)continue;null===(i=null==p?void 0:p.attach)||void 0===i||i.call(p,h),p.state.mountTarget=h}else{if(!p.state.mountTarget)continue;null===(o=null==p?void 0:p.detach)||void 0===o||o.call(p),p.state.mountTarget=""}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}}(e)}))}function q(){return c.qA.customer.existing()?"#existing-customer-pay-button":c.qA.customer.mobile()?"#mobile-customer-pay-button":"#new-customer-pay-button"}var _=n(9536),k=n(3493),x=n(9402);var A=n(1924);function z(){var e=c.L0.metadata("peachpay_square_afterpay_gateway","title");if(e)return e;switch(d.gx.billing.country()){case"GB":case"ES":case"FR":case"IT":return"Clearpay";default:return"Afterpay"}}const S=n.p+"img/4eb6a57eeeccfe1617eb-cashapp-green.svg",L=n.p+"img/efa03ef0d084294ce629-cashapp-green-logo-only.svg";var C=n(6857),H=n(3041);function M(){var e,t,n=null,r=((t=document.createElement("div")).innerHTML="<button class=\"square-apay-btn\">\n        <style>\n            .square-apay-btn{\n                background-image: url('img/apple-pay-button.png');\n                background-color: black;\n                border: none; height: 55px;\n                width: 15rem;\n                background-size: contain;\n                border-radius: 0.2rem;\n                background-position: center;\n            }\n\n            .square-apay-btn:hover{\n                opacity: 0.8;\n            }\n        </style>\n    </button>",t.querySelector("button")),i={initialized:!1,name:null!==(e=c.L0.metadata("peachpay_square_applepay_gateway","title"))&&void 0!==e?e:(0,m.M)("Apple Pay"),slug:"applepay",gateway:"peachpay_square_applepay",description:'\n<img style="display: block; text-align: left; height: 1.5rem; " src="'.concat(H,'">\n<p style="text-align: left; margin: 0.5rem 0;">').concat((0,m.M)("Apple Pay selected for checkout."),'</p>\n<hr/>\n<p style="text-align: left; margin: 0.5rem 0 0;" class="muted">').concat((0,m.M)("Another step will appear after submitting your order to complete your purchase details."),"<p>\n    "),reusable:!0,assets:{badge:{src:C},title:{src:H}}};return{config:i,activate:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var t,r;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:t=e.payments,r=e.paymentRequest,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.applePay(r)];case 2:return n=a.sent(),i.initialized=!0,h.h.dispatch((0,k.s)()),[3,4];case 3:return a.sent(),[3,4];case 4:return[2]}}))}))},attach:function(e){(0,v.MW)("".concat(e," .square-custom-btn-container"),(function(e){return e.insertAdjacentElement("afterbegin",r)}))},detach:function(){r.remove()},tokenize:function(){return(0,a.mG)(this,void 0,void 0,(function(){var e,t;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),n?[4,n.tokenize()]:[2,[null,null,{paymentStatus:"creationfailed",note:"Failed to find Apple Pay instance while attempting to tokenize the payment."}]];case 1:return[2,U(a.sent())];case 2:return e=a.sent(),t={paymentStatus:"creationfailed",note:"An unknown exception occured while tokenizing the payment."},e instanceof Error&&(t.note=e.message),[2,[null,null,t]];case 3:return[2]}}))}))}}}var D=n(8883),R=n(5792);var P=n(410),T=n(3172);function G(e,t){return(0,a.mG)(this,void 0,void 0,(function(){var n,r=this;return(0,a.Jh)(this,(function(i){switch(i.label){case 0:return n=c.qA.isTestOrDevSite()?"https://sandbox.web.squarecdn.com/v1/square.js":"https://web.squarecdn.com/v1/square.js",[4,(0,v.ve)(n,"Square",(function(){return(0,a.mG)(r,void 0,void 0,(function(){var n,r,i,o,s,u,p,f,y,g,b,q;return(0,a.Jh)(this,(function(_){switch(_.label){case 0:return window.Square&&(n=null===(f=null==t?void 0:t.square)||void 0===f?void 0:f.account)?(r=null!==(y=null==t?void 0:t.square.config.application_id)&&void 0!==y?y:"",i=null!==(q=null===(b=null===(g=null==t?void 0:t.square)||void 0===g?void 0:g.account)||void 0===b?void 0:b.location_id)&&void 0!==q?q:"",o=window.Square.payments(r,i),s=o.paymentRequest(F()),u={Square:window.Square,payments:o,paymentRequest:s},p=function(e){var t,n,r={};if(c.L0.enabled("peachpay_square_card_gateway")&&J(e,"card")){var i=function(){var e,t={name:null!==(e=c.L0.metadata("peachpay_square_card_gateway","title"))&&void 0!==e?e:(0,m.M)("Card"),slug:"card",gateway:"peachpay_square_card",description:"",reusable:!0,assets:{title:{src:R},badge:{src:D}}},n=null,r=null;return{config:t,activate:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var t,i,o;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return t=e.payments,i={style:{".input-container":{borderWidth:"1px"}}},(0,v.HD)('div.pp-pm-saved-option[data-provider="square"][data-method="card"][data-index=""]',(function(e){e.style.padding="0",e.style.border="unset"})),[4,t.card(i)];case 1:return(n=a.sent()).attach('#pp-pms-new div.pp-pm-saved-option[data-provider="square"][data-method="card"][data-index=""]').catch((function(){})),[4,t.card(i)];case 2:return(r=a.sent()).attach('#pp-pms-existing div.pp-pm-saved-option[data-provider="square"][data-method="card"][data-index=""]').catch((function(){})),o="",h.h.subscribe((function(){var e=l.hv.selectedPaymentMethod();e!==o&&(o=e,null==n||n.recalculateSize(),null==r||r.recalculateSize())})),[2]}}))}))},tokenize:function(e){var t;return(0,a.mG)(this,void 0,void 0,(function(){var i,o,s,u,l,d,p,h,f;return(0,a.Jh)(this,(function(m){switch(m.label){case 0:if(i=e.payments,!(o=c.qA.customer.existing()?r:n))return[2,[null,null,{paymentStatus:"creationfailed",note:"Square Card element not found while attempting to tokenize card."}]];m.label=1;case 1:return m.trys.push([1,3,,4]),[4,o.tokenize()];case 2:return s=m.sent(),[3,4];case 3:return u=m.sent(),[2,[null,null,{paymentStatus:"creationfailed",note:"Square Card element tokenization failed with error: ".concat(u.message)}]];case 4:if(l=(0,a.CR)(U(s),3),d=l[0],l[1],p=l[2],!d)return[2,[null,null,p]];m.label=5;case 5:return m.trys.push([5,7,,8]),[4,i.verifyBuyer(d,Q())];case 6:return h=m.sent(),[2,[d,null!==(t=null==h?void 0:h.token)&&void 0!==t?t:null,{}]];case 7:return f=m.sent(),[2,[null,null,{paymentStatus:"creationfailed",note:"Verifying Square buyer failed with error: ".concat(f.message)}]];case 8:return[2]}}))}))}}}();r.card=i}if(c.L0.enabled("peachpay_square_card_gateway")&&J(e,"googlepay")){var o=function(){var e,t=null,n={initialized:!1,name:null!==(e=c.L0.metadata("peachpay_square_googlepay_gateway","title"))&&void 0!==e?e:(0,m.M)("Google Pay"),slug:"googlepay",gateway:"peachpay_square_googlepay",description:'\n<img style="display: block; text-align: left; height: 1.5rem; " src="'.concat(T,'">\n<p style="text-align: left; margin: 0.5rem 0;">').concat((0,m.M)("Google Pay selected for checkout."),'</p>\n<hr/>\n<p style="text-align: left; margin: 0.5rem 0 0;" class="muted">').concat((0,m.M)("Another step will appear after submitting your order to complete your purchase details."),"<p>\n    "),reusable:!1,assets:{badge:{src:P},title:{src:T}}};return{config:n,activate:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var r,i;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:r=e.payments,i=e.paymentRequest,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,r.googlePay(i)];case 2:return t=a.sent(),n.initialized=!0,h.h.dispatch((0,k.s)()),[3,4];case 3:return a.sent(),[3,4];case 4:return[2]}}))}))},attach:function(e){null==t||t.attach(e+" .square-custom-btn-container",{buttonColor:"black",buttonSizeMode:"fill"}).catch((function(){}))},detach:function(){null==t||t.detach().catch((function(){}))},tokenize:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var e,n;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t?[4,t.tokenize()]:[2,[null,null,{paymentStatus:"creationfailed",note:"Failed to find Google Pay instance while attempting to tokenize the payment."}]];case 1:return[2,U(a.sent())];case 2:return e=a.sent(),n={paymentStatus:"creationfailed",note:"An unknown exception occured while tokenizing the payment."},e instanceof Error&&(n.note=e.message),[2,[null,null,n]];case 3:return[2]}}))}))}}}();r.googlepay=o}if(c.L0.enabled("peachpay_square_applepay_gateway")&&J(e,"applepay")){var s=M();r.applepay=s}if(c.L0.enabled("peachpay_square_ach_gateway")&&J(e,"ach")){var u=function(){var e,t=null,n={initialized:!1,name:null!==(e=c.L0.metadata("peachpay_square_ach_gateway","title"))&&void 0!==e?e:(0,m.M)("US Bank Account"),slug:"us_bank_account",gateway:"peachpay_square_ach",description:'\n\t<p style="margin: 0;">\n\t\t'.concat((0,m.M)("After selecting <b>Pay</b> a prompt will appear to select a bank account."),'\n\t</p>\n\t<hr>\n\t<p class="muted" style="margin: 0;">\n\t\t').concat((0,m.M)("Note: Payments may take up to 5 days to complete."),"\n\t</p>\n\t"),reusable:!1,assets:{badge:{src:x},title:{src:x}}};return{config:n,activate:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var r;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:r=e.payments,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,r.ach({redirectURI:window.location.href,transactionId:"0"})];case 2:return(t=a.sent()).addEventListener("ontokenization",(function(e){})),n.initialized=!0,h.h.dispatch((0,k.s)()),[3,4];case 3:return a.sent(),[3,4];case 4:return[2]}}))}))},tokenize:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var e,n;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t?[4,t.tokenize({accountHolderName:d.gx.billing.fullName()})]:[2,[null,null,{paymentStatus:"creationfailed",note:"Failed to find ACH Bank instance while attempting to tokenize the payment."}]];case 1:return[2,U(a.sent())];case 2:return e=a.sent(),n={paymentStatus:"creationfailed",note:"An unknown exception occured while tokenizing the payment."},e instanceof Error&&(n.note=e.message),[2,[null,null,n]];case 3:return[2]}}))}))}}}();r.ach=u}if(c.L0.enabled("peachpay_square_afterpay_gateway")&&J(e,"afterpay")){var p=(y=null,g={initialized:!1,name:z(),slug:"afterpay",gateway:"peachpay_square_afterpay",description:(f=z(),'\n<img style="display: block; text-align: left; height: 1.5rem; " src='.concat(A,'>\n<p style="text-align: left; margin: 0.5rem 0;">').concat(f," ").concat((0,m.M)("selected for checkout."),'</p>\n<hr/>\n<p style="text-align: left; margin: 0.5rem 0 0;" class="muted">').concat((0,m.M)("Another step will appear after submitting your order to complete your purchase details."),"<p>\n    ")),reusable:!1,assets:{title:{src:A},badge:{src:A}}},h.h.subscribe((function(){g.name=z(),(0,v.HD)('.pp-pm-type[data-method="afterpay"][data-provider="square"]',(function(e){var t=e.querySelector("span");t&&(t.innerText=g.name)}))})),{config:g,activate:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var t,n;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:t=e.payments,n=e.paymentRequest,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.afterpayClearpay(n)];case 2:return y=a.sent(),g.initialized=!0,h.h.dispatch((0,k.s)()),[3,4];case 3:return a.sent(),[3,4];case 4:return[2]}}))}))},attach:function(e){return(0,a.mG)(this,void 0,void 0,(function(){return(0,a.Jh)(this,(function(t){switch(t.label){case 0:return(0,v.HD)(".square-custom-btn-container").forEach((function(e){var t=document.createElement("div");t.className="square-afterpay-wrapper",t.style.width="250px",t.style.height="100%",e.appendChild(t)})),[4,null==y?void 0:y.attach(e+" .square-afterpay-wrapper",{buttonColor:"black",buttonType:"checkout_with_afterpay",finalCtaButtonType:"buy_now"})];case 1:return t.sent(),[2]}}))}))},detach:function(){return(0,a.mG)(this,void 0,void 0,(function(){return(0,a.Jh)(this,(function(e){switch(e.label){case 0:return[4,null==y?void 0:y.detach()];case 1:return e.sent(),(0,v.HD)(".square-afterpay-wrapper").forEach((function(e){e.remove()})),[2]}}))}))},tokenize:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var e,t;return(0,a.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),y?[4,y.tokenize()]:[2,[null,null,{paymentStatus:"creationfailed",note:"Failed to Afterpay/Clearpay instance while attempting to tokenize the payment."}]];case 1:return[2,U(n.sent())];case 2:return e=n.sent(),t={paymentStatus:"creationfailed",note:"An unknown exception occured while tokenizing the payment."},e instanceof Error&&(t.note=e.message),[2,[null,null,t]];case 3:return[2]}}))}))}});r.afterpay=p}var f,y,g;if(c.L0.enabled("peachpay_square_cashapp_gateway")&&J(e,"cashapp")){var b=function(){var e,t=this,n=null,r={initialized:!1,name:null!==(e=c.L0.metadata("peachpay_square_cashapp_gateway","title"))&&void 0!==e?e:(0,m.M)("Cash App"),slug:"cashapp",gateway:"peachpay_square_cashapp",description:'\n<img style="display: block; text-align: left; height: 1.5rem; " src='.concat(S,'>\n<p style="text-align: left; margin: 0.5rem 0;">').concat((0,m.M)("Cash App selected for checkout."),'</p>\n<hr/>\n<p style="text-align: left; margin: 0.5rem 0 0;" class="muted">').concat((0,m.M)("After pressing the Cash App button you'll be prompted to scan a QR code or approve the payment through the Cash App mobile app."),"<p>\n    "),reusable:!1,assets:{title:{src:S},badge:{src:L}}},i=function(e){return(0,a.mG)(t,void 0,void 0,(function(){return(0,a.Jh)(this,(function(t){switch(t.label){case 0:return[4,null==n?void 0:n.attach(e+" .square-custom-btn-container",{shape:"semiround",size:"medium"})];case 1:return t.sent(),[2]}}))}))},o=null,s=null;function u(e){return(0,a.mG)(this,void 0,void 0,(function(){var t,r;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return t=e.payments,r=e.paymentRequest,[4,t.cashAppPay(r,{redirectURL:window.location.href})];case 1:return(n=a.sent()).addEventListener("ontokenization",(function(e){e.detail.tokenResult&&o?o(e.detail.tokenResult):s&&s("An unknown tokenization error occured")})),[4,i("")];case 2:return a.sent(),[4,n.detach()];case 3:return a.sent(),[2]}}))}))}return{config:r,activate:function(e){return(0,a.mG)(this,void 0,void 0,(function(){return(0,a.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,u(e)];case 1:return t.sent(),r.initialized=!0,h.h.dispatch((0,k.s)()),[3,3];case 2:return t.sent(),[3,3];case 3:return[2]}}))}))},attach:i,detach:function(){return(0,a.mG)(this,void 0,void 0,(function(){return(0,a.Jh)(this,(function(e){switch(e.label){case 0:return s&&s("method detached"),[4,null==n?void 0:n.detach()];case 1:return e.sent(),[2]}}))}))},tokenize:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var e,t,r,i;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),n?(e=new Promise((function(e,t){o=e,s=t})),t=U,[4,e]):[2,[null,null,{paymentStatus:"creationfailed",note:"Failed to find Cash App instance while attempting to tokenize the payment."}]];case 1:return[2,t.apply(void 0,[a.sent()])];case 2:return r=a.sent(),i={paymentStatus:"creationfailed",note:"An unknown exception occured while tokenizing the payment."},r instanceof Error&&(i.note=r.message),[2,[null,null,i]];case 3:return[2]}}))}))}}}();r.cashapp=b}var w={methods:{}};try{for(var q=(0,a.XA)(Object.entries(r)),_=q.next();!_.done;_=q.next()){var C=(0,a.CR)(_.value,2),H=C[0],G=C[1];w.methods[H]=G.config}}catch(e){t={error:e}}finally{try{_&&!_.done&&(n=q.return)&&n.call(q)}finally{if(t)throw t.error}}return h.h.dispatch((0,l.DK)({square:w})),r}(n),[4,E(u,p,e)]):[2];case 1:return _.sent(),function(e){var t=e.paymentRequest,n="";h.h.subscribe((function(){var e=F(),a=JSON.stringify(e);n!==a&&"finished"===c.qA.modalUI.loadingMode()&&"square"===l.hv.selectedProvider()&&(n=a,t.update(e))}))}(u),w(p),h.h.dispatch((0,l.TA)()),[2]}}))}))}))];case 1:return i.sent(),[2]}}))}))}function J(e,t){var n=!1;switch(t){case"cashapp":case"afterpay":case"ach":n=!0;break;case"card":case"applepay":case"googlepay":n=e.capabilities.includes("CREDIT_CARD_PROCESSING");break;default:n=!1}return n}function E(e,t,n){return(0,a.mG)(this,void 0,void 0,(function(){var r,o,s,c,u,d,p,h,f,m=this;return(0,a.Jh)(this,(function(y){switch(y.label){case 0:r=[],o=!1;try{for(s=(0,a.XA)(Object.entries(t)),c=s.next();!c.done;c=s.next())u=(0,a.CR)(c.value,2),u[0],(d=u[1]).activate&&r.push(null==d?void 0:d.activate(e))}catch(e){h={error:e}}finally{try{c&&!c.done&&(f=s.return)&&f.call(s)}finally{if(h)throw h.error}}y.label=1;case 1:return y.trys.push([1,3,,4]),[4,Promise.all(r)];case 2:return y.sent(),[3,4];case 3:return y.sent(),[3,4];case 4:return p=function(r){return(0,a.mG)(m,void 0,void 0,(function(){var s,c,u,d;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return(0,i.N6)()?(s=r.target,((null==s?void 0:s.closest("button"))||(null===(d=null===(u=null==s?void 0:s.closest("div"))||void 0===u?void 0:u.shadowRoot)||void 0===d?void 0:d.querySelector("button")))&&(c=t[l.hv.selectedProviderMethod()])&&"square"===l.hv.selectedProvider()?o?[3,2]:(o=!0,[4,I(e,c,n)]):[2]):[2];case 1:a.sent(),o=!1,a.label=2;case 2:return[2]}}))}))},(0,v.HD)(".square-btn",(function(e){e.addEventListener("click",p)})),(0,v.HD)(".square-custom-btn-container",(function(e){e.addEventListener("click",p)})),[2]}}))}))}function I(e,t,n){var i;return(0,a.mG)(this,void 0,void 0,(function(){var s,u,f,m,v,g,b,w,q;return(0,a.Jh)(this,(function(k){switch(k.label){case 0:return"peachpay_square_cashapp"!==t.config.gateway&&h.h.dispatch((0,c.N5)()),[4,t.tokenize(e)];case 1:return s=a.CR.apply(void 0,[k.sent(),3]),u=s[0],f=s[1],m=s[2],[4,n.startTransaction(t.config.gateway)];case 2:return v=k.sent(),u&&v?[3,4]:("returning"===c.qA.modalUI.page()&&(0,_.yH)("payment"),[4,null==v?void 0:v.complete(m)]);case 3:return k.sent(),h.h.dispatch((0,c.tv)()),[2];case 4:return g={peachpay_session_id:p.Z5.sessionId(),peachpay_transaction_id:v.getId(),peachpay_square_source_id:u},f&&(g.peachpay_square_verification_id=f),[4,n.placeOrder(v,g)];case 5:return"failure"!==(b=k.sent()).result?[3,7]:[4,v.complete({note:"Failed creating square order: "+(null!==(i=b.message)&&void 0!==i?i:"")+(b.stack?"\n"+(0,r.H)(b.stack):"")})];case 6:return k.sent(),h.h.dispatch((0,c.tv)()),[2];case 7:h.h.dispatch((0,d.ud)({provider:l.hv.selectedProvider(),method:l.hv.selectedProviderMethod()})),k.label=8;case 8:return k.trys.push([8,10,,12]),[4,(0,o.ll)()];case 9:return k.sent(),[3,12];case 10:return w=k.sent(),console.error(w),[4,v.complete({note:"Failed to update customer in browser :: ".concat((0,r.H)(w))})];case 11:return k.sent(),[3,12];case 12:return(0,y.c)(),q=n.getOrderRedirect(b),window.top?[4,v.complete()]:[3,14];case 13:k.sent(),window.top.location=q,k.label=14;case 14:return[2]}}))}))}function F(){var e,t;return{countryCode:null!==(t=null===(e=u.l9.general.wcLocationInfoData())||void 0===e?void 0:e.store_country)&&void 0!==t?t:"US",currencyCode:u.l9.currency.code(),lineItems:N(),discounts:O(),taxLineItems:[{label:(0,m.M)("Tax"),amount:s.AQ.totalTax().toFixed(2)}],total:{label:(0,m.M)("Total"),amount:(0===s.AQ.total()?1:s.AQ.total()).toFixed(2)}}}function N(){var e,t,n,r=new Array;try{for(var i=(0,a.XA)(s.AQ.contents()),o=i.next();!o.done;o=i.next()){var c=o.value;r.push({label:c.name+" Ã— "+(0,f.Qw)(c),amount:(Number.parseFloat(null!==(n=c.display_price)&&void 0!==n?n:c.price)*(0,f.Qw)(c)).toFixed(2)})}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r}function O(){var e,t,n=new Array;try{for(var r=(0,a.XA)(Object.entries(s.AQ.couponRecord())),i=r.next();!i.done;i=r.next()){var o=(0,a.CR)(i.value,2),c=o[0],u=o[1];u&&n.push({id:c,amount:u.toFixed(2),label:c})}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n}function Q(){var e={addressLines:[d.gx.billing.address1(),d.gx.billing.address2()],city:d.gx.billing.city(),countryCode:d.gx.billing.country(),email:d.gx.billing.email(),familyName:d.gx.billing.lastName(),givenName:d.gx.billing.firstName(),phone:d.gx.billing.phone(),state:d.gx.billing.state(),postalCode:d.gx.billing.postal()};return s.AQ.total()>0?{intent:"CHARGE",currencyCode:u.l9.currency.code(),amount:String(s.AQ.total()),billingContact:e}:{intent:"STORE",billingContact:e}}function U(e){var t=function(){var t="";return e.errors&&Array.isArray(e.errors)&&e.errors.forEach((function(e){t+=e.message+". "})),t};switch(e.status){case"OK":return[e.token,null,{}];case"Cancel":return[null,null,{note:"Customer canceled the Payment. "+t(),paymentStatus:"canceled"}];case"Abort":return[null,null,{note:"Tokenizing the payment method was aborted. "+t(),paymentStatus:"creationfailed"}];case"Error":return[null,null,{note:"Tokenizing the payment method encountered an error. "+t(),paymentStatus:"creationfailed"}];case"Invalid":return[null,null,{note:t(),paymentStatus:"creationfailed"}];default:return[null,null,{note:"Tokenizing the payment method encountered an unknown status. "+t(),paymentStatus:"creationfailed"}]}}},6857:(e,t,n)=>{e.exports=n.p+"img/d0db1eb027413f38ddb3-apple-pay.svg"},8883:(e,t,n)=>{e.exports=n.p+"img/d2a66f3e82ab3efab425-card.svg"},410:(e,t,n)=>{e.exports=n.p+"img/7aba4ceea17fbd040a20-google-pay.svg"},1924:(e,t,n)=>{e.exports=n.p+"img/070ee8f2835a668d3bed-afterpay.svg"},3041:(e,t,n)=>{e.exports=n.p+"img/0a580c7c9daca59b189c-apple-pay.svg"},9402:(e,t,n)=>{e.exports=n.p+"img/e7542fee9125d1af4d23-bank.svg"},5792:(e,t,n)=>{e.exports=n.p+"img/b2c8b12eb49165de87d5-credit-card-regular.svg"},3172:(e,t,n)=>{e.exports=n.p+"img/b6a9922efb467e7f87c3-google-pay.svg"}}]);
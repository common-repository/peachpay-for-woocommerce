"use strict";(self.webpackChunkpeachpay_for_woocommerce=self.webpackChunkpeachpay_for_woocommerce||[]).push([[565],{2367:(t,e,a)=>{a.r(e),a.d(e,{default:()=>j,paypalDescription:()=>M});var n=a(655),r=a(9350);function i(t){var e="https://www.paypal.com/sdk/js";t.sdkBaseURL&&(e=t.sdkBaseURL,delete t.sdkBaseURL),function(t){var e=t["merchant-id"],a=t["data-merchant-id"],n="",r="";Array.isArray(e)?e.length>1?(n="*",r=e.toString()):n=e.toString():"string"==typeof e&&e.length>0?n=e:"string"==typeof a&&a.length>0&&(n="*",r=a);t["merchant-id"]=n,t["data-merchant-id"]=r}(t);var a=Object.keys(t).filter((function(e){return void 0!==t[e]&&null!==t[e]&&""!==t[e]})).reduce((function(e,a){var n=t[a].toString();return"data-"===a.substring(0,5)?e.dataAttributes[a]=n:e.queryParams[a]=n,e}),{queryParams:{},dataAttributes:{}}),n=a.queryParams,r=a.dataAttributes;return{url:"".concat(e,"?").concat(o(n)),dataAttributes:r}}function o(t){var e="";return Object.keys(t).forEach((function(a){0!==e.length&&(e+="&"),e+=a+"="+t[a]})),e}function l(t,e){void 0===e&&(e={});var a=document.createElement("script");return a.src=t,Object.keys(e).forEach((function(t){a.setAttribute(t,e[t]),"data-csp-nonce"===t&&a.setAttribute("nonce",e["data-csp-nonce"])})),a}function c(t,e){if(void 0===e&&(e=u()),d(t,e),"undefined"==typeof window)return e.resolve(null);var a=i(t),n=a.url,r=a.dataAttributes,o=r["data-namespace"]||"paypal",c=s(o);return function(t,e){var a=document.querySelector('script[src="'.concat(t,'"]'));if(null===a)return null;var n=l(t,e),r=a.cloneNode();if(delete r.dataset.uidAuto,Object.keys(r.dataset).length!==Object.keys(n.dataset).length)return null;var i=!0;return Object.keys(r.dataset).forEach((function(t){r.dataset[t]!==n.dataset[t]&&(i=!1)})),i?a:null}(n,r)&&c?e.resolve(c):function(t,e){void 0===e&&(e=u());d(t,e);var a=t.url,n=t.attributes;if("string"!=typeof a||0===a.length)throw new Error("Invalid url.");if(void 0!==n&&"object"!=typeof n)throw new Error("Expected attributes to be an object.");return new e((function(t,e){if("undefined"==typeof window)return t();!function(t){var e=t.url,a=t.attributes,n=t.onSuccess,r=t.onError,i=l(e,a);i.onerror=r,i.onload=n,document.head.insertBefore(i,document.head.firstElementChild)}({url:a,attributes:n,onSuccess:function(){return t()},onError:function(){var t=new Error('The script "'.concat(a,'" failed to load.'));return window.fetch?fetch(a).then((function(a){return 200===a.status&&e(t),a.text()})).then((function(t){var a=function(t){var e=t.split("/* Original Error:")[1];return e?e.replace(/\n/g,"").replace("*/","").trim():t}(t);e(new Error(a))})).catch((function(t){e(t)})):e(t)}})}))}({url:n,attributes:r},e).then((function(){var t=s(o);if(t)return t;throw new Error("The window.".concat(o," global variable is not available."))}))}function u(){if("undefined"==typeof Promise)throw new Error("Promise is undefined. To resolve the issue, use a Promise polyfill.");return Promise}function s(t){return window[t]}function d(t,e){if("object"!=typeof t||null===t)throw new Error("Expected an options object.");if(void 0!==e&&"function"!=typeof e)throw new Error("Expected PromisePonyfill to be a function.")}var p=a(7462),y=a(7629),h=a(7059),v=a(4071),f=a(9545),m=a(6673);function g(t){h.h.subscribe((function(){var e,a;e=y.hv.selectedProvider(),a=p.qA.modalUI.loadingMode(),"paypal"===e&&"finished"===a&&m.AQ.contents().length>0?((0,f.HD)(".paypal-btn-container",(function(t){t.classList.remove("hide")})),(0,f.HD)(".paypal-spinner-container",(function(t){t.classList.add("hide")}))):"paypal"===e&&m.AQ.contents().length>0?((0,f.HD)(".paypal-btn-container",(function(t){t.classList.add("hide")})),(0,f.HD)(".paypal-spinner-container",(function(t){t.classList.remove("hide")}))):((0,f.HD)(".paypal-btn-container",(function(t){t.classList.add("hide")})),(0,f.HD)(".paypal-spinner-container",(function(t){t.classList.add("hide")}))),function(t){var e,a,r,i,o;if("paypal"!==y.hv.selectedProvider())return;var l=Object.entries(t).sort((function(t,e){var a,r,i,o,l,c=(0,n.CR)(t,2),u=(c[0],c[1]),s=(0,n.CR)(e,2);s[0];return(null!==(i=null===(r=null===(a=s[1].state)||void 0===a?void 0:a.mountTarget)||void 0===r?void 0:r.length)&&void 0!==i?i:0)-(null!==(l=null===(o=u.state)||void 0===o?void 0:o.mountTarget.length)&&void 0!==l?l:0)}));try{for(var c=(0,n.XA)(l),u=c.next();!u.done;u=c.next()){var s=(0,n.CR)(u.value,2),d=(s[0],s[1]);d.state||(d.state={mountTarget:""});var p=_();if(d.state.mountTarget&&d.state.mountTarget!==p&&(null===(r=null==d?void 0:d.detach)||void 0===r||r.call(d),d.state.mountTarget=""),y.hv.selectedProviderMethod()===d.config.slug){if(d.state.mountTarget)continue;null===(i=null==d?void 0:d.attach)||void 0===i||i.call(d,p),d.state.mountTarget=p}else{if(!d.state.mountTarget)continue;null===(o=null==d?void 0:d.detach)||void 0===o||o.call(d),d.state.mountTarget=""}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(e)throw e.error}}}(t)}))}function _(){return p.qA.customer.existing()?"#existing-customer-pay-button .paypal-btn-container":p.qA.customer.mobile()?"#mobile-customer-pay-button .paypal-btn-container":"#new-customer-pay-button .paypal-btn-container"}const b=a.p+"img/173aa60cc278bf30fb32-paypal.svg",w=a.p+"img/8c8968a2f7f7a789c35a-paypal.svg";var P=a(8401),L=a(2121),T=a(7418),C=a(6204),E=a(9970),A=function(){function t(t,e,a){this.paypal=t,this.orderService=e,this.gatewayId=a.gatewayId,this.fundingType=a.fundingType,this.buttonStyle=a.buttonStyle,this.isMounted=!1,this.mountContainer=null,this.currentPaymentDetails=null,this.currentTransaction=null,this.button=this.createButtonComponent()}return t.prototype.isEligible=function(){var t,e;return null!==(e=null===(t=this.button)||void 0===t?void 0:t.isEligible())&&void 0!==e&&e},t.prototype.mount=function(t){var e,a;if(!this.isMounted){var n=(0,f.MW)(t);n&&(this.button||(this.button=this.createButtonComponent()),this.mountContainer?null===(e=this.mountContainer)||void 0===e||e.classList.remove("hide"):(this.mountContainer=document.createElement("div"),n.insertAdjacentElement("beforeend",this.mountContainer),null===(a=this.button)||void 0===a||a.render(this.mountContainer).catch((function(){}))),this.isMounted=!0)}},t.prototype.unmount=function(){var t;this.isMounted&&(null===(t=this.mountContainer)||void 0===t||t.remove(),this.mountContainer=null,this.button=null,this.isMounted=!1)},t.prototype.createButtonComponent=function(){var t,e,a,r=this.orderService,i=this;return null!==(a=null===(e=null===(t=this.paypal)||void 0===t?void 0:t.Buttons)||void 0===e?void 0:e.call(t,{fundingSource:this.fundingType,style:this.buttonStyle,onClick:function(){h.h.dispatch((0,p.N5)())},createOrder:function(t,e){return(0,n.mG)(this,void 0,void 0,(function(){var t,e,a,o,l,c,u,s;return(0,n.Jh)(this,(function(d){switch(d.label){case 0:return t=i,[4,r.startTransaction(i.gatewayId)];case 1:if(t.currentTransaction=d.sent(),!i.currentTransaction)return h.h.dispatch((0,p.tv)()),[2,""];d.label=2;case 2:return d.trys.push([2,8,,10]),[4,r.placeOrder(i.currentTransaction,{peachpay_session_id:P.Z5.sessionId(),peachpay_transaction_id:i.currentTransaction.getId()})];case 3:return"failure"!==(e=d.sent()).result?[3,5]:[4,i.currentTransaction.complete()];case 4:return d.sent(),h.h.dispatch((0,p.tv)()),[2,""];case 5:return a=new URL(e.redirect),o=(0,n.CR)(a.hash.split("="),2),l=o[0],c=o[1],"#payment_data"===l&&c?[3,7]:[4,i.currentTransaction.complete({note:"Failed to retrieve paypal payment details from url: "+e.redirect})];case 6:return d.sent(),h.h.dispatch((0,p.tv)()),[2,""];case 7:return u=JSON.parse(atob(decodeURIComponent(c))),i.currentPaymentDetails=u,[2,u.data.id];case 8:return s=d.sent(),[4,i.currentTransaction.complete({note:"Failed creating paypal order: "+(0,L.H)(s)})];case 9:return d.sent(),[2,""];case 10:return[2]}}))}))},onApprove:function(t,e){var a,r,o,l,c,u;return(0,n.mG)(this,void 0,void 0,(function(){var t,s,d,f,m,g;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return(null===(a=i.currentPaymentDetails)||void 0===a?void 0:a.order_id)?[3,2]:[4,null===(r=i.currentTransaction)||void 0===r?void 0:r.complete({note:'Failed approving paypal order: "Missing payment details"'})];case 1:return n.sent(),e.restart(),h.h.dispatch((0,p.tv)()),[2];case 2:return(t=p.L0.metadata("peachpay_paypal_gateways","approve_order_url"))?[3,4]:[4,null===(o=i.currentTransaction)||void 0===o?void 0:o.complete({note:'Failed approving paypal order: "Missing required approve URL or approve URL security nonce"'})];case 3:return n.sent(),e.restart(),h.h.dispatch((0,p.tv)()),[2];case 4:return(s=new FormData).append("order_id",i.currentPaymentDetails.order_id),[4,fetch(t,{method:"POST",body:s})];case 5:d=n.sent(),n.label=6;case 6:return n.trys.push([6,10,,14]),[4,d.json()];case 7:return(f=n.sent()).success?[3,9]:[4,null===(l=i.currentTransaction)||void 0===l?void 0:l.complete({note:f.message})];case 8:return n.sent(),e.restart(),h.h.dispatch((0,p.tv)()),[2];case 9:return[3,14];case 10:return m=n.sent(),[4,null===(c=e.order)||void 0===c?void 0:c.get()];case 11:return"APPROVED"===(null==(g=n.sent())?void 0:g.status)||"COMPLETED"===(null==g?void 0:g.status)?[3,13]:(h.h.dispatch((0,P.Qe)((0,v.M)("PayPal order failed to finish."))),[4,null===(u=i.currentTransaction)||void 0===u?void 0:u.complete({note:"PayPal order failed to finish: ".concat((0,L.H)(m))})]);case 12:return n.sent(),e.restart(),h.h.dispatch((0,p.tv)()),[2];case 13:return[3,14];case 14:return h.h.dispatch((0,E.ud)({provider:y.hv.selectedProvider(),method:y.hv.selectedProviderMethod()})),(0,T.ll)(),(0,C.c)(),window.top?window.top.location.href=i.currentPaymentDetails.success_url:e.redirect(i.currentPaymentDetails.success_url),[2]}}))}))},onCancel:function(t,e){var a,r;return(0,n.mG)(this,void 0,void 0,(function(){return(0,n.Jh)(this,(function(t){switch(t.label){case 0:return i.currentPaymentDetails?[3,2]:[4,null===(a=i.currentTransaction)||void 0===a?void 0:a.complete({paymentStatus:"CANCELED",orderStatus:"unknown",note:'Payment canceled by customer. Order status "unknown" because of missing payment details.'})];case 1:return t.sent(),h.h.dispatch((0,p.tv)()),[2];case 2:return[4,null===(r=null==i?void 0:i.currentTransaction)||void 0===r?void 0:r.complete({paymentStatus:"CANCELED",orderStatus:"canceled"})];case 3:return t.sent(),function(t){try{var e=new XMLHttpRequest;e.open("GET",t),e.send()}catch(t){}}(i.currentPaymentDetails.cancel_url),h.h.dispatch((0,p.tv)()),[2]}}))}))},onError:function(t){var e;return(0,n.mG)(this,void 0,void 0,(function(){return(0,n.Jh)(this,(function(a){switch(a.label){case 0:return[4,null===(e=i.currentTransaction)||void 0===e?void 0:e.complete({note:(0,L.H)(t)})];case 1:return a.sent(),i.currentTransaction=null,i.currentPaymentDetails=null,h.h.dispatch((0,p.tv)()),[2]}}))}))}}))&&void 0!==a?a:null},t}();var D=a(3493);const S=a.p+"img/cad4a91407099c0b1e1f-paypal-paylater.svg";const k=a.p+"img/2598d60ef6ba61ecf216-venmo.svg",R=a.p+"img/29b34a2d06a2137a30a2-venmo.svg";var O=a(3176);function j(t){return(0,n.mG)(this,void 0,void 0,(function(){var e,a,i,o,l,u,s=this;return(0,n.Jh)(this,(function(d){return p.L0.enabled("peachpay_paypal_gateways")?(e=p.L0.metadata("peachpay_paypal_gateways","client_id"),a=p.L0.metadata("peachpay_paypal_gateways","merchant_id"),i=p.L0.metadata("peachpay_paypal_gateways","partner_attribution_id"),e&&a&&i?(o=function(){var t,e,a={};if(p.L0.enabled("peachpay_paypal_wallet_gateway")){var r=function(){var t,e,a,n=null,r={initialized:!1,name:null!==(t=p.L0.metadata("peachpay_paypal_wallet_gateway","title"))&&void 0!==t?t:"PayPal",gateway:"peachpay_paypal_wallet",description:M("PayPal",w,"After selecting the PayPal button you will be prompted to complete your payment."),slug:"paypal_wallet",assets:{badge:{src:b},title:{src:w}},defaultCurrency:p.L0.metadata("peachpay_paypal_wallet_gateway","default_currency"),currencies:null!==(e=p.L0.metadata("peachpay_paypal_wallet_gateway","supported_currencies"))&&void 0!==e?e:["ALL"]};return{config:r,activate:function(t,e){var a;n=new A(t,e,{gatewayId:"peachpay_paypal_wallet",fundingType:"paypal",buttonStyle:null!==(a=p.L0.metadata("peachpay_paypal_wallet_gateway","button_style"))&&void 0!==a?a:void 0}),r.initialized=n.isEligible(),h.h.dispatch((0,D.s)())},reset:function(){null==n||n.unmount(),n=null,r.initialized=!1,h.h.dispatch((0,D.s)())},attach:function(t){clearInterval(a),a=setInterval((function(){n&&(n.mount(t),clearInterval(a))}),200)},detach:function(){null==n||n.unmount()}}}();a.paypal_wallet=r}if(p.L0.enabled("peachpay_paypal_venmo_gateway")){var i=function(){var t,e,a=null,n={initialized:!1,name:null!==(t=p.L0.metadata("peachpay_paypal_venmo_gateway","title"))&&void 0!==t?t:"Venmo",gateway:"peachpay_paypal_venmo",slug:"venmo",description:M("Venmo",R,"After selecting the Venmo button you will be prompted to complete your payment."),assets:{badge:{src:k},title:{src:R}},defaultCurrency:p.L0.metadata("peachpay_paypal_venmo_gateway","default_currency"),currencies:null!==(e=p.L0.metadata("peachpay_paypal_venmo_gateway","supported_currencies"))&&void 0!==e?e:["ALL"]};return{config:n,activate:function(t,e){var r;a=new A(t,e,{gatewayId:"peachpay_paypal_venmo",fundingType:"venmo",buttonStyle:null!==(r=p.L0.metadata("peachpay_paypal_venmo_gateway","button_style"))&&void 0!==r?r:void 0}),n.initialized=a.isEligible(),h.h.dispatch((0,D.s)())},reset:function(){null==a||a.unmount(),a=null,n.initialized=!1,h.h.dispatch((0,D.s)())},attach:function(t){null==a||a.mount(t)},detach:function(){null==a||a.unmount()}}}();a.venmo=i}if(p.L0.enabled("peachpay_paypal_paylater_gateway")){var o=function(){var t,e,a=null,n={initialized:!1,name:null!==(t=p.L0.metadata("peachpay_paypal_paylater_gateway","title"))&&void 0!==t?t:"PayPal Pay Later",gateway:"peachpay_paypal_paylater",description:M("PayPal Pay Later",S,"After selecting the PayPal Pay Later button you will be prompted to complete your payment."),slug:"paypal_paylater",assets:{badge:{src:b},title:{src:S}},defaultCurrency:p.L0.metadata("peachpay_paypal_paylater_gateway","default_currency"),currencies:null!==(e=p.L0.metadata("peachpay_paypal_paylater_gateway","supported_currencies"))&&void 0!==e?e:["ALL"]};return{config:n,activate:function(t,e){var r;a=new A(t,e,{gatewayId:"peachpay_paypal_paylater",fundingType:"paylater",buttonStyle:null!==(r=p.L0.metadata("peachpay_paypal_paylater_gateway","button_style"))&&void 0!==r?r:void 0}),n.initialized=a.isEligible(),h.h.dispatch((0,D.s)())},reset:function(){null==a||a.unmount(),a=null,n.initialized=!1,h.h.dispatch((0,D.s)())},attach:function(t){null==a||a.mount(t)},detach:function(){null==a||a.unmount()}}}();a.paypal_paylater=o}if(p.L0.enabled("peachpay_paypal_credit_gateway")){var l=function(){var t,e,a=null,n={initialized:!1,name:null!==(t=p.L0.metadata("peachpay_paypal_credit_gateway","title"))&&void 0!==t?t:"PayPal Credit",slug:"paypal_credit",gateway:"peachpay_paypal_credit",description:M("PayPal Credit",w,"After selecting the PayPal Credit button you will be prompted to complete your payment."),assets:{badge:{src:b},title:{src:w}},defaultCurrency:p.L0.metadata("peachpay_paypal_credit_gateway","default_currency"),currencies:null!==(e=p.L0.metadata("peachpay_paypal_credit_gateway","supported_currencies"))&&void 0!==e?e:["ALL"]};return{config:n,activate:function(t,e){var r;a=new A(t,e,{gatewayId:"peachpay_paypal_credit",fundingType:"credit",buttonStyle:null!==(r=p.L0.metadata("peachpay_paypal_credit_gateway","button_style"))&&void 0!==r?r:void 0}),n.initialized=a.isEligible(),h.h.dispatch((0,D.s)())},reset:function(){null==a||a.unmount(),a=null,n.initialized=!1,h.h.dispatch((0,D.s)())},attach:function(t){null==a||a.mount(t)},detach:function(){null==a||a.unmount()}}}();a.paypal_credit=l}var c={methods:{}};try{for(var u=(0,n.XA)(Object.entries(a)),s=u.next();!s.done;s=u.next()){var d=(0,n.CR)(s.value,2),v=d[0],f=d[1];c.methods[v]=f.config}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}return h.h.dispatch((0,y.DK)({paypal:c})),a}(),g(o),l=new Set(["USD","AUD","BRL","CAD","CZK","DKK","EUR","HKD","HUF","ILS","JPY","MYR","MXN","TWD","NZD","NOK","PHP","PLN","GBP","RUB","SGD","SEK","CHF","THB"]),u="",h.h.subscribe((function(){return(0,n.mG)(s,void 0,void 0,(function(){var s,d,p,y,h,v,f,m,g;return(0,n.Jh)(this,(function(_){switch(_.label){case 0:if((s=r.l9.currency.code())===u)return[2];u=s;try{for(d=(0,n.XA)(Object.entries(o)),p=d.next();!p.done;p=d.next())y=(0,n.CR)(p.value,2),y[0],(h=y[1]).reset(),h.state=void 0}catch(t){m={error:t}}finally{try{p&&!p.done&&(g=d.return)&&g.call(d)}finally{if(m)throw m.error}}if(!l.has(s))return[2];_.label=1;case 1:return _.trys.push([1,4,,5]),[4,c({"client-id":e,"merchant-id":a,"data-partner-attribution-id":i,"enable-funding":"venmo",currency:r.l9.currency.code(),"data-page-type":"checkout"})];case 2:return(v=_.sent())?[4,x(v,o,t)]:[2];case 3:return _.sent(),[3,5];case 4:return f=_.sent(),(0,O.W4)(new Error("PayPal SDK failed to load"),{error:f}),[3,5];case 5:return[2]}}))}))})),[2]):[2]):[2]}))}))}function x(t,e,a){return(0,n.mG)(this,void 0,void 0,(function(){var r,i,o,l,c,u,s;return(0,n.Jh)(this,(function(d){switch(d.label){case 0:r=[];try{for(i=(0,n.XA)(Object.entries(e)),o=i.next();!o.done;o=i.next())l=(0,n.CR)(o.value,2),l[0],(c=l[1]).activate&&r.push(c.activate(t,a))}catch(t){u={error:t}}finally{try{o&&!o.done&&(s=i.return)&&s.call(i)}finally{if(u)throw u.error}}return[4,Promise.all(r)];case 1:return d.sent(),[2]}}))}))}function M(t,e,a){return'\n    <img style="display: block; text-align: left; height: 1.7rem; " src="'.concat(e,'">\n    <p style="text-align: left; margin: 0.5rem 0;">').concat(t," ").concat((0,v.M)("selected for checkout."),'</p>\n    <hr>\n    <p style="text-align: left; margin: 0.5rem 0 0;" class="muted">').concat(a,"</p>")}}}]);
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="56cbd0dc-d963-467c-924e-e86131610f42",e._sentryDebugIdIdentifier="sentry-dbid-56cbd0dc-d963-467c-924e-e86131610f42")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"1.99.9"},(self.webpackChunkpeachpay_for_woocommerce=self.webpackChunkpeachpay_for_woocommerce||[]).push([[796],{5796:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var a=n(3940),i=n(1682),o=n(3458),r=n(7246),c=n(4284),s=n(8883),d=n(5792);var u=n(3984),l=n(3629),p=n(8072),h=n(2494);function f(){o.h.subscribe((function(){!function(e,t,n){e.startsWith("peachpay_authnet_")&&"payment"===t?(0,l.HD)(".authnet-btn-container",(function(e){e.classList.remove("hide")})):(0,l.HD)(".authnet-btn-container",(function(e){e.classList.add("hide")}));"loading"===n?(0,l.HD)(".authnet-btn",(function(e){e.classList.add("hide")})):(0,l.HD)(".authnet-btn",(function(e){e.classList.remove("hide")}))}(u.hv.selectedGateway(),i.qA.modalUI.page(),i.qA.modalUI.loadingMode()),function(e){"loading"===e?(0,l.HD)(".authnet-spinner-container",(function(e){e.classList.remove("hide")})):(0,l.HD)(".authnet-spinner-container",(function(e){e.classList.add("hide")}));"processing"===e?(0,l.HD)(".authnet-btn-spinner",(function(e){e.classList.remove("hide")})):(0,l.HD)(".authnet-btn-spinner",(function(e){e.classList.add("hide")}));"processing"===e?(0,l.HD)(".authnet-btn > .button-text",(function(e){e.innerHTML=(0,c.M)("Processing")})):(0,l.HD)(".authnet-btn > .button-text",(function(e){e.innerHTML="".concat((0,c.M)("Pay")," ").concat((0,h.o)(p.AQ.total()))}));"finished"===e?(0,l.HD)(".authnet-btn",(function(e){e.disabled=!1})):(0,l.HD)(".authnet-btn",(function(e){e.disabled=!0}))}(i.qA.modalUI.loadingMode())}))}var y=n(8472),b=n(9402);var g=function(){function e(e){this.loginId=e.loginId,this.clientKey=e.clientKey,this.scriptSrc=e.acceptSrc,this.$script=null,this.$button=null}return e.prototype.tokenize=function(t){return(0,a.mG)(this,void 0,void 0,(function(){var n=this;return(0,a.Jh)(this,(function(i){switch(i.label){case 0:if(e.isTokenizing)throw new Error("Tokenization is already in progress. Only 1 tokenization attempt may occur at a time.");return e.isTokenizing=!0,[4,this.mount(t)];case 1:return i.sent(),[4,new Promise((function(e){setTimeout((function(){e()}),1e3)}))];case 2:return i.sent(),[2,new Promise((function(t,i){var o,r;n.$button||i(new Error("Failed to locate Authorize.net tokenize button")),window.peachpayAuthnetResponseHandler=function(n){"Ok"===n.messages.resultCode&&n.opaqueData?t({token:{descriptor:n.opaqueData.dataDescriptor,value:n.opaqueData.dataValue}}):"Error"===n.messages.resultCode?t({error:n.messages.message.map((function(e){return{code:e.code,message:e.text}}))}):i(new Error("Unhandled Authorize.net tokenization response.")),window.peachpayAuthnetResponseHandler=void 0,e.isTokenizing=!1},null===(o=n.$button)||void 0===o||o.click();var c=(0,l.MW)("#AcceptUIContainer"),s=null===(r=(0,l.MW)("#AcceptUIContainer"))||void 0===r?void 0:r.parentNode,d=new MutationObserver((function(n){var i,o;try{for(var r=(0,a.XA)(n),s=r.next();!s.done;s=r.next()){var u=s.value;"childList"===u.type&&u.removedNodes[0]===c&&(d.disconnect(),t({cancel:!0}),window.peachpayAuthnetResponseHandler=void 0,e.isTokenizing=!1)}}catch(e){i={error:e}}finally{try{s&&!s.done&&(o=r.return)&&o.call(r)}finally{if(i)throw i.error}}}));s&&d.observe(s,{attributes:!1,childList:!0,subtree:!1})}))]}}))}))},e.prototype.mount=function(e){return(0,a.mG)(this,void 0,void 0,(function(){var t=this;return(0,a.Jh)(this,(function(n){return this.unmount(),[2,new Promise((function(n,a){var i={showCreditCard:"card"===e||"all"===e,showBankAccount:"bank"===e||"all"===e},o=document.createElement("button");o.classList.add("AcceptUI"),o.setAttribute("style","display: none;"),o.setAttribute("type","button"),o.setAttribute("data-billingAddressOptions",'{"show":false,"required":false}'),o.setAttribute("data-apiLoginID",t.loginId),o.setAttribute("data-clientKey",t.clientKey),o.setAttribute("data-acceptUIFormBtnTxt","Submit"),o.setAttribute("data-acceptUIFormHeaderTxt","Card Information"),o.setAttribute("data-paymentOptions",JSON.stringify(i)),o.setAttribute("data-responseHandler","peachpayAuthnetResponseHandler"),o.textContent="Pay",t.$button=o;var r=document.createElement("script");r.type="text/javascript",r.src=t.scriptSrc,r.classList.add("pp-authnet-accept-script"),r.onload=function(){n()},r.onerror=function(){a(new Error("Failed to load tokenization script."))},t.$script=r,document.body.appendChild(o),document.body.appendChild(r)}))]}))}))},e.prototype.unmount=function(){var e,t;null===(e=this.$script)||void 0===e||e.remove(),null===(t=this.$button)||void 0===t||t.remove(),(0,l.HD)("#AcceptUIBackground,#AcceptUIContainer",(function(e){e.remove()}))},e.isTokenizing=!1,e}(),w=n(4681);function v(e){var t=this,n=i.L0.metadata("peachpay_authnet_gateways","accept_src"),p=i.L0.metadata("peachpay_authnet_gateways","public_client_key"),h=i.L0.metadata("peachpay_authnet_gateways","login_id");if(h&&p&&n){var v=new g({loginId:h,clientKey:p,acceptSrc:n}),m=function(){var e={},t={};if(i.L0.enabled("peachpay_authnet_card_gateway")){e[(a={config:{name:null!==(n=i.L0.metadata("peachpay_authnet_card_gateway","title"))&&void 0!==n?n:(0,c.M)("Card"),gatewayId:"peachpay_authnet_card",description:"".concat((0,c.M)("After clicking <b>Pay</b>, a window will appear where you can enter your card information.")),assets:{title:{src:d},badge:{src:s}}}}).config.gatewayId]=a,t[a.config.gatewayId]=a.config}var n;if(i.L0.enabled("peachpay_authnet_echeck_gateway")){var a=function(){var e;return{config:{name:null!==(e=i.L0.metadata("peachpay_authnet_echeck_gateway","title"))&&void 0!==e?e:(0,c.M)("US bank account"),gatewayId:"peachpay_authnet_echeck",description:"".concat((0,c.M)("After clicking <b>Pay</b>, a window will appear where you can enter your card information.")),assets:{title:{src:b},badge:{src:b}}}}}();e[a.config.gatewayId]=a,t[a.config.gatewayId]=a.config}return o.h.dispatch((0,u.Cj)(t)),e}();f(),(0,l.HD)(".authnet-btn",(function(n){n.addEventListener("click",(function(){return(0,a.mG)(t,void 0,void 0,(function(){var t,n,s,d,l,p,h,f,b,g,_,k,A,I,L;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return o.h.dispatch((0,i.N5)()),t=u.hv.selectedGateway(),(n=m[t])?(s="card","peachpay_authnet_echeck"===t&&(s="bank"),[4,v.tokenize(s)]):[2];case 1:return d=a.sent(),l=d.token,p=d.error,h=d.cancel,[4,e.startTransaction(n.config.gatewayId)];case 2:return f=a.sent(),b=f.error,g=f.result,b||!g?(_=b?(0,w.H)(b):(0,c.M)("An unknown error occured while starting the transaction. Please refresh the page and try again."),(0,r.j1)(_),o.h.dispatch((0,i.tv)()),[2]):h?(o.h.dispatch((0,i.tv)()),[2]):(null!=p?p:!l)?((0,r.j1)(null!==(L=null==p?void 0:p.map((function(e){return"".concat(e.code,": ").concat(e.message)})).join("\n"))&&void 0!==L?L:"An unknown error occured while tokenizing the payment method."),o.h.dispatch((0,i.tv)()),[2]):[4,e.placeOrder(g,{peachpay_authnet_data_descriptor:l.descriptor,peachpay_authnet_data_value:l.value})];case 3:return k=a.sent(),A=k.error,I=k.result,A||!I||"success"!==I.result?(o.h.dispatch((0,i.tv)()),[2]):((0,y.c)(),window.top?[4,g.complete()]:[3,5]);case 4:a.sent(),window.top.location=I.redirect,a.label=5;case 5:return[2]}}))}))}))}))}}},8883:(e,t,n)=>{e.exports=n.p+"img/d2a66f3e82ab3efab425-card.svg"},9402:(e,t,n)=>{e.exports=n.p+"img/e7542fee9125d1af4d23-bank.svg"},5792:(e,t,n)=>{e.exports=n.p+"img/b2c8b12eb49165de87d5-credit-card-regular.svg"}}]);
//# sourceMappingURL=796-8ac7efe0c992a2a0005b.js.map
{"version":3,"file":"peachpay_square_afterpay-blocks.js","mappings":"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","sources":["webpack://peachpay-for-woocommerce/./core/blocks/src/currency-fallback.tsx","webpack://peachpay-for-woocommerce/./core/payments/square/blocks/src/currency.ts","webpack://peachpay-for-woocommerce/./core/payments/square/blocks/src/payment-request.ts","webpack://peachpay-for-woocommerce/./frontend/@shared/ts/currency.ts","webpack://peachpay-for-woocommerce/./frontend/@shared/ts/error.ts","webpack://peachpay-for-woocommerce/external window \"React\"","webpack://peachpay-for-woocommerce/external window \"regeneratorRuntime\"","webpack://peachpay-for-woocommerce/external window [\"peachpay_checkout_blocks\"]","webpack://peachpay-for-woocommerce/external window [\"wc\",\"wcBlocksData\"]","webpack://peachpay-for-woocommerce/external window [\"wc\",\"wcBlocksRegistry\"]","webpack://peachpay-for-woocommerce/external window [\"wc\",\"wcSettings\"]","webpack://peachpay-for-woocommerce/external window [\"wp\",\"data\"]","webpack://peachpay-for-woocommerce/external window [\"wp\",\"element\"]","webpack://peachpay-for-woocommerce/external window [\"wp\",\"htmlEntities\"]","webpack://peachpay-for-woocommerce/external window [\"wp\",\"i18n\"]","webpack://peachpay-for-woocommerce/./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack://peachpay-for-woocommerce/./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","webpack://peachpay-for-woocommerce/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://peachpay-for-woocommerce/./node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","webpack://peachpay-for-woocommerce/./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","webpack://peachpay-for-woocommerce/./node_modules/@babel/runtime/helpers/esm/slicedToArray.js","webpack://peachpay-for-woocommerce/./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","webpack://peachpay-for-woocommerce/webpack/bootstrap","webpack://peachpay-for-woocommerce/webpack/runtime/compat get default export","webpack://peachpay-for-woocommerce/webpack/runtime/define property getters","webpack://peachpay-for-woocommerce/webpack/runtime/hasOwnProperty shorthand","webpack://peachpay-for-woocommerce/./core/payments/square/blocks/src/afterpay/index.tsx"],"sourcesContent":["import {peachpayUpdateCurrencyCookie} from '../../../frontend/@shared/ts/currency';\nimport {__} from '@wordpress/i18n';\n\nexport default function CurrencyFallback(props: {name: string; currency: string | null}) {\n\tfunction changeCurrency() {\n\t\tif (!props.currency) {\n\t\t\treturn;\n\t\t}\n\n\t\tpeachpayUpdateCurrencyCookie(props.currency);\n\t\twindow.location.reload();\n\t}\n\n\treturn props.currency ? (\n\t\t<div style={{display: 'flex', flexDirection: 'column'}}>\n\t\t\t<p style={{textAlign: 'justify', margin: '0.5rem 0 0', fontSize: 'smaller'}}>\n\t\t\t\t{props.name} {__('does not support the currency you currently have chosen.', 'peachpay-for-woocommerce')} <b>{__('Update to', 'peachpay-for-woocommerce')} {props.currency}</b> {__('below to use this payment method.', 'peachpay-for-woocommerce')}\n\t\t\t</p>\n\t\t\t<button type='button' className='button currency-fallback-button' style={{fontSize: 'smaller', marginBottom: '16px'}}\n\t\t\t\tonClick={changeCurrency}\n\t\t\t>{__('Update to', 'peachpay-for-woocommerce')} {props.currency}</button>\n\t\t</div>\n\t) : null;\n}\n","const SUPPORTED_ZERO_DECIMAL_CURRENCIES = [\n\t'BIF',\n\t'CLP',\n\t'DJF',\n\t'GNF',\n\t'JPY',\n\t'KMF',\n\t'KRW',\n\t'MGA',\n\t'PYG',\n\t'RWF',\n\t'UGX',\n\t'VND',\n\t'VUV',\n\t'XAF',\n\t'XOF',\n\t'XPF',\n];\n\n/**\n * Formats a WC amount to an amount expected by Square. WC blocks amounts are\n * formatted as the smallest unit(Ex: cents for USD) but square expects dollars.\n *\n * @param amount - The amount to format.\n * @param tax - The tax amount to add to the total.\n * @param currency - The currency code.\n * @param includeTax - Whether prices are displayed including tax.\n *\n * @returns The formatted amount as a string expected by Square.\n */\nfunction formatAmount(amount: string, tax: string, currency: string, includeTax = false): string {\n\tlet parsedAmount = Number.parseInt(amount);\n\n\tconst parsedTax = Number.parseInt(tax);\n\tif (includeTax) {\n\t\tparsedAmount += parsedTax;\n\t}\n\n\tif (!SUPPORTED_ZERO_DECIMAL_CURRENCIES.includes(currency)) {\n\t\tparsedAmount /= 100;\n\t}\n\n\treturn parsedAmount.toFixed(2);\n}\n\nexport {\n\tformatAmount,\n};\n","import {type LineItem, type PaymentRequestOptions} from '@square/web-payments-sdk-types';\nimport {type PreparedCartTotalItem, type CartItem} from '@woocommerce/types';\nimport {formatAmount} from './currency';\n\ntype CorrectedPreparedCartTotalItem = PreparedCartTotalItem & {key?: string; valueWithTax: number};\n\ntype WooCommerceBlocksData = {\n\tmerchantCountry: string;\n\tcurrency: string;\n\titems: CartItem[];\n\tsummary: PreparedCartTotalItem[];\n\ttotal: PreparedCartTotalItem;\n\tdisplayPricesIncludingTax: boolean;\n};\n\nfunction buildOptions(options: WooCommerceBlocksData): PaymentRequestOptions {\n\treturn {\n\t\tcountryCode: options.merchantCountry,\n\t\tcurrencyCode: options.currency,\n\t\tlineItems: lineItems(options),\n\t\tdiscounts: discounts(options),\n\t\ttaxLineItems: taxLineItems(options),\n\t\tshippingLineItems: shippingLineItems(options),\n\t\ttotal: total(options),\n\t\trequestBillingContact: false,\n\t\trequestShippingContact: false,\n\t};\n}\n\nfunction lineItems(options: WooCommerceBlocksData): LineItem[] {\n\tconst lineItems = new Array<LineItem>();\n\n\tfor (const cartItem of options.items) {\n\t\tlineItems.push({\n\t\t\tid: cartItem.sku,\n\t\t\tlabel: cartItem.name + ' × ' + cartItem.quantity,\n\t\t\tamount: formatAmount(\n\t\t\t\tcartItem.totals.line_subtotal,\n\t\t\t\tcartItem.totals.line_subtotal_tax,\n\t\t\t\tcartItem.totals.currency_code,\n\t\t\t\toptions.displayPricesIncludingTax,\n\t\t\t),\n\t\t});\n\t}\n\n\treturn lineItems;\n}\n\nfunction discounts(options: WooCommerceBlocksData): LineItem[] {\n\tconst discounts = new Array<LineItem>();\n\n\tfor (const lineTotal of options.summary as CorrectedPreparedCartTotalItem[]) {\n\t\tif (lineTotal['key'] !== 'total_discount') {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (lineTotal.value === 0) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst amount = String(options.displayPricesIncludingTax ? lineTotal.valueWithTax : lineTotal.value);\n\t\tconst tax = '0';\n\n\t\tdiscounts.push({\n\t\t\tlabel: lineTotal.label,\n\t\t\tamount: formatAmount(amount, tax, options.currency),\n\t\t});\n\t}\n\n\treturn discounts;\n}\n\nfunction taxLineItems(options: WooCommerceBlocksData): LineItem[] {\n\tconst taxLineItems = new Array<LineItem>();\n\n\tfor (const lineTotal of options.summary as CorrectedPreparedCartTotalItem[]) {\n\t\tif (lineTotal['key'] !== 'total_tax') {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (lineTotal.value === 0) {\n\t\t\tcontinue;\n\t\t}\n\n\t\ttaxLineItems.push({\n\t\t\tlabel: lineTotal.label,\n\t\t\tamount: formatAmount(String(lineTotal.value), '0', options.currency),\n\t\t});\n\t}\n\n\treturn taxLineItems;\n}\n\nfunction shippingLineItems(options: WooCommerceBlocksData): LineItem[] {\n\tconst shippingLineItems = new Array<LineItem>();\n\n\tfor (const lineTotal of options.summary as CorrectedPreparedCartTotalItem[]) {\n\t\tif (lineTotal['key'] !== 'total_shipping') {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (lineTotal.value === 0) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tshippingLineItems.push({\n\t\t\tlabel: lineTotal.label,\n\t\t\tamount: formatAmount(String(lineTotal.value), '0', options.currency),\n\t\t});\n\t}\n\n\treturn shippingLineItems;\n}\n\nfunction total(options: WooCommerceBlocksData): LineItem {\n\treturn {\n\t\tlabel: options.total.label,\n\t\tamount: formatAmount(String(options.total.value), '0', options.currency),\n\t};\n}\n\nexport {\n\tbuildOptions,\n};\n","function peachpayUpdateCurrencyCookie(newCurrency: string) {\n\tdocument.cookie = `pp_active_currency=${newCurrency};path=/`;\n}\n\nexport {peachpayUpdateCurrencyCookie};\n","/**\n * Gets a stringified error or if the stringified result is an empy string or empty object the default .toString() is used.\n * Created because JSON.stringify(error) will return {} for Error objects (https://stackoverflow.com/a/50738205/16998523).\n *\n * @param {unknown} error\n */\nexport function getErrorString(error: unknown): string {\n\tif (error instanceof Error && error.stack) {\n\t\treturn error.stack;\n\t}\n\n\tconst errorString = JSON.stringify(error);\n\treturn errorString && errorString !== '{}' ? errorString : `${error as string}`;\n}\n\n/**\n * Takes an unknown value and coerces it into an error and finally returns the error message string\n */\nexport function getErrorMessage(thrownError: unknown) {\n\treturn _toErrorWithMessage(thrownError).message;\n}\n\nfunction _toErrorWithMessage(thrownError: unknown): {message: string} {\n\tif (_isErrorWithMessage(thrownError)) {\n\t\treturn thrownError;\n\t}\n\n\ttry {\n\t\treturn new Error(JSON.stringify(thrownError));\n\t} catch {\n\t\treturn new Error(String(thrownError));\n\t}\n}\n\nfunction _isErrorWithMessage(thrownError: unknown): thrownError is {message: string} {\n\treturn (\n\t\ttypeof thrownError === 'object'\n    && thrownError !== null\n    && 'message' in thrownError\n    && typeof thrownError.message === 'string'\n\t);\n}\n\nfunction _isErrorWithName(error: unknown): error is {name: string} {\n\treturn typeof error === 'object' && error !== null && 'name' in error && typeof error.name === 'string';\n}\n\nexport function getErrorName(error: unknown): string | null {\n\tif (_isErrorWithName(error)) {\n\t\treturn error.name;\n\t}\n\n\treturn null;\n}\n","module.exports = window[\"React\"];","module.exports = window[\"regeneratorRuntime\"];","module.exports = window[\"peachpay_checkout_blocks\"];","module.exports = window[\"wc\"][\"wcBlocksData\"];","module.exports = window[\"wc\"][\"wcBlocksRegistry\"];","module.exports = window[\"wc\"][\"wcSettings\"];","module.exports = window[\"wp\"][\"data\"];","module.exports = window[\"wp\"][\"element\"];","module.exports = window[\"wp\"][\"htmlEntities\"];","module.exports = window[\"wp\"][\"i18n\"];","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n      args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n      _next(undefined);\n    });\n  };\n}","export default function _iterableToArrayLimit(r, l) {\n  var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (null != t) {\n    var e,\n      n,\n      i,\n      u,\n      a = [],\n      f = !0,\n      o = !1;\n    try {\n      if (i = (t = t.call(r)).next, 0 === l) {\n        if (Object(t) !== t) return;\n        f = !1;\n      } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0);\n    } catch (r) {\n      o = !0, n = r;\n    } finally {\n      try {\n        if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return;\n      } finally {\n        if (o) throw n;\n      }\n    }\n    return a;\n  }\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","import {__} from '@wordpress/i18n';\nimport {registerPaymentMethod} from '@woocommerce/blocks-registry';\nimport {getSetting} from '@woocommerce/settings';\nimport {decodeEntities} from '@wordpress/html-entities';\nimport {useEffect, useRef, useState} from '@wordpress/element';\nimport {type PaymentMethodInterface} from '@woocommerce/types';\nimport {type CheckoutAfterProcessingWithErrorEventData} from '@woocommerce/checkout';\nimport {type TokenResult, type Payments, type AfterpayClearpay, type PaymentRequest} from '@square/web-payments-sdk-types';\nimport {startTransaction, updateTransaction, z} from '@peachpay/checkout-blocks';\nimport {getErrorString} from '../../../../../../frontend/@shared/ts/error';\nimport CurrencyFallback from '../../../../../blocks/src/currency-fallback';\nimport {buildOptions} from '../payment-request';\nimport {select} from '@wordpress/data';\nimport {CART_STORE_KEY} from '@woocommerce/block-data';\n\nconst SettingsSchema = z.object({\n\ticon: z.string(),\n\ttitle: z.string(),\n\tdescription: z.string(),\n\tfallback_currency: z.string().nullable(),\n\tsupports: z.string().array(),\n\tsquare: z.object({\n\t\tapplication_id: z.string(),\n\t\tlocation_id: z.string(),\n\t\tcountry_code: z.string(),\n\t}),\n});\n\nconst parsedResult = SettingsSchema.safeParse(getSetting('peachpay_square_afterpay_data'));\nif (!parsedResult.success) {\n\tthrow new Error(`Payment method \"peachpay_square_afterpay\" setup aborted. Invalid settings.\\n\\n${parsedResult.error.message}`);\n}\n\nconst settings = parsedResult.data;\nconst title = decodeEntities(settings.title);\nconst description = decodeEntities(settings.description);\n\nif (!window.Square) {\n\tthrow new Error('Payment method \"peachpay_square_afterpay\" setup aborted. Square SDK not loaded.');\n}\n\nlet payments: Payments;\ntry {\n\tpayments = window.Square.payments(settings.square.application_id, settings.square.location_id);\n} catch (err) {\n\tthrow new Error(`Payment method \"peachpay_square_afterpay\" setup aborted. Could not create Payments instance.\\n\\n${getErrorString(err)}`);\n}\n\ntype CartStore = {getCartData(): {billingAddress: {country: string}}};\n\nconst clearPayTitle = __('Clearpay', 'peachpay-for-woocommerce');\nconst afterPayTitle = __('Afterpay', 'peachpay-for-woocommerce');\n\n/**\n * Component to render the payment method label\n */\nfunction Label(props: PaymentMethodInterface) {\n\tconst {PaymentMethodLabel, PaymentMethodIcons} = props.components;\n\n\tconst [label, setLabel] = useState<string>(title);\n\n\tconst cartData = (select(CART_STORE_KEY) as unknown as CartStore)?.getCartData();\n\tuseEffect(() => {\n\t\t// If the title is not a default then do not do any auto changing.\n\t\tif (title !== clearPayTitle && title !== afterPayTitle) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (cartData.billingAddress.country === 'GB') {\n\t\t\tsetLabel(__('Clearpay', 'peachpay-for-woocommerce'));\n\t\t} else {\n\t\t\tsetLabel(__('Afterpay', 'peachpay-for-woocommerce'));\n\t\t}\n\t}, [cartData.billingAddress.country]);\n\n\treturn (\n\t\t<>\n\t\t\t<PaymentMethodLabel text={label} />\n\t\t\t<PaymentMethodIcons className='pp-label-icon' icons={[{\n\t\t\t\tid: 'peachpay_square_afterpay',\n\t\t\t\tsrc: settings.icon,\n\t\t\t\talt: label,\n\t\t\t}]} />\n\t\t</>\n\t);\n}\n\n/**\n * Component to render the afterpay body.\n */\nfunction Content({billing, cartData, eventRegistration, emitResponse}: PaymentMethodInterface) {\n\tconst {\n\t\tonPaymentSetup,\n\t\tonCheckoutFail,\n\t} = eventRegistration;\n\n\tconst containerRef = useRef<HTMLDivElement | null>(null);\n\tconst paymentRequestRef = useRef<PaymentRequest | null>(null);\n\tconst afterpayRef = useRef<AfterpayClearpay | null>(null);\n\n\t/**\n\t * Setup the Square PaymentRequest and Afterpay instance. This is only done\n     * once on component mount.\n\t */\n\tuseEffect(() => {\n\t\tconst setupAfterpay = async () => {\n\t\t\tpaymentRequestRef.current = payments.paymentRequest(buildOptions({\n\t\t\t\tmerchantCountry: settings.square.country_code,\n\t\t\t\tcurrency: billing.currency.code,\n\t\t\t\titems: cartData.cartItems,\n\t\t\t\tsummary: billing.cartTotalItems,\n\t\t\t\ttotal: billing.cartTotal,\n\t\t\t\tdisplayPricesIncludingTax: billing.displayPricesIncludingTax,\n\t\t\t}));\n\n\t\t\tafterpayRef.current = await payments.afterpayClearpay(paymentRequestRef.current);\n\n\t\t\tif (containerRef.current?.id) {\n\t\t\t\tcontainerRef.current.innerHTML = '';\n\t\t\t\tawait afterpayRef.current.attach(`#${containerRef.current.id}`);\n\t\t\t}\n\t\t};\n\n\t\tsetupAfterpay()\n\t\t\t.catch(console.error);\n\n\t\treturn () => {\n\t\t\tafterpayRef.current?.destroy()\n\t\t\t\t.catch(console.error);\n\t\t};\n\t}, []);\n\n\t/**\n     * Make sure the Payment request object stays up to date so the Afterpay\n     * sheet displays the correct information to the customer.\n     */\n\tuseEffect(() => {\n\t\tpaymentRequestRef.current?.update(buildOptions({\n\t\t\tmerchantCountry: settings.square.country_code,\n\t\t\tcurrency: billing.currency.code,\n\t\t\titems: cartData.cartItems,\n\t\t\tsummary: billing.cartTotalItems,\n\t\t\ttotal: billing.cartTotal,\n\t\t\tdisplayPricesIncludingTax: billing.displayPricesIncludingTax,\n\t\t}));\n\t}, [\n\t\tcartData.cartItems,\n\t\tbilling.currency.code,\n\t\tbilling.cartTotalItems,\n\t\tbilling.cartTotal,\n\t\tbilling.displayPricesIncludingTax,\n\t]);\n\n\t/**\n\t * Handle payment tokenization right before the order is submitted.\n\t */\n\tuseEffect(() => onPaymentSetup(async () => {\n\t\tconst {result: transactionId, error} = await startTransaction('peachpay_square_afterpay');\n\t\tif (error || !transactionId) {\n\t\t\treturn {\n\t\t\t\ttype: emitResponse.responseTypes.ERROR,\n\t\t\t\tmessage: getErrorString(error) ?? __('An unknown error occured while creating the transaction.', 'peachpay-for-woocommerce'),\n\t\t\t};\n\t\t}\n\n\t\tif (!afterpayRef.current) {\n\t\t\tconst note = __('Missing ref to Square Afterpay element. Please try again or use a different payment method.', 'peachpay-for-woocommerce');\n\n\t\t\tawait updateTransaction(transactionId, {note, paymentStatus: 'creationfailed'});\n\t\t\treturn {\n\t\t\t\ttype: emitResponse.responseTypes.ERROR,\n\t\t\t\tmessage: note,\n\t\t\t};\n\t\t}\n\n\t\tlet tokenResult: TokenResult | null = null;\n\t\ttry {\n\t\t\ttokenResult = await afterpayRef.current.tokenize();\n\t\t\tif (tokenResult.status !== 'OK' || !tokenResult.token) {\n\t\t\t\tlet note = (tokenResult.errors\n\t\t\t\t\t?.map(err => err.message)\n\t\t\t\t\t?.join('<br/>')\n\t\t\t\t\t\t?? __('Afterpay tokenization failed. Please try again or use a different payment method.', 'peachpay-for-woocommerce')\n\t\t\t\t);\n\n\t\t\t\tif (tokenResult.status === 'Cancel') {\n\t\t\t\t\tnote = __('Payment was cancelled', 'peachpay-for-woocommerce');\n\t\t\t\t}\n\n\t\t\t\tawait updateTransaction(transactionId, {note, paymentStatus: 'creationfailed'});\n\t\t\t\treturn {\n\t\t\t\t\ttype: emitResponse.responseTypes.ERROR,\n\t\t\t\t\tmessage: note,\n\t\t\t\t};\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tconst note = getErrorString(err);\n\t\t\tawait updateTransaction(transactionId, {note, paymentStatus: 'creationfailed'});\n\t\t\treturn {\n\t\t\t\ttype: emitResponse.responseTypes.ERROR,\n\t\t\t\tmessage: note,\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\ttype: emitResponse.responseTypes.SUCCESS,\n\t\t\tmeta: {\n\t\t\t\tpaymentMethodData: {\n\t\t\t\t\tpeachpay_transaction_id: transactionId,\n\t\t\t\t\tpeachpay_square_source_id: tokenResult.token,\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}), [billing.billingAddress, onPaymentSetup]);\n\n\t/**\n\t * Handle checkout failure after the order was submitted. Failure may or may\n\t * not be payment related.\n\t */\n\tuseEffect(() => onCheckoutFail(async (data: CheckoutAfterProcessingWithErrorEventData) => ({\n\t\ttype: emitResponse.responseTypes.ERROR,\n\t\tmessage: (data.processingResponse?.paymentDetails?.['message']) ?? __('An unknown error occured while processing the payment.', 'peachpay-for-woocommerce'),\n\t\tmessageContext: emitResponse.noticeContexts.PAYMENTS,\n\t})), [onCheckoutFail]);\n\n\t/**\n\t * If the payment method does not support the current currency we will show\n\t * a fallback button to allow changing the currency.\n\t *\n\t * Note: Due to how our currency switcher works the `fallback_currency` setting\n\t * is only defined when the payment does not support the current currency and\n\t * does not change after page load.\n\t */\n\tif (settings.fallback_currency) {\n\t\treturn <CurrencyFallback name={title} currency={settings.fallback_currency} />;\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<img style={{maxHeight: '25px'}} src={settings.icon}></img>\n\t\t\t<p style={{textAlign: 'left', margin: '0.5rem 0 0'}} >{title} {__('selected for checkout.', 'peachpay-for-woocommerce')}</p>\n\t\t\t<hr style={{margin: '0.5rem 0'}}/>\n\t\t\t<p style={{textAlign: 'left', margin: '0', fontSize: 'smaller'}}>{description}</p>\n\t\t\t<div style={{display: 'none'}} id='pp-square-afterpay-container' ref={containerRef}>Loading...</div>\n\t\t</>\n\t);\n}\n\nregisterPaymentMethod({\n\tname: 'peachpay_square_afterpay',\n\tariaLabel: title,\n\tcanMakePayment(data) {\n\t\treturn data.paymentMethods.includes('peachpay_square_afterpay');\n\t},\n\t// @ts-expect-error WC will clone these components and pass the props when used.\n\tlabel: <Label />,\n\t// @ts-expect-error WC will clone these components and pass the props when used.\n\tcontent: <Content />,\n\t// @ts-expect-error WC will clone these components and pass the props when used.\n\tedit: <Content />,\n\tsupports: {\n\t\tfeatures: settings.supports,\n\t},\n});\n"],"names":["CurrencyFallback","props","currency","createElement","style","display","flexDirection","textAlign","margin","fontSize","name","__","type","className","marginBottom","onClick","peachpayUpdateCurrencyCookie","window","location","reload","SUPPORTED_ZERO_DECIMAL_CURRENCIES","formatAmount","amount","tax","includeTax","arguments","length","undefined","parsedAmount","Number","parseInt","parsedTax","includes","toFixed","buildOptions","options","countryCode","merchantCountry","currencyCode","lineItems","discounts","taxLineItems","shippingLineItems","total","requestBillingContact","requestShippingContact","_step","Array","_iterator","_createForOfIteratorHelper","items","s","n","done","cartItem","value","push","id","sku","label","quantity","totals","line_subtotal","line_subtotal_tax","currency_code","displayPricesIncludingTax","err","e","f","_i","_arr","summary","lineTotal","String","valueWithTax","_i2","_arr2","_i3","_arr3","newCurrency","document","cookie","getErrorString","error","Error","stack","errorString","JSON","stringify","module","exports","_arrayLikeToArray","arr","len","i","arr2","_arrayWithHoles","isArray","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","Promise","then","_asyncToGenerator","fn","self","this","args","apply","_iterableToArrayLimit","r","l","t","Symbol","iterator","u","a","o","call","next","Object","_nonIterableRest","TypeError","_slicedToArray","_unsupportedIterableToArray","minLen","prototype","toString","slice","constructor","from","test","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","__esModule","d","definition","defineProperty","enumerable","get","obj","prop","hasOwnProperty","parsedResult","z","object","icon","string","title","description","fallback_currency","nullable","supports","array","square","application_id","location_id","country_code","safeParse","getSetting","success","message","payments","settings","data","decodeEntities","Square","clearPayTitle","afterPayTitle","Content","_ref","billing","cartData","eventRegistration","emitResponse","onPaymentSetup","onCheckoutFail","containerRef","useRef","paymentRequestRef","afterpayRef","useEffect","setupAfterpay","_ref2","_regeneratorRuntime","_callee","_containerRef$current","_context","prev","current","paymentRequest","code","cartItems","cartTotalItems","cartTotal","afterpayClearpay","sent","innerHTML","attach","stop","catch","console","_afterpayRef$current","destroy","_paymentRequestRef$cu","update","_callee2","_yield$startTransacti","transactionId","_getErrorString","note","tokenResult","_tokenResult$errors$m","_tokenResult$errors","_note","_note2","_context2","startTransaction","result","abrupt","responseTypes","ERROR","updateTransaction","paymentStatus","tokenize","status","token","errors","map","join","t0","SUCCESS","meta","paymentMethodData","peachpay_transaction_id","peachpay_square_source_id","billingAddress","_ref4","_callee3","_data$processingRespo","_data$processingRespo2","_context3","processingResponse","paymentDetails","messageContext","noticeContexts","PAYMENTS","_x","Fragment","maxHeight","src","ref","registerPaymentMethod","ariaLabel","canMakePayment","paymentMethods","_select","_props$components","components","PaymentMethodLabel","PaymentMethodIcons","_useState","useState","_useState2","setLabel","select","CART_STORE_KEY","getCartData","country","text","icons","alt","content","edit","features"],"sourceRoot":""}
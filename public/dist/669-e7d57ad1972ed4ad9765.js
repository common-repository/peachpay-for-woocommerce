!function(){try{var n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e=(new Error).stack;e&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[e]="f07b4da1-ce78-4428-8bc0-4fe6cb9e75b6",n._sentryDebugIdIdentifier="sentry-dbid-f07b4da1-ce78-4428-8bc0-4fe6cb9e75b6")}catch(n){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"1.100.2"},(self.webpackChunkpeachpay_for_woocommerce=self.webpackChunkpeachpay_for_woocommerce||[]).push([[669],{1669:(n,e,t)=>{t.r(e),t.d(e,{default:()=>m});var i=t(3940),a=t(3629),o=t(7705),r=t(1682),s=t(3984),c=t(7150),d=t(3458),l=t(7246),u=t(8072),p=t(2494),f=t(4284);function y(){d.h.subscribe((function(){!function(n,e,t){n.startsWith("peachpay_poynt_")&&"payment"===e?(0,a.HD)(".poynt-btn-container",(function(n){n.classList.remove("hide")})):(0,a.HD)(".poynt-btn-container",(function(n){n.classList.add("hide")}));"loading"===t?(0,a.HD)(".poynt-btn",(function(n){n.classList.add("hide")})):(0,a.HD)(".poynt-btn",(function(n){n.classList.remove("hide")}))}(s.hv.selectedGateway(),r.qA.modalUI.page(),r.qA.modalUI.loadingMode()),function(n){"loading"===n?(0,a.HD)(".poynt-spinner-container",(function(n){n.classList.remove("hide")})):(0,a.HD)(".poynt-spinner-container",(function(n){n.classList.add("hide")}));"processing"===n?(0,a.HD)(".poynt-btn-spinner",(function(n){n.classList.remove("hide")})):(0,a.HD)(".poynt-btn-spinner",(function(n){n.classList.add("hide")}));"processing"===n?(0,a.HD)(".poynt-btn > .button-text",(function(n){n.innerHTML=(0,f.M)("Processing")})):(0,a.HD)(".poynt-btn > .button-text",(function(n){n.innerHTML="".concat((0,f.M)("Pay")," ").concat((0,p.o)(u.AQ.total()))}));"finished"===n?(0,a.HD)(".poynt-btn",(function(n){n.disabled=!1})):(0,a.HD)(".poynt-btn",(function(n){n.disabled=!0}))}(r.qA.modalUI.loadingMode())}))}var h=t(5792),b=t(8883),g=function(){function n(n){this.businessId=n.businessId,this.applicationId=n.applicationId,this.$cardElement=new TokenizeJs(this.businessId,this.applicationId)}return n.prototype.mount=function(n,e){this.$cardElement.mount(n,document,e)},n.prototype.tokenize=function(n){return(0,i.mG)(this,void 0,void 0,(function(){var e=this;return(0,i.Jh)(this,(function(t){return[2,new Promise((function(t){e.$cardElement.on("nonce",(function(n){n.data.nonce&&t({nonce:n.data.nonce})})),e.$cardElement.on("error",(function(n){var e,i,a,o,r;t({error:null!==(r=null!==(i=null===(e=n.data)||void 0===e?void 0:e.message)&&void 0!==i?i:null===(o=null===(a=n.data)||void 0===a?void 0:a.error)||void 0===o?void 0:o.message)&&void 0!==r?r:"Something went wrong. Please try again."})})),e.$cardElement.getNonce(n)}))]}))}))},n}();var v=t(4681);function m(n){return(0,i.mG)(this,void 0,void 0,(function(){var e,t,u,p;return(0,i.Jh)(this,(function(m){switch(m.label){case 0:return r.L0.enabled("peachpay_poynt_gateways")?(e=r.L0.metadata("peachpay_poynt_gateways","poynt_src"),t=r.L0.metadata("peachpay_poynt_gateways","business_id"),u=r.L0.metadata("peachpay_poynt_gateways","application_id"),t&&u&&e?(p={businessId:t,applicationId:u},[4,(0,a.ve)(e,null,(function(){var e=function(){var n={},e={};if(r.L0.enabled("peachpay_poynt_card_gateway")){var t=function(){var n,e={name:null!==(n=r.L0.metadata("peachpay_poynt_card_gateway","title"))&&void 0!==n?n:(0,f.M)("Card"),gatewayId:"peachpay_poynt_card",description:"",assets:{title:{src:h},badge:{src:b}}},t=null;return{config:e,init:function(n){var e=(0,a.MW)('#pp-pms-new div.pp-pm-saved-option[data-gateway="peachpay_poynt_card"]');e&&(e.setAttribute("id","pp-poynt-new"),e.style.padding="0px",e.style.border="0px",e.style.width="-webkit-fill-available",(t=new g(n)).mount("pp-poynt-new",{iFrame:{border:"0px",borderRadius:"0px",boxShadow:"none",height:"84px",width:"-webkit-fill-available"}}))},tokenize:function(n){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(e){return t?[2,t.tokenize(n)]:[2,{error:"Poynt Card element not found while attempting to tokenize card."}]}))}))}}}();e[t.config.gatewayId]=t.config,n[t.config.gatewayId]=t}return d.h.dispatch((0,s.Cj)(e)),n}();!function(n,e,t){var u,p;try{for(var y=(0,i.XA)(Object.entries(n)),h=y.next();!h.done;h=y.next()){var b=(0,i.CR)(h.value,2),g=(b[0],b[1]);g.init&&g.init(t)}}catch(n){u={error:n}}finally{try{h&&!h.done&&(p=y.return)&&p.call(y)}finally{if(u)throw u.error}}var m=function(t){if((0,o.N6)()){var u=t.target;if(null==u?void 0:u.closest("button")){var p=s.hv.selectedGateway(),y=n[p];if(y)return function(n,e){return(0,i.mG)(this,void 0,void 0,(function(){var t,o,s,u,p,y,h,b,g,m,w;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return(0,a.HD)(".pp-pm-error-text",(function(n){n.remove()})),d.h.dispatch((0,r.N5)()),t=function(){var n={};c.gx.billing.email()&&(n.emailAddress=c.gx.billing.email());c.gx.billing.firstName()&&(n.firstName=c.gx.billing.firstName());c.gx.billing.lastName()&&(n.lastName=c.gx.billing.lastName());c.gx.billing.address1()&&(n.line1=c.gx.billing.address1());c.gx.billing.postal()&&(n.zipCode=c.gx.billing.postal());return n}(),[4,n.tokenize(t)];case 1:return o=i.sent(),s=o.nonce,u=o.error,[4,e.startTransaction(n.config.gatewayId)];case 2:return p=i.sent(),y=p.error,h=p.result,y||!h?(b=y?(0,v.H)(y):(0,f.M)("An unknown error occured while starting the transaction. Please refresh the page and try again."),(0,l.j1)(b),d.h.dispatch((0,r.tv)()),[2]):(null!=u?u:!s)?[4,h.complete({paymentStatus:"creationfailed",orderStatus:"unperformed",note:null!=u?u:"An unknown error occured while retrieving the nonce."})]:[3,4];case 3:return i.sent(),(0,l.j1)(null!=u?u:"An unknown error occured while tokenizing the payment method."),d.h.dispatch((0,r.tv)()),[2];case 4:return[4,e.placeOrder(h,{peachpay_poynt_nonce:s})];case 5:return g=i.sent(),m=g.error,w=g.result,m||!w||"success"!==w.result?(d.h.dispatch((0,r.tv)()),[2]):window.top?[4,h.complete()]:[3,7];case 6:i.sent(),window.top.location=w.redirect,i.label=7;case 7:return[2]}}))}))}(y,e)}}};(0,a.HD)(".poynt-btn",(function(n){n.addEventListener("click",(function(n){return m(n)}))}))}(e,n,p),y()}))]):[2]):[2];case 1:return m.sent(),[2]}}))}))}},8883:(n,e,t)=>{n.exports=t.p+"img/d2a66f3e82ab3efab425-card.svg"},5792:(n,e,t)=>{n.exports=t.p+"img/b2c8b12eb49165de87d5-credit-card-regular.svg"}}]);
//# sourceMappingURL=669-e7d57ad1972ed4ad9765.js.map
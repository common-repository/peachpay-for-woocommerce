!function(){try{var n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e=(new Error).stack;e&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[e]="dde13927-f079-4f39-888b-4d8f880e1b88",n._sentryDebugIdIdentifier="sentry-dbid-dde13927-f079-4f39-888b-4d8f880e1b88")}catch(n){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"1.100.0"},(self.webpackChunkpeachpay_for_woocommerce=self.webpackChunkpeachpay_for_woocommerce||[]).push([[669],{1669:(n,e,t)=>{t.r(e),t.d(e,{default:()=>w});var i=t(3940),a=t(3629),o=t(7705),r=t(1682),s=t(3984),d=t(7150),c=t(3458),l=t(7246),u=t(8472),p=t(8072),f=t(2494),y=t(4284);function h(){c.h.subscribe((function(){!function(n,e,t){n.startsWith("peachpay_poynt_")&&"payment"===e?(0,a.HD)(".poynt-btn-container",(function(n){n.classList.remove("hide")})):(0,a.HD)(".poynt-btn-container",(function(n){n.classList.add("hide")}));"loading"===t?(0,a.HD)(".poynt-btn",(function(n){n.classList.add("hide")})):(0,a.HD)(".poynt-btn",(function(n){n.classList.remove("hide")}))}(s.hv.selectedGateway(),r.qA.modalUI.page(),r.qA.modalUI.loadingMode()),function(n){"loading"===n?(0,a.HD)(".poynt-spinner-container",(function(n){n.classList.remove("hide")})):(0,a.HD)(".poynt-spinner-container",(function(n){n.classList.add("hide")}));"processing"===n?(0,a.HD)(".poynt-btn-spinner",(function(n){n.classList.remove("hide")})):(0,a.HD)(".poynt-btn-spinner",(function(n){n.classList.add("hide")}));"processing"===n?(0,a.HD)(".poynt-btn > .button-text",(function(n){n.innerHTML=(0,y.M)("Processing")})):(0,a.HD)(".poynt-btn > .button-text",(function(n){n.innerHTML="".concat((0,y.M)("Pay")," ").concat((0,f.o)(p.AQ.total()))}));"finished"===n?(0,a.HD)(".poynt-btn",(function(n){n.disabled=!1})):(0,a.HD)(".poynt-btn",(function(n){n.disabled=!0}))}(r.qA.modalUI.loadingMode())}))}var g=t(5792),b=t(8883),v=function(){function n(n){this.businessId=n.businessId,this.applicationId=n.applicationId,this.$cardElement=new TokenizeJs(this.businessId,this.applicationId)}return n.prototype.mount=function(n,e){this.$cardElement.mount(n,document,e)},n.prototype.tokenize=function(n){return(0,i.mG)(this,void 0,void 0,(function(){var e=this;return(0,i.Jh)(this,(function(t){return[2,new Promise((function(t){e.$cardElement.on("nonce",(function(n){n.data.nonce&&t({nonce:n.data.nonce})})),e.$cardElement.on("error",(function(n){var e,i,a,o,r;t({error:null!==(r=null!==(i=null===(e=n.data)||void 0===e?void 0:e.message)&&void 0!==i?i:null===(o=null===(a=n.data)||void 0===a?void 0:a.error)||void 0===o?void 0:o.message)&&void 0!==r?r:"Something went wrong. Please try again."})})),e.$cardElement.getNonce(n)}))]}))}))},n}();var m=t(4681);function w(n){return(0,i.mG)(this,void 0,void 0,(function(){var e,t,p,f;return(0,i.Jh)(this,(function(w){switch(w.label){case 0:return r.L0.enabled("peachpay_poynt_gateways")?(e=r.L0.metadata("peachpay_poynt_gateways","poynt_src"),t=r.L0.metadata("peachpay_poynt_gateways","business_id"),p=r.L0.metadata("peachpay_poynt_gateways","application_id"),t&&p&&e?(f={businessId:t,applicationId:p},[4,(0,a.ve)(e,null,(function(){var e=function(){var n={},e={};if(r.L0.enabled("peachpay_poynt_card_gateway")){var t=function(){var n,e={name:null!==(n=r.L0.metadata("peachpay_poynt_card_gateway","title"))&&void 0!==n?n:(0,y.M)("Card"),gatewayId:"peachpay_poynt_card",description:"",assets:{title:{src:g},badge:{src:b}}},t=null;return{config:e,init:function(n){var e=(0,a.MW)('#pp-pms-new div.pp-pm-saved-option[data-gateway="peachpay_poynt_card"]');e&&(e.setAttribute("id","pp-poynt-new"),e.style.padding="0px",e.style.border="0px",e.style.width="-webkit-fill-available",(t=new v(n)).mount("pp-poynt-new",{iFrame:{border:"0px",borderRadius:"0px",boxShadow:"none",height:"84px",width:"-webkit-fill-available"}}))},tokenize:function(n){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(e){return t?[2,t.tokenize(n)]:[2,{error:"Poynt Card element not found while attempting to tokenize card."}]}))}))}}}();e[t.config.gatewayId]=t.config,n[t.config.gatewayId]=t}return c.h.dispatch((0,s.Cj)(e)),n}();!function(n,e,t){var p,f;try{for(var h=(0,i.XA)(Object.entries(n)),g=h.next();!g.done;g=h.next()){var b=(0,i.CR)(g.value,2),v=(b[0],b[1]);v.init&&v.init(t)}}catch(n){p={error:n}}finally{try{g&&!g.done&&(f=h.return)&&f.call(h)}finally{if(p)throw p.error}}var w=function(t){if((0,o.N6)()){var p=t.target;if(null==p?void 0:p.closest("button")){var f=s.hv.selectedGateway(),h=n[f];if(h)return function(n,e){return(0,i.mG)(this,void 0,void 0,(function(){var t,o,s,p,f,h,g,b,v,w,_;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return(0,a.HD)(".pp-pm-error-text",(function(n){n.remove()})),c.h.dispatch((0,r.N5)()),t=function(){var n={};d.gx.billing.email()&&(n.emailAddress=d.gx.billing.email());d.gx.billing.firstName()&&(n.firstName=d.gx.billing.firstName());d.gx.billing.lastName()&&(n.lastName=d.gx.billing.lastName());d.gx.billing.address1()&&(n.line1=d.gx.billing.address1());d.gx.billing.postal()&&(n.zipCode=d.gx.billing.postal());return n}(),[4,n.tokenize(t)];case 1:return o=i.sent(),s=o.nonce,p=o.error,[4,e.startTransaction(n.config.gatewayId)];case 2:return f=i.sent(),h=f.error,g=f.result,h||!g?(b=h?(0,m.H)(h):(0,y.M)("An unknown error occured while starting the transaction. Please refresh the page and try again."),(0,l.j1)(b),c.h.dispatch((0,r.tv)()),[2]):(null!=p?p:!s)?[4,g.complete({paymentStatus:"creationfailed",orderStatus:"unperformed",note:null!=p?p:"An unknown error occured while retrieving the nonce."})]:[3,4];case 3:return i.sent(),(0,l.j1)(null!=p?p:"An unknown error occured while tokenizing the payment method."),c.h.dispatch((0,r.tv)()),[2];case 4:return[4,e.placeOrder(g,{peachpay_poynt_nonce:s})];case 5:return v=i.sent(),w=v.error,_=v.result,w||!_||"success"!==_.result?(c.h.dispatch((0,r.tv)()),[2]):((0,u.c)(),window.top?[4,g.complete()]:[3,7]);case 6:i.sent(),window.top.location=_.redirect,i.label=7;case 7:return[2]}}))}))}(h,e)}}};(0,a.HD)(".poynt-btn",(function(n){n.addEventListener("click",(function(n){return w(n)}))}))}(e,n,f),h()}))]):[2]):[2];case 1:return w.sent(),[2]}}))}))}},8883:(n,e,t)=>{n.exports=t.p+"img/d2a66f3e82ab3efab425-card.svg"},5792:(n,e,t)=>{n.exports=t.p+"img/b2c8b12eb49165de87d5-credit-card-regular.svg"}}]);
//# sourceMappingURL=669-16a16281a2534f74cf68.js.map
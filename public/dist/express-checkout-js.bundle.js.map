{"version":3,"file":"express-checkout-js.bundle.js","mappings":"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","sources":["webpack://peachpay-for-woocommerce/webpack/runtime/load script","webpack://peachpay-for-woocommerce/../src/addressFormats.ts","webpack://peachpay-for-woocommerce/../src/formatAddress.ts","webpack://peachpay-for-woocommerce/./node_modules/tslib/tslib.es6.js","webpack://peachpay-for-woocommerce/./node_modules/url-search-params-polyfill/index.js","webpack://peachpay-for-woocommerce/./frontend/@shared/ts/dom.ts","webpack://peachpay-for-woocommerce/./frontend/@shared/ts/error.ts","webpack://peachpay-for-woocommerce/./frontend/@shared/ts/hooks.ts","webpack://peachpay-for-woocommerce/./frontend/@shared/ts/maybe.ts","webpack://peachpay-for-woocommerce/./frontend/@shared/ts/sentry.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/botProtection.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/slideUpView.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/modalPage.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/fields/validation.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/modal.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/models/GatewayConfiguration.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/payment/order.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/reducers/cartReducer.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/reducers/environmentReducer.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/reducers/initialState.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/reducers/merchantConfigurationReducer.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/reducers/paymentConfigurationReducer.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/reducers/peachPayCustomerReducer.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/reducers/peachPayOrderReducer.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/reducers/rootReducer.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/sdk.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/store.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/util/string.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/util/cart.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/util/currency.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/util/debounce.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/util/translation.ts","webpack://peachpay-for-woocommerce/webpack/bootstrap","webpack://peachpay-for-woocommerce/webpack/runtime/compat get default export","webpack://peachpay-for-woocommerce/webpack/runtime/define property getters","webpack://peachpay-for-woocommerce/webpack/runtime/ensure chunk","webpack://peachpay-for-woocommerce/webpack/runtime/get javascript chunk filename","webpack://peachpay-for-woocommerce/webpack/runtime/get mini-css chunk filename","webpack://peachpay-for-woocommerce/webpack/runtime/global","webpack://peachpay-for-woocommerce/webpack/runtime/hasOwnProperty shorthand","webpack://peachpay-for-woocommerce/webpack/runtime/make namespace object","webpack://peachpay-for-woocommerce/webpack/runtime/publicPath","webpack://peachpay-for-woocommerce/webpack/runtime/jsonp chunk loading","webpack://peachpay-for-woocommerce/./node_modules/whatwg-fetch/fetch.js","webpack://peachpay-for-woocommerce/./node_modules/formdata-polyfill/formdata.min.js","webpack://peachpay-for-woocommerce/./node_modules/resize-observer-polyfill/dist/ResizeObserver.es.js","webpack://peachpay-for-woocommerce/./frontend/polyfills.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/deprecated/global.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/account.ts","webpack://peachpay-for-woocommerce/./node_modules/@googlemaps/js-api-loader/node_modules/tslib/tslib.es6.js","webpack://peachpay-for-woocommerce/./node_modules/@googlemaps/js-api-loader/node_modules/fast-deep-equal/index.js","webpack://peachpay-for-woocommerce/./node_modules/@googlemaps/js-api-loader/src/index.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/addressAutocomplete.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/util/dom.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/quantityChanger.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/cart.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/util/ui.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/coupon.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/currency.ts","webpack://peachpay-for-woocommerce/./frontend/@shared/ts/currency.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/currencySwitch.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/customOrderMessaging.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/giftCard.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/oneClickUpsell.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/paymentSelector.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/relatedProducts.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/util/subscription.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/summary.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/util/country.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/vat.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/payment/peachpay/button.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/payment/peachpay/purchaseOrder.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/payment/free/button.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/payment/free/free.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/payment/peachpay/cod.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/payment/peachpay/cheque.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/payment/peachpay/bacs.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/payment/peachpay/peachpay.ts","webpack://peachpay-for-woocommerce/./frontend/git.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/fields/addressLocale.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/fields/billingForm.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/fields/shippingOptionsForm.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/main.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/language.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/fields/shippingForm.ts","webpack://peachpay-for-woocommerce/./frontend/express-checkout/ts/features/merchantLogo.ts"],"sourcesContent":["var inProgress = {};\nvar dataWebpackPrefix = \"peachpay-for-woocommerce:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};",null,null,"/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n","/**\n *\n *\n * @author Jerry Bendy <jerry@icewingcc.com>\n * @licence MIT\n *\n */\n\n(function(self) {\n    'use strict';\n\n    var nativeURLSearchParams = (function() {\n            // #41 Fix issue in RN\n            try {\n                if (self.URLSearchParams && (new self.URLSearchParams('foo=bar')).get('foo') === 'bar') {\n                    return self.URLSearchParams;\n                }\n            } catch (e) {}\n            return null;\n        })(),\n        isSupportObjectConstructor = nativeURLSearchParams && (new nativeURLSearchParams({a: 1})).toString() === 'a=1',\n        // There is a bug in safari 10.1 (and earlier) that incorrectly decodes `%2B` as an empty space and not a plus.\n        decodesPlusesCorrectly = nativeURLSearchParams && (new nativeURLSearchParams('s=%2B').get('s') === '+'),\n        __URLSearchParams__ = \"__URLSearchParams__\",\n        // Fix bug in Edge which cannot encode ' &' correctly\n        encodesAmpersandsCorrectly = nativeURLSearchParams ? (function() {\n            var ampersandTest = new nativeURLSearchParams();\n            ampersandTest.append('s', ' &');\n            return ampersandTest.toString() === 's=+%26';\n        })() : true,\n        prototype = URLSearchParamsPolyfill.prototype,\n        iterable = !!(self.Symbol && self.Symbol.iterator);\n\n    if (nativeURLSearchParams && isSupportObjectConstructor && decodesPlusesCorrectly && encodesAmpersandsCorrectly) {\n        return;\n    }\n\n\n    /**\n     * Make a URLSearchParams instance\n     *\n     * @param {object|string|URLSearchParams} search\n     * @constructor\n     */\n    function URLSearchParamsPolyfill(search) {\n        search = search || \"\";\n\n        // support construct object with another URLSearchParams instance\n        if (search instanceof URLSearchParams || search instanceof URLSearchParamsPolyfill) {\n            search = search.toString();\n        }\n        this [__URLSearchParams__] = parseToDict(search);\n    }\n\n\n    /**\n     * Appends a specified key/value pair as a new search parameter.\n     *\n     * @param {string} name\n     * @param {string} value\n     */\n    prototype.append = function(name, value) {\n        appendTo(this [__URLSearchParams__], name, value);\n    };\n\n    /**\n     * Deletes the given search parameter, and its associated value,\n     * from the list of all search parameters.\n     *\n     * @param {string} name\n     */\n    prototype['delete'] = function(name) {\n        delete this [__URLSearchParams__] [name];\n    };\n\n    /**\n     * Returns the first value associated to the given search parameter.\n     *\n     * @param {string} name\n     * @returns {string|null}\n     */\n    prototype.get = function(name) {\n        var dict = this [__URLSearchParams__];\n        return this.has(name) ? dict[name][0] : null;\n    };\n\n    /**\n     * Returns all the values association with a given search parameter.\n     *\n     * @param {string} name\n     * @returns {Array}\n     */\n    prototype.getAll = function(name) {\n        var dict = this [__URLSearchParams__];\n        return this.has(name) ? dict [name].slice(0) : [];\n    };\n\n    /**\n     * Returns a Boolean indicating if such a search parameter exists.\n     *\n     * @param {string} name\n     * @returns {boolean}\n     */\n    prototype.has = function(name) {\n        return hasOwnProperty(this [__URLSearchParams__], name);\n    };\n\n    /**\n     * Sets the value associated to a given search parameter to\n     * the given value. If there were several values, delete the\n     * others.\n     *\n     * @param {string} name\n     * @param {string} value\n     */\n    prototype.set = function set(name, value) {\n        this [__URLSearchParams__][name] = ['' + value];\n    };\n\n    /**\n     * Returns a string containg a query string suitable for use in a URL.\n     *\n     * @returns {string}\n     */\n    prototype.toString = function() {\n        var dict = this[__URLSearchParams__], query = [], i, key, name, value;\n        for (key in dict) {\n            name = encode(key);\n            for (i = 0, value = dict[key]; i < value.length; i++) {\n                query.push(name + '=' + encode(value[i]));\n            }\n        }\n        return query.join('&');\n    };\n\n    // There is a bug in Safari 10.1 and `Proxy`ing it is not enough.\n    var forSureUsePolyfill = !decodesPlusesCorrectly;\n    var useProxy = (!forSureUsePolyfill && nativeURLSearchParams && !isSupportObjectConstructor && self.Proxy);\n    var propValue; \n    if (useProxy) {\n        // Safari 10.0 doesn't support Proxy, so it won't extend URLSearchParams on safari 10.0\n        propValue = new Proxy(nativeURLSearchParams, {\n            construct: function (target, args) {\n                return new target((new URLSearchParamsPolyfill(args[0]).toString()));\n            }\n        })\n        // Chrome <=60 .toString() on a function proxy got error \"Function.prototype.toString is not generic\"\n        propValue.toString = Function.prototype.toString.bind(URLSearchParamsPolyfill);\n    } else {\n        propValue = URLSearchParamsPolyfill;\n    }\n    /*\n     * Apply polifill to global object and append other prototype into it\n     */\n    Object.defineProperty(self, 'URLSearchParams', {\n        value: propValue\n    });\n\n    var USPProto = self.URLSearchParams.prototype;\n\n    USPProto.polyfill = true;\n\n    /**\n     *\n     * @param {function} callback\n     * @param {object} thisArg\n     */\n    USPProto.forEach = USPProto.forEach || function(callback, thisArg) {\n        var dict = parseToDict(this.toString());\n        Object.getOwnPropertyNames(dict).forEach(function(name) {\n            dict[name].forEach(function(value) {\n                callback.call(thisArg, value, name, this);\n            }, this);\n        }, this);\n    };\n\n    /**\n     * Sort all name-value pairs\n     */\n    USPProto.sort = USPProto.sort || function() {\n        var dict = parseToDict(this.toString()), keys = [], k, i, j;\n        for (k in dict) {\n            keys.push(k);\n        }\n        keys.sort();\n\n        for (i = 0; i < keys.length; i++) {\n            this['delete'](keys[i]);\n        }\n        for (i = 0; i < keys.length; i++) {\n            var key = keys[i], values = dict[key];\n            for (j = 0; j < values.length; j++) {\n                this.append(key, values[j]);\n            }\n        }\n    };\n\n    /**\n     * Returns an iterator allowing to go through all keys of\n     * the key/value pairs contained in this object.\n     *\n     * @returns {function}\n     */\n    USPProto.keys = USPProto.keys || function() {\n        var items = [];\n        this.forEach(function(item, name) {\n            items.push(name);\n        });\n        return makeIterator(items);\n    };\n\n    /**\n     * Returns an iterator allowing to go through all values of\n     * the key/value pairs contained in this object.\n     *\n     * @returns {function}\n     */\n    USPProto.values = USPProto.values || function() {\n        var items = [];\n        this.forEach(function(item) {\n            items.push(item);\n        });\n        return makeIterator(items);\n    };\n\n    /**\n     * Returns an iterator allowing to go through all key/value\n     * pairs contained in this object.\n     *\n     * @returns {function}\n     */\n    USPProto.entries = USPProto.entries || function() {\n        var items = [];\n        this.forEach(function(item, name) {\n            items.push([name, item]);\n        });\n        return makeIterator(items);\n    };\n\n\n    if (iterable) {\n        USPProto[self.Symbol.iterator] = USPProto[self.Symbol.iterator] || USPProto.entries;\n    }\n\n\n    function encode(str) {\n        var replace = {\n            '!': '%21',\n            \"'\": '%27',\n            '(': '%28',\n            ')': '%29',\n            '~': '%7E',\n            '%20': '+',\n            '%00': '\\x00'\n        };\n        return encodeURIComponent(str).replace(/[!'\\(\\)~]|%20|%00/g, function(match) {\n            return replace[match];\n        });\n    }\n\n    function decode(str) {\n        return str\n            .replace(/[ +]/g, '%20')\n            .replace(/(%[a-f0-9]{2})+/ig, function(match) {\n                return decodeURIComponent(match);\n            });\n    }\n\n    function makeIterator(arr) {\n        var iterator = {\n            next: function() {\n                var value = arr.shift();\n                return {done: value === undefined, value: value};\n            }\n        };\n\n        if (iterable) {\n            iterator[self.Symbol.iterator] = function() {\n                return iterator;\n            };\n        }\n\n        return iterator;\n    }\n\n    function parseToDict(search) {\n        var dict = {};\n\n        if (typeof search === \"object\") {\n            // if `search` is an array, treat it as a sequence\n            if (isArray(search)) {\n                for (var i = 0; i < search.length; i++) {\n                    var item = search[i];\n                    if (isArray(item) && item.length === 2) {\n                        appendTo(dict, item[0], item[1]);\n                    } else {\n                        throw new TypeError(\"Failed to construct 'URLSearchParams': Sequence initializer must only contain pair elements\");\n                    }\n                }\n\n            } else {\n                for (var key in search) {\n                    if (search.hasOwnProperty(key)) {\n                        appendTo(dict, key, search[key]);\n                    }\n                }\n            }\n\n        } else {\n            // remove first '?'\n            if (search.indexOf(\"?\") === 0) {\n                search = search.slice(1);\n            }\n\n            var pairs = search.split(\"&\");\n            for (var j = 0; j < pairs.length; j++) {\n                var value = pairs [j],\n                    index = value.indexOf('=');\n\n                if (-1 < index) {\n                    appendTo(dict, decode(value.slice(0, index)), decode(value.slice(index + 1)));\n\n                } else {\n                    if (value) {\n                        appendTo(dict, decode(value), '');\n                    }\n                }\n            }\n        }\n\n        return dict;\n    }\n\n    function appendTo(dict, name, value) {\n        var val = typeof value === 'string' ? value : (\n            value !== null && value !== undefined && typeof value.toString === 'function' ? value.toString() : JSON.stringify(value)\n        );\n\n        // #47 Prevent using `hasOwnProperty` as a property name\n        if (hasOwnProperty(dict, name)) {\n            dict[name].push(val);\n        } else {\n            dict[name] = [val];\n        }\n    }\n\n    function isArray(val) {\n        return !!val && '[object Array]' === Object.prototype.toString.call(val);\n    }\n\n    function hasOwnProperty(obj, prop) {\n        return Object.prototype.hasOwnProperty.call(obj, prop);\n    }\n\n})(typeof global !== 'undefined' ? global : (typeof window !== 'undefined' ? window : this));\n","import {getErrorString} from './error';\nimport {type IWindowFetchMessage, type IWindowMessage} from '../../@type/window-messages';\nimport {captureSentryException} from './sentry';\n\n/**\n * Resulting helper function to comply with typescript by\n * always checking the result of $qs\n *\n * @param { string } \t\tselector html query selector string\n * @param { (T) => void } \tcb callback function that will only be called if the element is found\n */\nfunction $qs<T extends HTMLElement>(selector: string, cb: null | (($element: T) => void) = null): T | null {\n\tconst $element = document.querySelector<T>(selector);\n\tif ($element && cb !== null) {\n\t\tcb($element);\n\t}\n\n\treturn $element;\n}\n\n/**\n * Helper function for \"document.querySelectorAll\" that always returns a proper array\n * and has the base type \"HTMLElement\" instead of the almost never used \"Element\".\n */\nfunction $qsAll<T extends HTMLElement>(selector: string, callback?: ($element: T) => void): T[] {\n\tconst result = Array.from(document.querySelectorAll<T>(selector));\n\n\tif (callback) {\n\t\tfor (const $element of result) {\n\t\t\tcallback($element);\n\t\t}\n\t}\n\n\treturn result;\n}\n\n/**\n * Loads a given JS script.\n *\n * @param src URL of the script\n * @param scriptWindowObject Name of the object the script defines if the script defines any objects\n */\nasync function loadScript(src: string, scriptWindowObject: string | null, callback?: () => void): Promise<void> {\n\treturn new Promise((resolve, reject) => {\n\t\tif (document.querySelector(`script[src=\"${src}\"]`) ?? (window as any)[scriptWindowObject ?? '']) {\n\t\t\tcallback?.();\n\t\t\tresolve();\n\t\t}\n\n\t\tconst $script = document.createElement('script');\n\t\t$script.type = 'text/javascript';\n\t\t$script.src = src;\n\n\t\t($script as any).onreadystatechange = () => {\n\t\t\tcallback?.();\n\t\t\tresolve();\n\t\t};\n\n\t\t$script.onload = () => {\n\t\t\tcallback?.();\n\t\t\tresolve();\n\t\t};\n\n\t\t$script.onerror = reject;\n\n\t\tdocument.head.appendChild($script);\n\t});\n}\n\ninterface WindowFetchData<T> {\n\terror: Error;\n\tresult: T;\n}\n\nasync function fetchWindowData<TRequest, TResponse>(targetWindow: Window | null, endpoint: string, request?: TRequest): Promise<TResponse> {\n\treturn new Promise((resolve, reject) => {\n\t\tconst channel = new MessageChannel();\n\t\tchannel.port1.onmessage = ({data}) => {\n\t\t\tchannel.port1.close();\n\n\t\t\tif ((data as WindowFetchData<TResponse>).error) {\n\t\t\t\treject((data as WindowFetchData<TResponse>).error);\n\t\t\t} else {\n\t\t\t\tresolve((data as WindowFetchData<TResponse>).result);\n\t\t\t}\n\t\t};\n\n\t\tif (targetWindow) {\n\t\t\ttargetWindow.postMessage(\n\t\t\t\t{\n\t\t\t\t\tevent: endpoint,\n\t\t\t\t\trequest,\n\t\t\t\t},\n\t\t\t\tlocation.origin,\n\t\t\t\t[channel.port2],\n\t\t\t);\n\t\t} else {\n\t\t\treject(new Error('Target window is not valid.'));\n\t\t}\n\t});\n}\n\n/**\n * Allows for async request from the host page for data.\n */\nfunction onWindowDataFetch<TRequest, TResponse>(endpoint: string, requestCallback: (request: TRequest) => Promise<TResponse> | TResponse): void {\n\twindow.addEventListener('message', async (message: MessageEvent<IWindowFetchMessage<TRequest>>) => {\n\t\tif (message.origin !== location.origin) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (message.data.event === endpoint) {\n\t\t\ttry {\n\t\t\t\tconst response = await requestCallback(message.data.request as unknown as TRequest);\n\n\t\t\t\tmessage.ports?.[0]?.postMessage({result: response});\n\t\t\t} catch (error: unknown) {\n\t\t\t\ttry {\n\t\t\t\t\tmessage.ports?.[0]?.postMessage({error});\n\t\t\t\t} catch (secondaryError: unknown) {\n\t\t\t\t\tmessage.ports?.[0]?.postMessage({error: new Error(getErrorString(error))});\n\t\t\t\t\tcaptureSentryException(secondaryError as Error, {\n\t\t\t\t\t\toriginalError: error,\n\t\t\t\t\t\toriginalErrorString: getErrorString(error),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n}\n\nasync function fetchHostWindowData<TRequest, TResponse>(endpoint: string, request?: TRequest): Promise<TResponse> {\n\treturn fetchWindowData(window.top, endpoint, request);\n}\n\n/**\n * Helper function to give strong typing to a Message Event\n */\nfunction onWindowMessage<T extends IWindowMessage>(eventName: string, cb: (event: T) => void | Promise<void>) {\n\twindow.addEventListener('message', async (event: MessageEvent<T>) => {\n\t\tif (event.origin !== location.origin) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.data.event === eventName) {\n\t\t\tawait cb(event.data);\n\t\t}\n\t}, false);\n}\n\n// https://ourcodeworld.com/articles/read/376/how-to-strip-html-from-a-string-extract-only-text-content-in-javascript\nfunction stripHtml(html: string, preFilterSelector: string | null = 'a'): string {\n\tconst temporalDivElement = document.createElement('div');\n\ttemporalDivElement.innerHTML = html;\n\n\tif (preFilterSelector) {\n\t\ttemporalDivElement.querySelectorAll(preFilterSelector).forEach($el => {\n\t\t\t$el.remove();\n\t\t});\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/prefer-nullish-coalescing\n\treturn (temporalDivElement.textContent || temporalDivElement.innerText || '').trim();\n}\n\nfunction isMobile() {\n\treturn window.innerWidth < 900;\n}\n\nexport {\n\t$qs,\n\t$qsAll,\n\tstripHtml,\n\tloadScript,\n\tfetchHostWindowData,\n\tonWindowMessage,\n\tonWindowDataFetch,\n\tisMobile,\n};\n","/**\n * Gets a stringified error or if the stringified result is an empy string or empty object the default .toString() is used.\n * Created because JSON.stringify(error) will return {} for Error objects (https://stackoverflow.com/a/50738205/16998523).\n *\n * @param {unknown} error\n */\nexport function getErrorString(error: unknown): string {\n\tif (error instanceof Error && error.stack) {\n\t\treturn error.stack;\n\t}\n\n\tconst errorString = JSON.stringify(error);\n\treturn errorString && errorString !== '{}' ? errorString : `${error as string}`;\n}\n\n/**\n * Takes an unknown value and coerces it into an error and finally returns the error message string\n */\nexport function getErrorMessage(thrownError: unknown) {\n\treturn _toErrorWithMessage(thrownError).message;\n}\n\nfunction _toErrorWithMessage(thrownError: unknown): {message: string} {\n\tif (_isErrorWithMessage(thrownError)) {\n\t\treturn thrownError;\n\t}\n\n\ttry {\n\t\treturn new Error(JSON.stringify(thrownError));\n\t} catch {\n\t\treturn new Error(String(thrownError));\n\t}\n}\n\nfunction _isErrorWithMessage(thrownError: unknown): thrownError is {message: string} {\n\treturn (\n\t\ttypeof thrownError === 'object'\n    && thrownError !== null\n    && 'message' in thrownError\n    && typeof thrownError.message === 'string'\n\t);\n}\n\nfunction _isErrorWithName(error: unknown): error is {name: string} {\n\treturn typeof error === 'object' && error !== null && 'name' in error && typeof error.name === 'string';\n}\n\nexport function getErrorName(error: unknown): string | null {\n\tif (_isErrorWithName(error)) {\n\t\treturn error.name;\n\t}\n\n\treturn null;\n}\n","import {type ModalPage} from '../../express-checkout/ts/models/IEnvironment';\n\ndeclare global {\n\tinterface ActionCallback {\n\t\t'after_modal_open': () => Promise<void> | void;\n\n\t\t'before_billing_page': (fromPage: ModalPage, toPage: ModalPage) => Promise<void> | void;\n\t\t'after_billing_page': (fromPage: ModalPage, toPage: ModalPage) => Promise<void> | void;\n\n\t\t'before_shipping_page': (fromPage: ModalPage, toPage: ModalPage) => Promise<void> | void;\n\t\t'after_shipping_page': (fromPage: ModalPage, toPage: ModalPage) => Promise<void> | void;\n\n\t\t'before_payment_page': (fromPage: ModalPage, toPage: ModalPage) => Promise<void> | void;\n\t\t'after_payment_page': (fromPage: ModalPage, toPage: ModalPage) => Promise<void> | void;\n\t}\n}\ntype ActionHook = {\n\tpriority: number;\n\tcallback: ActionCallback[keyof ActionCallback];\n};\nconst actionEvents: Record<string, ActionHook[]> = {};\n\n/**\n * Adds an action hook callback.\n *\n * @param name The name of the action hook\n * @param callback The callback to run when the action hook is called\n * @param priority The priority of the callback. Lower numbers are executed first\n * @returns void\n *\n * @example ```ts\n * addAction('example', example => console.log(example));\n * ```\n */\nfunction addAction<T extends keyof ActionCallback>(name: T, callback: ActionCallback[T], priority = 10): void {\n\tif (!actionEvents[name]) {\n\t\tactionEvents[name] = [];\n\t}\n\n\tactionEvents[name]!.push({\n\t\tpriority,\n\t\tcallback,\n\t});\n\n\tactionEvents[name]!.sort((a, b) => a.priority - b.priority);\n}\n\n/**\n * Runs all callbacks for the given action hook.\n *\n * @param name The name of the action hook\n * @param args The arguments to pass to the callbacks\n * @returns Promise<void>\n *\n * @example ```ts\n * doAction('example', 20).catch(console.error);\n * ```\n */\nasync function doAction<T extends keyof ActionCallback>(name: T, ...args: Parameters<ActionCallback[T]>): Promise<void> {\n\tconst actionList = actionEvents[name];\n\tif (!actionList) {\n\t\treturn;\n\t}\n\n\tfor (const action of actionList) {\n\t\t// eslint-disable-next-line no-await-in-loop\n\t\tawait action.callback.apply(null, args);\n\t}\n}\n\ndeclare global {\n\tinterface FilterCallback {\n\t\t'example': (example: number) => Promise<number> | number;\n\t}\n}\ntype FilterHook = {\n\tpriority: number;\n\tcallback: FilterCallback[keyof FilterCallback];\n};\nconst filterEvents: Record<string, FilterHook[]> = {};\n\n/**\n * Adds a filter hook callback.\n *\n * @param name The name of the filter hook\n * @param callback The callback to run when the filter hook is called\n * @param priority The priority of the callback. Lower numbers are executed first\n *\n * @example ```ts\n * addFilter('example', example => example + 1);\n * ```\n */\nfunction addFilter<T extends keyof FilterCallback>(name: T, callback: FilterCallback[T], priority = 10): void {\n\tif (!filterEvents[name]) {\n\t\tfilterEvents[name] = [];\n\t}\n\n\tfilterEvents[name]!.push({\n\t\tpriority,\n\t\tcallback,\n\t});\n\n\tfilterEvents[name]!.sort((a, b) => a.priority - b.priority);\n}\n\n/**\n * Runs all callbacks for the given filter hook.\n *\n * @param name The name of the filter hook\n * @param args The arguments to pass to the callbacks\n * @returns The filtered first argument value\n *\n * @example ```ts\n * applyFilters('example', 1).then(console.log).catch(console.error);\n * ```\n */\nasync function applyFilters<T extends keyof FilterCallback>(name: T, ...args: Parameters<FilterCallback[T]>): Promise<Parameters<FilterCallback[T]>[0]> {\n\tlet value = args[0] as Parameters<FilterCallback[T]>[0];\n\n\tconst filterList = filterEvents[name];\n\tif (!filterList) {\n\t\treturn value;\n\t}\n\n\tfor (const filter of filterList) {\n\t\t// eslint-disable-next-line no-await-in-loop\n\t\tvalue = await filter.callback.apply(null, args) as Parameters<FilterCallback[T]>[0];\n\t\targs[0] = value;\n\t}\n\n\treturn value;\n}\n\nexport {\n\ttype ActionCallback,\n\taddAction,\n\tdoAction,\n\n\ttype FilterCallback,\n\taddFilter,\n\tapplyFilters,\n};\n","import {type IResponse} from '../../@type/response';\n\ntype Maybe<T> = {result?: T; error?: unknown};\n\n/**\n * Takes a promise and returns a Maybe type of the result or an error. This can be used to\n * avoid try/catch blocks which can be difficult to read and maintain.\n */\nasync function maybe<TResult = IResponse<void>>(promise: Promise<TResult>): Promise<Maybe<TResult>> {\n\treturn promise\n\t\t.then(result => ({result}))\n\t\t.catch((error: unknown) => ({error})) as Maybe<TResult>;\n}\n\n/**\n * Wraps a fetch request and returns a Maybe type of the resulting JSON or an error. This\n * can be used to avoid try/catch blocks which can be difficult to read and maintain.\n */\nasync function maybeFetch<TResult = IResponse<void>>(input: RequestInfo | URL, init?: RequestInit | undefined): Promise<Maybe<TResult>> {\n\treturn fetch(input, init)\n\t\t.then(async response => response.json() as Promise<TResult>)\n\t\t.then(result => ({result}))\n\t\t.catch((error: unknown) => ({error})) as Maybe<TResult>;\n}\n\n/**\n * This is a special version of maybeFetch that is used to fetch data from WordPress. WordPress sometimes\n * has bad plugins which will result in malformed JSON responses. This function will attempt to fix the malformed\n * JSON and return the corrected result.\n *\n * @param input The request URL\n * @param init The request init object\n * @param regexSelector A regex selector that will be used to extract the JSON from the malformed response if one is encountered.\n */\nasync function maybeFetchWP<TResult = IResponse<void>>(input: RequestInfo | URL, init?: RequestInit | undefined, regexSelector = /{\\s*\".*[^{}]*}/gs): Promise<Maybe<TResult>> {\n\treturn fetch(input, init)\n\t\t.then(async response => response.text())\n\t\t.then(jsonText => {\n\t\t\ttry {\n\t\t\t\treturn {result: JSON.parse(jsonText) as TResult} as Maybe<TResult>;\n\t\t\t} catch (error: unknown) {\n\t\t\t\t// Attempt to extract JSON from malformed response json text\n\t\t\t\tconst extractedJSONText = regexSelector.exec(jsonText);\n\n\t\t\t\tif (extractedJSONText === null || !extractedJSONText[0]) {\n\t\t\t\t\tconsole.log('Unable to fix malformed JSON');\n\t\t\t\t\t// Could not fix malformed JSON so just return the original error.\n\t\t\t\t\treturn {error} as Maybe<TResult>;\n\t\t\t\t}\n\n\t\t\t\tconsole.log('Fixed malformed JSON. Original:');\n\t\t\t\tconsole.log(jsonText);\n\t\t\t\treturn {result: JSON.parse(extractedJSONText[0]) as TResult} as Maybe<TResult>;\n\t\t\t}\n\t\t})\n\t\t.catch((error: unknown) => ({error} as Maybe<TResult>));\n}\n\nexport {\n\ttype Maybe,\n\n\tmaybe,\n\tmaybeFetch,\n\tmaybeFetchWP,\n};\n","/**\n * Sentry Types. These may not be accurate but we just need typescript happy\n */\ninterface SentryScope {\n\tsetFingerprint(fingerprint: any[]): void;\n\n\t// Debug, error,or other...\n\tsetLevel(level: string): void;\n\tsetExtra(key: string, value: string): void;\n}\n\ninterface SentryHub {\n\tonLoad(callback: () => void): void;\n\tinit(settings: any): void;\n\twithScope(cb: (scope: SentryScope) => void): void;\n\tcaptureException(ex: Error): void;\n\tcaptureMessage(message: string, level?: string): void;\n\tgetCurrentHub(): SentryHub;\n}\n\ndeclare const Sentry: SentryHub;\n\nfunction initSentry(release: string, dsn: string) {\n\tconst isStagingSite = /^(woo|qa|demo|ui-test|theme\\d*)\\.peachpay\\.app/i;\n\tconst isLocalSite = /^(store\\.local|localhost|127\\.0\\.0\\.1)/i;\n\n\tconst isDevelopmentMode = isStagingSite.test(location.hostname) || isLocalSite.test(location.hostname);\n\n\ttry {\n\t\tSentry.onLoad(() => {\n\t\t\tSentry.init({\n\t\t\t\tdsn,\n\t\t\t\tenvironment: isDevelopmentMode ? 'development' : 'production',\n\t\t\t\trelease,\n\t\t\t\tbeforeSend(event: unknown, hint: {originalException: unknown; syntheticException: unknown}) {\n\t\t\t\t\t// All of the PeachPay errors from the PeachPay SDK are atleast an instance of `Error`. We will\n\t\t\t\t\t// exclude everything else which is probably not our exceptions anyways.\n\t\t\t\t\tif (!(hint.originalException instanceof Error)) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\t// We only want exceptions that come from the Plugin folder \"peachpay-for-woocommerce\" or the page slug \"express-checkout\"\n\t\t\t\t\tif (!hint.originalException.stack?.includes('peachpay-for-woocommerce') && !hint.originalException.stack?.includes('express-checkout')) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn event;\n\t\t\t\t},\n\t\t\t\t// Ignore errors produced by Chrome, Firefox, and Safari upon\n\t\t\t\t// navigating away from a page that has a fetch request in progress.\n\t\t\t\t// See https://forum.sentry.io/t/typeerror-failed-to-fetch-reported-over-and-overe/8447/2\n\t\t\t\tignoreErrors: [\n\t\t\t\t\t'TypeError: Failed to fetch',\n\t\t\t\t\t'TypeError: NetworkError when attempting to fetch resource.',\n\t\t\t\t\t'TypeError: cancelled',\n\t\t\t\t\t'TypeError: cancelado',\n\t\t\t\t\t'TypeError: Abgebrochen',\n\t\t\t\t\t'TypeError: annulé',\n\t\t\t\t\t'Window navigated away',\n\t\t\t\t\t'annullato',\n\t\t\t\t\t'Load failed',\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\t} catch {\n\t// Sentry is not present. Do not make things worse!\n\t}\n}\n\n/**\n * Used to capture a exception with sentry\n *\n * @param error The error/exception to report\n * @param extra Details to include with the sentry report\n * @param fingerprint Fingerprint to identify a sequence of events?\n */\nfunction captureSentryException(error: Error, extra?: Record<string, any> | null, fingerprint?: any[] | null) {\n\ttry {\n\t\tSentry.withScope(scope => {\n\t\t\tif (extra) {\n\t\t\t\t// Attempt extras\n\t\t\t\ttry {\n\t\t\t\t\tObject.entries(extra).forEach(([key, value]) => {\n\t\t\t\t\t\tscope.setExtra(key, value);\n\t\t\t\t\t});\n\t\t\t\t} catch {\n\t\t\t\t\t// Do no harm.\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (fingerprint) {\n\t\t\t\t// Attempt Fingerprint\n\t\t\t\ttry {\n\t\t\t\t\tscope.setFingerprint(fingerprint);\n\t\t\t\t} catch {\n\t\t\t\t\t// Do no harm.\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Capture exception with any above set extras and/or fingerprint\n\t\t\tSentry.captureException(error);\n\t\t});\n\t} catch {\n\t\t// Sentry is not present. Don't make things worse.\n\t}\n}\n\nexport {\n\tinitSentry,\n\tcaptureSentryException,\n};\n","import {Feature} from '../reducers/environmentReducer';\nimport {FeatureFlag} from '../../../@type/features';\n\nexport function initBotProtection() {\n\tif (!Feature.enabled(FeatureFlag.BOT_PROTECTION)) {\n\t\treturn;\n\t}\n\n\tinstallCaptchaScript();\n}\n\nfunction installCaptchaScript() {\n\tconst script = document.createElement('script');\n\tscript.setAttribute('src', 'https://www.google.com/recaptcha/api.js?render=' + Feature.metadata(FeatureFlag.BOT_PROTECTION, 'site_key'));\n\n\tscript.async = true;\n\tscript.defer = true;\n\n\tdocument.body.appendChild(script);\n}\n\n/**\n * Returns a string (recaptcha token or placeholder) that gets appended to form data for captcha validation\n */\nexport async function getCaptchaToken(): Promise<string> {\n\tif (!Feature.enabled(FeatureFlag.BOT_PROTECTION)) {\n\t\treturn Promise.resolve('placeholder');\n\t}\n\n\treturn new Promise(resolve => {\n\t\tgrecaptcha.ready(async () => {\n\t\t\ttry {\n\t\t\t\tconst token = await grecaptcha.execute(Feature.metadata(FeatureFlag.BOT_PROTECTION, 'site_key') ?? '', {action: 'EXPRESS_CHECKOUT'});\n\t\t\t\tresolve(token);\n\t\t\t} catch (error: any) {\n\t\t\t\tresolve('');\n\t\t\t}\n\t\t});\n\t});\n}\n","import {store} from '../store';\nimport {Environment, startModalLoading, stopModalLoading} from '../reducers/environmentReducer';\nimport {$qs} from '../../../@shared/ts/dom';\n\n/* Makes sure the modal responds to window resize and scrolling WHILE the mobile slide-up view is open. */\nfunction handleResponsiveness() {\n\tconst ppModalContent = $qs('#pp-modal-content');\n\tif (ppModalContent) {\n\t\tlet location;\n\t\tlet mobileWidth;\n\t\tif (ppModalContent.classList.contains('pp-content-mobile')) {\n\t\t\tlocation = 'mobile';\n\t\t\tmobileWidth = '666px';\n\t\t} else {\n\t\t\tlocation = 'new';\n\t\t\tmobileWidth = '900px';\n\t\t}\n\n\t\tif (window.matchMedia(`(max-width: ${mobileWidth})`).matches) {\n\t\t\t$qs(`#pp-${location}-customer-checkout`)?.classList.add('pp-dark-blur');\n\t\t\t$qs('.pp-close')?.classList.add('pp-dark-blur');\n\t\t\tppModalContent.style.height = '100vh';\n\t\t\tppModalContent.style.overflow = 'hidden';\n\t\t} else {\n\t\t\t$qs(`#pp-${location}-customer-checkout`)?.classList.remove('pp-dark-blur');\n\t\t\t$qs('.pp-close')?.classList.remove('pp-dark-blur');\n\t\t\tppModalContent?.style.removeProperty('height');\n\t\t\tppModalContent?.style.removeProperty('overflow');\n\t\t}\n\t}\n}\n\n/* Opens the slide-up view of the id #pp-slide-up-<modaName>-mobile. */\nfunction openSlideUpView(modalName: string) {\n\tconst backgroundElement = $qs(`#pp-slide-up-${modalName}-mobile .pp-slide-up-view-bg`);\n\tconst backarrow = $qs(`#pp-slide-up-${modalName}-mobile .pp-slide-up-header`);\n\n\t$qs(`#pp-slide-up-${modalName}-mobile`)?.classList.add('expanded');\n\t$qs('.pp-close')?.scrollIntoView();\n\twindow.addEventListener('resize', handleResponsiveness);\n\tsetTimeout(() => {\n\t\thandleResponsiveness();\n\t}, 100);\n\tif (modalName === 'cart') {\n\t\t$qs('#pp-dropdown-new')?.setAttribute('aria-expanded', 'true');\n\t}\n\n\t/* Closes the slide-up view. */\n\tconst tapToClose = (e: Event) => {\n\t\te.stopImmediatePropagation();\n\t\tcloseSlideUpView(modalName);\n\t\tbackgroundElement?.removeEventListener('click', tapToClose);\n\t\tbackarrow?.removeEventListener('click', tapToClose);\n\t\twindow.removeEventListener('resize', handleResponsiveness);\n\t\tif (modalName === 'cart') {\n\t\t\tconst dropDown = $qs('#pp-dropdown-new');\n\t\t\tdropDown?.removeEventListener('click', tapToClose);\n\t\t\tdropDown?.removeEventListener('keypress', closeCartWithKeyPress);\n\t\t\tdropDown?.addEventListener('keypress', openCartWithKeyPress);\n\t\t\tdropDown?.addEventListener('click', openCart);\n\t\t} else {\n\t\t\t$qs(`#pp-${modalName}-cancel`)?.removeEventListener('click', tapToClose);\n\t\t}\n\t};\n\n\t/* Closes the slide-up view only after asking whether the unsaved changes don't need to be saved\n\tand the customer confirms. */\n\tconst cancelAndClose = (e: Event) => {\n\t\te.stopImmediatePropagation();\n\t\tconst modalPage = Environment.modalUI.page();\n\t\tconst formID = modalPage === 'billing' ? '#pp-billing-form' : '#pp-shipping-form';\n\t\tconst infoFormValidity = $qs<HTMLFormElement>(`${formID}`)?.checkValidity() ?? false;\n\t\tif ($qs(`#pp-${modalName}-mobile-save`)?.hasAttribute('disabled')) {\n\t\t\tif (!infoFormValidity) {\n\t\t\t\topenSlideUpView('ship-to');\n\t\t\t\t$qs<HTMLFormElement>(`${formID}`)?.reportValidity();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcloseSlideUpView(modalName);\n\t\t\tbackgroundElement?.removeEventListener('click', cancelAndClose);\n\t\t\tbackarrow?.removeEventListener('click', cancelAndClose);\n\t\t\twindow.removeEventListener('resize', handleResponsiveness);\n\t\t\t$qs(`#pp-${modalName}-cancel .exit-back-btn`)?.removeEventListener('click', cancelAndClose);\n\t\t} else {\n\t\t\tif (!infoFormValidity) {\n\t\t\t\topenSlideUpView('ship-to');\n\t\t\t\t$qs<HTMLFormElement>(`${formID}`)?.reportValidity();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// eslint-disable-next-line no-alert\n\t\t\tif (confirm('Close without saving changes?')) {\n\t\t\t\tstore.dispatch(startModalLoading());\n\t\t\t\tcloseSlideUpView(modalName);\n\t\t\t\tbackgroundElement?.removeEventListener('click', cancelAndClose);\n\t\t\t\tbackarrow?.removeEventListener('click', cancelAndClose);\n\t\t\t\twindow.removeEventListener('resize', handleResponsiveness);\n\t\t\t\t$qs(`#pp-${modalName}-cancel .exit-back-btn`)?.removeEventListener('click', cancelAndClose);\n\t\t\t\t$qs(`#pp-${modalName}-mobile-save`)?.setAttribute('disabled', '');\n\t\t\t\tstore.dispatch(stopModalLoading());\n\t\t\t}\n\t\t}\n\t};\n\n\t/* Wraps around the tapToClose function to check the key. */\n\tconst closeCartWithKeyPress = (event: KeyboardEvent) => {\n\t\tevent.preventDefault();\n\t\tevent.stopImmediatePropagation();\n\t\tif (event.key === 'Enter' || event.key === ' ') {\n\t\t\ttapToClose(event);\n\t\t}\n\t};\n\n\t/* Adding more event-listeners */\n\tif (modalName === 'ship-to') {\n\t\tbackgroundElement?.addEventListener('click', cancelAndClose);\n\t\tbackarrow?.addEventListener('click', cancelAndClose);\n\t\t$qs(`#pp-${modalName}-cancel .exit-back-btn`)?.addEventListener('click', cancelAndClose);\n\t} else {\n\t\tbackgroundElement?.addEventListener('click', tapToClose);\n\t\tbackarrow?.addEventListener('click', tapToClose);\n\t\tif (modalName !== 'cart') {\n\t\t\t$qs(`#pp-${modalName}-cancel`)?.addEventListener('click', tapToClose);\n\t\t}\n\t}\n\n\tif (modalName === 'cart') {\n\t\tconst dropDown = $qs('#pp-dropdown-new');\n\t\tdropDown?.addEventListener('click', tapToClose);\n\t\tdropDown?.addEventListener('keypress', closeCartWithKeyPress);\n\t\tdropDown?.removeEventListener('click', openCart);\n\t\tdropDown?.removeEventListener('keypress', openCartWithKeyPress);\n\t}\n}\n\n/* Closes the slide-up view and cleans up the modal UI. */\nfunction closeSlideUpView(modalName: string) {\n\tconst ppModalContent = $qs('#pp-modal-content');\n\tif (ppModalContent) {\n\t\tppModalContent.style.removeProperty('height');\n\t\tppModalContent.style.removeProperty('overflow');\n\t}\n\n\tconst location = ppModalContent?.classList.contains('pp-content-mobile') ? 'mobile' : 'new';\n\t$qs(`#pp-slide-up-${modalName}-mobile`)?.classList.remove('expanded');\n\t$qs(`#pp-${location}-customer-checkout`)?.classList.remove('pp-dark-blur');\n\t$qs('.pp-close')?.classList.remove('pp-dark-blur');\n\tif (modalName === 'cart') {\n\t\t$qs('#pp-dropdown-new')?.setAttribute('aria-expanded', 'false');\n\t}\n}\n\nfunction openCart() {\n\topenSlideUpView('cart');\n}\n\n/* Checks the key value before opening the cart. */\nfunction openCartWithKeyPress(event: KeyboardEvent) {\n\tevent.preventDefault();\n\tevent.stopImmediatePropagation();\n\tif (event.key === 'Enter' || event.key === ' ') {\n\t\topenSlideUpView('cart');\n\t}\n}\n\nexport {\n\topenCart,\n\topenCartWithKeyPress,\n};\n","import {type ModalPage} from '../models/IEnvironment';\nimport {Feature} from '../reducers/environmentReducer';\nimport {$qs, $qsAll} from '../../../@shared/ts/dom';\nimport {FeatureFlag} from '../../../@type/features';\nimport {openCart, openCartWithKeyPress} from './slideUpView';\n\nexport function renderModalPage(modalPage: ModalPage) {\n\trenderInfoPageDisplay(modalPage);\n\trenderShippingPageDisplay(modalPage);\n\trenderPaymentPageDisplay(modalPage);\n\trenderModalButtonShadow();\n\n\t$qs('#pp-dropdown-new')?.addEventListener('click', openCart);\n\t$qs('#pp-dropdown-new')?.addEventListener('keypress', openCartWithKeyPress);\n}\n\n/**\n * Renders or shows the info page elements\n */\nfunction renderInfoPageDisplay(modalPage: ModalPage): void {\n\tif (modalPage === 'billing') {\n\t\t$qs('#pp-billing-page')?.classList.remove('hide');\n\t} else {\n\t\t// Hide info page\n\t\t$qs('#pp-billing-page')?.classList.add('hide');\n\t}\n}\n\n/* Updates the UI for the case: modalUI === 'shipping'  */\nfunction renderShippingPageDisplay(\n\tmodalPage: ModalPage,\n): void {\n\tif (modalPage === 'shipping') {\n\t\t$qs('#pp-shipping-page')?.classList.remove('hide');\n\t} else {\n\t\t// Hide shipping page\n\t\t$qs('#pp-shipping-page')?.classList.add('hide');\n\t}\n}\n\n/**\n * Handles changing the modal to the payment page\n */\nfunction renderPaymentPageDisplay(\n\tmodalPage: ModalPage,\n): void {\n\tif (modalPage === 'payment') {\n\t\t// Show payment page\n\t\t$qs('#pp-payment-page')?.classList.remove('hide');\n\t\t$qs('#extra-fields-section')?.classList.remove('hide');\n\t} else {\n\t\t// Hide payment page\n\t\t$qs('#pp-payment-page')?.classList.add('hide');\n\t}\n}\n\n/**\n * Updates the modals colors to match the merchants button color.\n */\nfunction renderModalButtonShadow(): void {\n\tconst buttonShadowClass = 'btn-shadow';\n\n\tif (Feature.enabled(FeatureFlag.BUTTON_SHADOW)) {\n\t\t$qsAll('.btn', $element => {\n\t\t\t$element.classList.add(buttonShadowClass);\n\t\t});\n\t} else {\n\t\t$qsAll('.btn', $element => {\n\t\t\t$element.classList.remove(buttonShadowClass);\n\t\t});\n\t}\n}\n","import {maybeFetchWP} from '../../../../@shared/ts/maybe';\nimport {captureSentryException} from '../../../../@shared/ts/sentry';\nimport {FeatureFlag} from '../../../../@type/features';\nimport {Feature} from '../../reducers/environmentReducer';\nimport {getLocaleText} from '../../util/translation';\nimport {PeachPayOrder} from '../../reducers/peachPayOrderReducer';\n\n/**\n * Validate the form data for the PeachPay checkout.\n */\nasync function validateCheckout(mode: 'billing' | 'billing_shipping'): Promise<boolean> {\n\tconst validateURL = Feature.metadata<string>(FeatureFlag.EXPRESS_CHECKOUT, 'validate_url');\n\tif (!validateURL) {\n\t\tthrow new Error('Validate URL is not set');\n\t}\n\n\tconst formData = PeachPayOrder.billing.formData();\n\n\tif (mode === 'billing_shipping') {\n\t\tconst shippingFormData = PeachPayOrder.shipping.formData();\n\t\tfor (const [key, value] of shippingFormData.entries()) {\n\t\t\tformData.append(key, value);\n\t\t}\n\n\t\t// This might be empty if no additional fields are present but that is ok!\n\t\tconst additionalFormData = PeachPayOrder.additional.formData();\n\t\tfor (const [key, value] of additionalFormData.entries()) {\n\t\t\tformData.append(key, value);\n\t\t}\n\t}\n\n\tconst {error, result} = await maybeFetchWP<{success: boolean; error_messages: string[]}>(validateURL, {\n\t\tmethod: 'POST',\n\t\tbody: formData,\n\t});\n\n\tif (error || !result) {\n\t\tcaptureSentryException(error instanceof Error ? error : new Error('Unknown error while validating billing address'));\n\t\treturn false;\n\t}\n\n\tif (!result.success) {\n\t\tif (result.error_messages) {\n\t\t\t// eslint-disable-next-line no-alert\n\t\t\talert(result.error_messages.join('\\n').replace(/(<([^>]+)>)/gi, ''));\n\t\t} else {\n\t\t\t// eslint-disable-next-line no-alert\n\t\t\talert(getLocaleText('Something went wrong. Please try again.'));\n\t\t}\n\n\t\treturn false;\n\t}\n\n\treturn true;\n}\n\nexport {\n\tvalidateCheckout,\n};\n","import {store} from '../store';\nimport {Environment, startModalLoading, stopModalLoading, updateEnvironment} from '../reducers/environmentReducer';\nimport {PeachPayOrder} from '../reducers/peachPayOrderReducer';\nimport {type LoadingMode, type ModalPage} from '../models/IEnvironment';\nimport {MerchantConfiguration} from '../reducers/merchantConfigurationReducer';\nimport {Carts, DefaultCart} from '../reducers/cartReducer';\nimport {getLocaleText} from '../util/translation';\nimport {renderModalPage} from './modalPage';\nimport {$qs, $qsAll, isMobile} from '../../../@shared/ts/dom';\nimport {closeCheckout} from '../sdk';\nimport {type CheckoutData} from '../models/CheckoutData';\nimport {validateCheckout} from './fields/validation';\nimport {doAction} from '../../../@shared/ts/hooks';\n\nexport function initModal(checkoutData: CheckoutData) {\n\t// Keep modal state rendering up to date\n\tlet prevCurrencyCode = '';\n\tstore.subscribe(() => {\n\t\trenderModalPageIndicator(Environment.modalUI.page());\n\t\trenderModalNavigation(Environment.modalUI.page());\n\t\trenderContinueButtonDisplay(Environment.modalUI.page());\n\t\trenderContinueButtonLoading(Environment.modalUI.loadingMode());\n\t\tppDisableLoadingMode(Environment.modalUI.loadingMode());\n\t\tppBlurOnRecalculate(\n\t\t\tEnvironment.modalUI.loadingMode(),\n\t\t\tprevCurrencyCode !== MerchantConfiguration.currency.code(),\n\t\t);\n\t\tprevCurrencyCode = MerchantConfiguration.currency.code();\n\n\t\trenderModalPage(Environment.modalUI.page());\n\t\trenderTermsAndCondition(\n\t\t\tEnvironment.modalUI.page(),\n\t\t\tcheckoutData?.wc_terms_conditions ?? '',\n\t\t);\n\t\trenderHideOnMobile(isMobile());\n\n\t\trenderFreeOrderDisplay(DefaultCart.contents().length, Carts.total());\n\t\trenderSummaryBorder();\n\t});\n\n\tdocument.addEventListener('click', async e => {\n\t\tconst $target = (e.target as HTMLElement)?.closest<HTMLElement>('[data-goto-page]');\n\t\tif (!$target) {\n\t\t\treturn;\n\t\t}\n\n\t\te.preventDefault();\n\n\t\tconst page = $target.dataset['gotoPage'] as ModalPage;\n\n\t\tstore.dispatch(startModalLoading());\n\t\tawait gotoPage(page);\n\t\tstore.dispatch(stopModalLoading());\n\t});\n\n\t$qsAll('.pp-close', $el => {\n\t\t$el.addEventListener('click', e => {\n\t\t\te.preventDefault();\n\t\t\tcloseCheckout();\n\t\t});\n\t});\n}\n\n/**\n * Hides the prices by bluring them until we can show the real amount they will be\n *\n * @param loadingMode The current loading state of the modal\n */\nfunction ppBlurOnRecalculate(\n\tloadingMode: LoadingMode,\n\tcurrencyChanged: boolean,\n) {\n\tif (loadingMode === 'loading') {\n\t\t$qsAll('.pp-recalculate-blur', element => {\n\t\t\telement.classList.add('pp-blur');\n\t\t});\n\t\t// Currently this does not visibily work but requires shipping.ts refactor\n\t\tif (currencyChanged) {\n\t\t\t$qsAll('.pp-currency-blur', element => {\n\t\t\t\telement.classList.add('pp-blur');\n\t\t\t});\n\t\t}\n\t} else {\n\t\t$qsAll('.pp-recalculate-blur', element => {\n\t\t\telement.classList.remove('pp-blur');\n\t\t});\n\t\t$qsAll('.pp-currency-blur', element => {\n\t\t\telement.classList.remove('pp-blur');\n\t\t});\n\t}\n}\n\nfunction renderFreeOrderDisplay(cartCount: number, allCartsTotal: number) {\n\tif (cartCount > 0 && allCartsTotal === 0) {\n\t\t$qsAll('.pp-hide-on-free-order', $el => {\n\t\t\t$el.classList.add('hide');\n\t\t});\n\t} else {\n\t\t$qsAll('.pp-hide-on-free-order', $el => {\n\t\t\t$el.classList.remove('hide');\n\t\t});\n\t}\n}\n\nfunction renderContinueButtonDisplay(modalPage: ModalPage) {\n\tif (modalPage === 'billing') {\n\t\t$qs('#pp-continue-to-shipping-mobile')?.classList.remove('hide');\n\t\t$qs('#pp-continue-to-payment-mobile')?.classList.add('hide');\n\t\t$qs('.pay-button-container-mobile')?.classList.add('hide');\n\t} else if (modalPage === 'shipping') {\n\t\t$qs('#pp-continue-to-shipping-mobile')?.classList.add('hide');\n\t\t$qs('#pp-continue-to-payment-mobile')?.classList.remove('hide');\n\t\t$qs('.pay-button-container-mobile')?.classList.add('hide');\n\t} else if (modalPage === 'payment') {\n\t\t$qs('#pp-continue-to-shipping-mobile')?.classList.add('hide');\n\t\t$qs('#pp-continue-to-payment-mobile')?.classList.add('hide');\n\t\t$qs('.pay-button-container-mobile')?.classList.remove('hide');\n\t}\n}\n\nfunction renderContinueButtonLoading(loadingMode: LoadingMode) {\n\tif (loadingMode === 'loading') {\n\t\t$qs('#continue-spinner-shipping')?.classList.remove('hide');\n\t\t$qs('#continue-spinner-payment')?.classList.remove('hide');\n\t\t$qs('#continue-spinner-shipping-mobile')?.classList.remove('hide');\n\t\t$qs('#continue-spinner-payment-mobile')?.classList.remove('hide');\n\n\t\t$qsAll('i.pp-icon-lock', $element => {\n\t\t\t$element.classList.add('hide');\n\t\t});\n\t} else {\n\t\t$qs('#continue-spinner-shipping')?.classList.add('hide');\n\t\t$qs('#continue-spinner-payment')?.classList.add('hide');\n\t\t$qs('#continue-spinner-shipping-mobile')?.classList.add('hide');\n\t\t$qs('#continue-spinner-payment-mobile')?.classList.add('hide');\n\n\t\t$qsAll('i.pp-icon-lock', $element => {\n\t\t\t$element.classList.remove('hide');\n\t\t});\n\t}\n}\n\nfunction ppDisableLoadingMode(loadingMode: LoadingMode) {\n\tif (loadingMode === 'loading') {\n\t\t$qsAll<HTMLInputElement>('.pp-disabled-loading', $element => {\n\t\t\t$element.classList.add('pp-disabled');\n\t\t\t$element.classList.add('pp-mode-loading');\n\t\t});\n\t} else if (loadingMode === 'processing') {\n\t\t$qsAll<HTMLInputElement>('.pp-disabled-processing', $element => {\n\t\t\t$element.classList.add('pp-disabled');\n\t\t});\n\t} else {\n\t\t$qsAll<HTMLInputElement>('.pp-disabled-processing,.pp-disabled-loading', $element => {\n\t\t\t$element.classList.remove('pp-disabled');\n\t\t\t$element.classList.remove('pp-mode-loading');\n\t\t});\n\t}\n}\n\nfunction renderHideOnMobile(isMobile: boolean) {\n\tif (isMobile) {\n\t\t$qsAll('.pp-hide-on-mobile', $el => {\n\t\t\t$el.classList.add('hide');\n\t\t});\n\t} else {\n\t\t$qsAll('.pp-hide-on-mobile', $el => {\n\t\t\t$el.classList.remove('hide');\n\t\t});\n\t}\n}\n\n/**\n * Renders the Terms and Conditions section above the pay button.\n */\nfunction renderTermsAndCondition(page: ModalPage, terms?: string) {\n\tconst merchantTermsConditions = terms ? `${getLocaleText('By completing the checkout, you agree to our')} <a href='${terms}' target='_blank'>${getLocaleText('terms and conditions')}</a>.` : '';\n\tif (page === 'payment' && merchantTermsConditions) {\n\t\t$qsAll('.pp-tc-section', $el => {\n\t\t\t$el.innerHTML = `<label class='pp-tc-contents'>${merchantTermsConditions}</label>`;\n\t\t\t$el.classList.remove('hide');\n\t\t});\n\t} else {\n\t\t$qsAll('.pp-tc-section', $el => {\n\t\t\t$el.classList.add('hide');\n\t\t});\n\t}\n}\n\nfunction renderSummaryBorder() {\n\tlet itemsHeight = 0;\n\t$qs('#pp-summary-body', $parent => {\n\t\tconst $children = $parent?.querySelectorAll('.pp-order-summary-item');\n\t\tif (!$children) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const $child of Array.from($children)) {\n\t\t\titemsHeight += $child?.clientHeight ?? 0;\n\t\t}\n\n\t\tif ($parent?.clientHeight < itemsHeight) {\n\t\t\t$parent.classList.add('pp-review-border');\n\t\t} else {\n\t\t\t$parent.classList.remove('pp-review-border');\n\t\t}\n\t});\n}\n\ntype ChangePageArguments = [fromPage: ModalPage, toPage: ModalPage];\n// eslint-disable-next-line complexity\nasync function gotoPage(toPage: ModalPage): Promise<boolean> {\n\tconst changePage = async (currentPage: ModalPage, targetPage: ModalPage) => {\n\t\t$qs('.pp-close')?.scrollIntoView();\n\n\t\tawait doAction(`before_${targetPage}_page`, currentPage, targetPage);\n\n\t\tstore.dispatch(updateEnvironment({modalPageType: targetPage}));\n\n\t\tawait doAction(`after_${targetPage}_page`, currentPage, targetPage);\n\n\t\treturn true;\n\t};\n\n\tconst fromPage = Environment.modalUI.page();\n\tswitch (fromPage) {\n\t\tcase 'billing': {\n\t\t\tif (!await PeachPayOrder.billing.reportValidity()) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (toPage === 'shipping') {// Info -> Shipping\n\t\t\t\tif (await validateCheckout('billing')) {\n\t\t\t\t\tif (shouldSkipShippingPage()) {\n\t\t\t\t\t\treturn changePage(fromPage, 'payment');\n\t\t\t\t\t}\n\n\t\t\t\t\treturn changePage(fromPage, toPage);\n\t\t\t\t}\n\t\t\t} else if (toPage === 'payment') {// Info -> Payment\n\t\t\t\tif (!PeachPayOrder.shipping.checkValidity()) {\n\t\t\t\t\tawait PeachPayOrder.shipping.reportValidity();\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (!PeachPayOrder.shippingOptions.checkValidity()) {\n\t\t\t\t\tawait PeachPayOrder.shippingOptions.reportValidity();\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (!PeachPayOrder.additional.checkValidity()) {\n\t\t\t\t\tawait PeachPayOrder.additional.reportValidity();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (await validateCheckout('billing_shipping')) {\n\t\t\t\t\treturn changePage(fromPage, toPage);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tbreak;\n\t\t}\n\n\t\tcase 'shipping': {\n\t\t\tif (toPage === 'billing') {// Shipping -> Info\n\t\t\t\treturn changePage(fromPage, toPage);\n\t\t\t}\n\n\t\t\tif (toPage === 'payment') {// Shipping -> Payment\n\t\t\t\tif (!PeachPayOrder.shipping.checkValidity()) {\n\t\t\t\t\tawait PeachPayOrder.shipping.reportValidity();\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (!PeachPayOrder.shippingOptions.checkValidity()) {\n\t\t\t\t\tawait PeachPayOrder.shippingOptions.reportValidity();\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (!PeachPayOrder.additional.checkValidity()) {\n\t\t\t\t\tawait PeachPayOrder.additional.reportValidity();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (await validateCheckout('billing_shipping')) {\n\t\t\t\t\treturn changePage(fromPage, toPage);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tbreak;\n\t\t}\n\n\t\tcase 'payment': {\n\t\t\tif (toPage === 'billing') {// Payment -> Info\n\t\t\t\treturn changePage(fromPage, toPage);\n\t\t\t}\n\n\t\t\tif (toPage === 'shipping') {// Payment -> Shipping\n\t\t\t\tif (shouldSkipShippingPage()) {\n\t\t\t\t\treturn changePage(fromPage, 'billing');\n\t\t\t\t}\n\n\t\t\t\treturn changePage(fromPage, toPage);\n\t\t\t}\n\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn false;\n}\n\nasync function maybeGotoPage(desiredPage: ModalPage): Promise<boolean> {\n\tconst currentPage = Environment.modalUI.page();\n\tif (currentPage !== desiredPage) {\n\t\tawait gotoPage(desiredPage);\n\t}\n\n\treturn true;\n}\n\nfunction renderModalPageIndicator(modalPage: ModalPage): void {\n\t// Show/hide info page indicator\n\tif (modalPage === 'billing') {\n\t\t// Info tab\n\t\t$qs('#pp-billing-tab')?.classList.add('current');\n\t\t$qs('#pp-billing-tab-text')?.classList.add('hide');\n\n\t\t// Shipping/additional tab\n\t\t$qs('#pp-shipping-tab')?.classList.remove('current');\n\t\t$qs('#pp-shipping-tab')?.classList.add('no-fill');\n\t\t$qs('#pp-shipping-tab-text')?.classList.add('hide');\n\n\t\t// Payment tab\n\t\t$qs('#pp-payment-tab')?.classList.remove('current');\n\t\t$qs('#pp-payment-tab')?.classList.add('no-fill');\n\t} else if (modalPage === 'shipping') {\n\t\t// Info tab\n\t\t$qs('#pp-billing-tab')?.classList.remove('current');\n\t\t$qs('#pp-billing-tab-text')?.classList.remove('hide');\n\n\t\t// Shipping/additional tab\n\t\t$qs('#pp-shipping-tab')?.classList.remove('no-fill');\n\t\t$qs('#pp-shipping-tab')?.classList.add('current');\n\t\t$qs('#pp-shipping-tab-text')?.classList.add('hide');\n\n\t\t// Payment tab\n\t\t$qs('#pp-payment-tab')?.classList.remove('current');\n\t\t$qs('#pp-payment-tab')?.classList.add('no-fill');\n\t} else if (modalPage === 'payment') {\n\t\t// Info tab\n\t\t$qs('#pp-billing-tab')?.classList.remove('current');\n\t\t$qs('#pp-billing-tab-text')?.classList.remove('hide');\n\n\t\t// Shipping/additional tab\n\t\t$qs('#pp-shipping-tab')?.classList.remove('current');\n\t\t$qs('#pp-shipping-tab')?.classList.remove('no-fill');\n\t\t$qs('#pp-shipping-tab-text')?.classList.remove('hide');\n\n\t\t// Payment tab\n\t\t$qs('#pp-payment-tab')?.classList.add('current');\n\t\t$qs('#pp-payment-tab')?.classList.remove('no-fill');\n\t}\n\n\tif (shouldSkipShippingPage()) {\n\t\t$qs('#pp-shipping-tab')?.classList.add('hide');\n\t\t$qs('#pp-shipping-page-message')?.classList.remove('hide');\n\t} else {\n\t\t$qs('#pp-shipping-tab')?.classList.remove('hide');\n\t\t$qs('#pp-shipping-page-message')?.classList.add('hide');\n\t}\n}\n\nfunction renderModalNavigation(modalPage: ModalPage) {\n\tif (modalPage === 'billing') {\n\t\t$qs('#pp-exit-mobile')?.classList.remove('hide');\n\t\t$qs('#pp-back-to-info-mobile')?.classList.add('hide');\n\t\t$qs('#pp-back-to-shipping-mobile')?.classList.add('hide');\n\t} else if (modalPage === 'shipping') {\n\t\t$qs('#pp-exit-mobile')?.classList.add('hide');\n\t\t$qs('#pp-back-to-info-mobile')?.classList.remove('hide');\n\t\t$qs('#pp-back-to-shipping-mobile')?.classList.add('hide');\n\t} else if (modalPage === 'payment') {\n\t\t$qs('#pp-exit-mobile')?.classList.add('hide');\n\t\t$qs('#pp-back-to-info-mobile')?.classList.add('hide');\n\t\t$qs('#pp-back-to-shipping-mobile')?.classList.remove('hide');\n\t}\n}\n\nfunction shouldSkipShippingPage() {\n\treturn !Carts.needsShipping() && !$qs('pp-additional-form');\n}\n\nexport {\n\ttype ChangePageArguments,\n\n\tgotoPage,\n\tmaybeGotoPage,\n};\n","// Simple enum that determines the sorting method for payment methods in Express checkout.\n// The higher the number (or eligibility), the further towards the beginning of the method display\n//  that method will be shown. Currently this is only used based on eligibility (as per the naming).\nenum GatewayEligibility {\n\tNotEligible = 0,\n\tEligible = 1,\n\tEligibleWithChange = 2,\n\tEligibleButErrored = 3,\n}\n\ninterface IPaymentConfiguration {\n\tselectedGateway: string;\n\tavailableGateways: string[];\n\tgatewayAvailabilityDetails: Record<string, GatewayEligibilityDetails>;\n\n\tgatewayConfigurations: Record<string, GatewayConfiguration>;\n}\n\ninterface GatewayConfiguration {\n\t/**\n\t * Name to display for Payment Method\n\t * @example \"Klarna\"\n\t */\n\tname: string;\n\t/**\n\t * Optional short description on how the payment method works.\n\t * @example \"After selecting pay you will be redirected to complete your payment.\"\n\t */\n\tdescription: string;\n\n\t/**\n\t * The WC gateway to use. All peachpay custom gateways are prefixed with 'peachpay_'.\n\t */\n\tgatewayId: string;\n\t/**\n\t * Branding assets to display with the option.\n\t */\n\tassets: {\n\t\ttitle?: ImageOptions;\n\t\tbadge: ImageOptions;\n\t};\n\n\t/**\n     * A boolean to dynamically indicate if they payment method is supported by the browser. If undefined the method is considered supported by default.\n     */\n\tbrowser?: boolean;\n\n\t/**\n\t * A boolean to dynamically indicate if the payment method successfully initialized.\n     *\n     * If `undefined`(default) or `true` the method is considered initialized.\n     * If `false` then the payment method is considered errored.\n\t */\n\tinitialized?: boolean;\n\n\t/**\n\t * Does this gateway use a custom place order button?\n\t */\n\thasCustomButton?: boolean;\n}\n\ntype ImageOptions = {\n\tsrc: string;\n\tscale?: number;\n\ttranslateX?: number;\n};\n\ntype EligibilityDetail = {\n\texplanation: string;\n};\n\n/**\n * Details why a gateway is not eligible. Properties are only defined if something is wrong.\n */\ntype GatewayEligibilityDetails = {\n\t/**\n     * Defined by the backend.\n     */\n\n\tenabled?: EligibilityDetail;\n\tsetup?: EligibilityDetail;\n\tuser?: EligibilityDetail;\n\tlocation?: EligibilityDetail;\n\tminimum?: EligibilityDetail & {minimum: number};\n\tmaximum?: EligibilityDetail & {maximum: number};\n\tcountry?: EligibilityDetail & {available_options?: string[]};\n\tcurrency?: EligibilityDetail & {available_options?: string[]; fallback_option?: string};\n\n\t/**\n     * Defined by the frontend.\n     */\n\n\tbrowser?: EligibilityDetail;\n\tinitialized?: EligibilityDetail;\n};\n\nexport {\n\ttype IPaymentConfiguration,\n\ttype GatewayEligibilityDetails,\n\ttype GatewayConfiguration,\n\n\tGatewayEligibility,\n};\n","\nimport {Feature, stopModalLoading} from '../reducers/environmentReducer';\nimport {Carts, DefaultCart, updateCartCalculation} from '../reducers/cartReducer';\nimport {PeachPayCustomer} from '../reducers/peachPayCustomerReducer';\nimport {PeachPayOrder} from '../reducers/peachPayOrderReducer';\nimport {store} from '../store';\nimport {type ICartCalculationResponse} from '../../../@type/woocommerce/cart-calculation';\nimport {getLocaleText} from '../util/translation';\nimport {PaymentConfiguration, setSelectedPaymentGateway, updateAvailableGateways, updateGatewayDetails} from '../reducers/paymentConfigurationReducer';\nimport {type IResponse} from '../../../@type/response';\nimport {stripHtml, $qsAll, $qs, isMobile} from '../../../@shared/ts/dom';\nimport {type WCOrder} from '../../../@type/woocommerce/order';\nimport {captureSentryException} from '../../../@shared/ts/sentry';\nimport {getCaptchaToken} from '../features/botProtection';\nimport {type Maybe, maybeFetchWP} from '../../../@shared/ts/maybe';\nimport {getErrorString} from '../../../@shared/ts/error';\nimport {FeatureFlag} from '../../../@type/features';\nimport {type PaymentData, type PaymentAttempt} from '../../../@shared/ts/paymentAttempt';\nimport {type TransactionUpdate} from '../../../@shared/ts/transaction';\nimport {DebounceAbortController} from '../util/debounce';\n\nexport interface OrderService {\n\tplaceOrder: (transaction: Transaction, extraFormData?: Record<string, string>) => Promise<Maybe<WCOrder>>;\n\tstartTransaction: (paymentGateway: string) => Promise<Maybe<Transaction>>;\n}\n\nexport interface Transaction {\n\tgetId: () => string;\n\tupdate: (options: TransactionUpdate) => void;\n\tcomplete: (options?: TransactionUpdate) => Promise<boolean>;\n}\n\nexport function getOrderService(): OrderService {\n\treturn {\n\t\tplaceOrder,\n\t\tasync startTransaction(gatewayId: string): Promise<Maybe<Transaction>> {\n\t\t\tconst transactionId = await createPaymentTransaction(gatewayId);\n\t\t\tlet complete = false;\n\t\t\tif (!transactionId) {\n\t\t\t\treturn {error: new Error('Failed to create a transaction. Please refresh the page and try again.')};\n\t\t\t}\n\n\t\t\tconst transactionUpdates: TransactionUpdate[] = [];\n\n\t\t\treturn {\n\t\t\t\tresult: {\n\t\t\t\t\tgetId() {\n\t\t\t\t\t\treturn transactionId;\n\t\t\t\t\t},\n\t\t\t\t\tupdate(options: TransactionUpdate) {\n\t\t\t\t\t\ttransactionUpdates.push(options);\n\t\t\t\t\t},\n\t\t\t\t\tasync complete(options?: TransactionUpdate) {\n\t\t\t\t\t\tif (complete) {\n\t\t\t\t\t\t\tconsole.error('Developer error: Transaction already completed.');\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcomplete = true;\n\n\t\t\t\t\t\tif (options) {\n\t\t\t\t\t\t\ttransactionUpdates.push(options);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (transactionUpdates.length === 0) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst update = transactionUpdates.reduce((pt, ct) => ({...pt, ...ct}), {});\n\t\t\t\t\t\treturn updatePaymentTransaction(transactionId, update);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t};\n}\n\nasync function placeOrder(transaction: Transaction, extraFormData: Record<string, string> = {}): Promise<Maybe<WCOrder>> {\n\tconst checkoutURL = Feature.metadata<string>(FeatureFlag.EXPRESS_CHECKOUT, 'checkout_url');\n\tconst checkoutNonce = Feature.dynamicMetadata<string>(FeatureFlag.EXPRESS_CHECKOUT, 'checkout_nonce');\n\n\tif (!checkoutURL || !checkoutNonce) {\n\t\treturn {error: new Error('Invalid checkout URL or nonce')};\n\t}\n\n\tconst formData = PeachPayOrder.formData();\n\tformData.append('woocommerce-process-checkout-nonce', checkoutNonce);\n\n\tconst gatewayId = PaymentConfiguration.selectedGateway();\n\tif (gatewayId !== 'peachpay_free') {\n\t\tformData.append('payment_method', gatewayId);\n\t}\n\n\tformData.append('peachpay_transaction_id', transaction.getId());\n\tformData.append('peachpay_captcha_token', await getCaptchaToken());\n\n\tformData.append('terms', '1');\n\tformData.append('european_gdpr', '1');\n\n\tformData.append('ct-ultimate-gdpr-consent-field', 'on');\n\tformData.append('ct-ultimate-gdpr-consent-field-additional', '1');\n\tformData.append('ct-ultimate-gdpr-consent-field-additional', '1');\n\tformData.append('ct-ultimate-gdpr-consent-field-label-text', '1');\n\n\tformData.append('wc_order_attribution_source_type', 'typein');\n\tformData.append('wc_order_attribution_utm_source', '(direct)'); // This code sets the orders placed via Express Checkout as Direct (source type) orders.\n\n\tfor (const [key, value] of Object.entries(extraFormData)) {\n\t\tformData.append(key, value);\n\t}\n\n\tconst {error: orderError, result: orderResult} = await maybeFetchWP<WCOrder>(checkoutURL + '&pp-express-checkout', {\n\t\tmethod: 'POST',\n\t\tcredentials: 'same-origin',\n\t\tbody: formData,\n\t});\n\n\tif (orderError || !orderResult || orderResult.result !== 'success') {\n\t\tif (orderError) {\n\t\t\tif (orderError instanceof Error) {\n\t\t\t\tcaptureSentryException(orderError);\n\t\t\t} else {\n\t\t\t\tcaptureSentryException(new Error(getErrorString(orderError)));\n\t\t\t}\n\n\t\t\tconst errorMessage = getErrorString(orderError);\n\t\t\tdisplayPaymentErrorMessage(errorMessage);\n\n\t\t\tawait transaction.complete({\n\t\t\t\tnote: errorMessage,\n\t\t\t});\n\n\t\t\treturn {error: orderError, result: orderResult};\n\t\t}\n\n\t\tif (orderResult?.result === 'failure') {\n\t\t\tconst errorMessage = stripHtml(orderResult.messages, null).trim() || getLocaleText('Unknown error occured while placing order. Please refresh the page and try again.');\n\t\t\tdisplayPaymentErrorMessage(errorMessage);\n\n\t\t\tawait transaction.complete({\n\t\t\t\tnote: errorMessage,\n\t\t\t});\n\n\t\t\t// In the scenario the order fails but a customer was registered all the existing nonces are\n\t\t\t// now invalid. We need to refresh the checkout to get new ones.\n\t\t\tif (orderResult.refresh || orderResult.reload) {\n\t\t\t\tawait requestCartCalculation();\n\t\t\t}\n\n\t\t\treturn {error: orderError, result: orderResult};\n\t\t}\n\n\t\tconst errorMessage = getLocaleText('Unknown error occured while placing order. Please refresh the page and try again.');\n\t\tdisplayPaymentErrorMessage(errorMessage);\n\n\t\tawait transaction.complete({\n\t\t\tnote: errorMessage,\n\t\t});\n\n\t\t// Any failure after an order risks invalid nonces in the case of a user being logged in. To prevent\n\t\t// possible problems we will get a new cart calculation.\n\t\tawait requestCartCalculation();\n\t}\n\n\treturn {error: orderError, result: orderResult};\n}\n\nexport const cartCalculationAbortController = new DebounceAbortController();\n\n/**\n * Calls a endpoint in the PeachPay Plugin to recalculate all the summary cost\n */\nexport async function requestCartCalculation(sync: 'push' | 'pull' = 'push'): Promise<void> {\n\t// We want to ensure any debounced cart calculations are canceled. So we call\n\t// abort here. Any debounced functions which call `requestCartCalculation` should\n\t// pass this same abort controller.\n\tcartCalculationAbortController.abort();\n\n\tconst cartUrl = Feature.metadata<string>(FeatureFlag.EXPRESS_CHECKOUT, 'calculation_url');\n\tif (!cartUrl) {\n\t\tthrow new Error('Invalid cart calculation URL');\n\t}\n\n\tconst formData = new FormData();\n\tif (sync === 'push') {\n\t\tformData.append('billing_email', PeachPayCustomer.billing.email());\n\t\tformData.append('billing_first_name', PeachPayCustomer.billing.firstName());\n\t\tformData.append('billing_last_name', PeachPayCustomer.billing.lastName());\n\t\tformData.append('billing_phone', PeachPayCustomer.billing.phone());\n\t\tformData.append('billing_company', PeachPayCustomer.billing.company());\n\t\tformData.append('billing_address_1', PeachPayCustomer.billing.address1());\n\t\tformData.append('billing_address_2', PeachPayCustomer.billing.address2());\n\t\tformData.append('billing_city', PeachPayCustomer.billing.city());\n\t\tformData.append('billing_state', PeachPayCustomer.billing.state());\n\t\tformData.append('billing_country', PeachPayCustomer.billing.country());\n\t\tformData.append('billing_postcode', PeachPayCustomer.billing.postal());\n\n\t\tif (PeachPayCustomer.shipToDifferentAddress()) {\n\t\t\tformData.append('ship_to_different_address', '1');\n\t\t\tformData.append('shipping_first_name', PeachPayCustomer.shipping.firstName());\n\t\t\tformData.append('shipping_last_name', PeachPayCustomer.shipping.lastName());\n\t\t\tformData.append('shipping_phone', PeachPayCustomer.shipping.phone());\n\t\t\tformData.append('shipping_company', PeachPayCustomer.shipping.company());\n\t\t\tformData.append('shipping_address_1', PeachPayCustomer.shipping.address1());\n\t\t\tformData.append('shipping_address_2', PeachPayCustomer.shipping.address2());\n\t\t\tformData.append('shipping_city', PeachPayCustomer.shipping.city());\n\t\t\tformData.append('shipping_state', PeachPayCustomer.shipping.state());\n\t\t\tformData.append('shipping_country', PeachPayCustomer.shipping.country());\n\t\t\tformData.append('shipping_postcode', PeachPayCustomer.shipping.postal());\n\t\t}\n\n\t\tfor (const [packageKey, methodKey] of Object.entries(PeachPayOrder.collectSelectedShipping())) {\n\t\t\tformData.append(`shipping_method[${packageKey}]`, methodKey);\n\t\t}\n\n\t\tconst gatewayId = PaymentConfiguration.selectedGateway();\n\t\tif (gatewayId !== 'peachpay_free') {\n\t\t\tformData.append('payment_method', gatewayId);\n\t\t}\n\t}\n\n\tconst {error: calculationError, result: calculationResult} = await maybeFetchWP<ICartCalculationResponse>(cartUrl, {\n\t\tmethod: 'POST',\n\t\tcredentials: 'same-origin',\n\t\tbody: formData,\n\t});\n\n\tif (calculationError || !calculationResult || !calculationResult.success) {\n\t\tif (calculationError) {\n\t\t\tif (calculationError instanceof Error) {\n\t\t\t\tcaptureSentryException(calculationError);\n\t\t\t} else {\n\t\t\t\tcaptureSentryException(new Error(getErrorString(calculationError)));\n\t\t\t}\n\t\t} else if (calculationResult && !calculationResult.success && calculationResult.message) {\n\t\t\tcaptureSentryException(new Error(calculationResult.message), {\n\t\t\t\tnotices: calculationResult.notices,\n\t\t\t});\n\t\t} else {\n\t\t\tcaptureSentryException(new Error('Unknown error occured while recalculating cart.'));\n\t\t}\n\n\t\treturn;\n\t}\n\n\tconsumeCartCalculationResponse(calculationResult, sync === 'pull');\n}\n\nexport function consumeCartCalculationResponse(response: ICartCalculationResponse, pull = false) {\n\tif (response.notices) {\n\t\tif (response.notices.error) {\n\t\t\tlet cartErrors = '';\n\t\t\tfor (const errorNotice of response.notices.error) {\n\t\t\t\trenderOrderNotice(errorNotice.notice);\n\t\t\t\tcartErrors += errorNotice.notice;\n\t\t\t}\n\n\t\t\tsetOrderError(cartErrors);\n\t\t}\n\n\t\tif (response.notices.success) {\n\t\t\tfor (const successNotice of response.notices.success) {\n\t\t\t\trenderOrderNotice(successNotice.notice);\n\t\t\t}\n\t\t}\n\n\t\tif (response.notices.notice) {\n\t\t\tfor (const notice of response.notices.notice) {\n\t\t\t\trenderOrderNotice(notice.notice);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (response.data) {\n\t\tsetOrderError('');\n\n\t\tif (pull) {\n\t\t\tPeachPayCustomer.billing.email(response.data.customer['billing_email']);\n\t\t\tPeachPayCustomer.billing.firstName(response.data.customer['billing_first_name']);\n\t\t\tPeachPayCustomer.billing.lastName(response.data.customer['billing_last_name']);\n\t\t\tPeachPayCustomer.billing.phone(response.data.customer['billing_phone']);\n\t\t\tPeachPayCustomer.billing.company(response.data.customer['billing_company']);\n\t\t\tPeachPayCustomer.billing.address1(response.data.customer['billing_address_1']);\n\t\t\tPeachPayCustomer.billing.address2(response.data.customer['billing_address_2']);\n\t\t\tPeachPayCustomer.billing.city(response.data.customer['billing_city']);\n\t\t\tPeachPayCustomer.billing.state(response.data.customer['billing_state']);\n\t\t\tPeachPayCustomer.billing.postal(response.data.customer['billing_postcode']);\n\t\t\tPeachPayCustomer.billing.country(response.data.customer['billing_country']);\n\n\t\t\tPeachPayCustomer.shipping.firstName(response.data.customer['shipping_first_name']);\n\t\t\tPeachPayCustomer.shipping.lastName(response.data.customer['shipping_last_name']);\n\t\t\tPeachPayCustomer.shipping.phone(response.data.customer['shipping_phone']);\n\t\t\tPeachPayCustomer.shipping.company(response.data.customer['shipping_company']);\n\t\t\tPeachPayCustomer.shipping.address1(response.data.customer['shipping_address_1']);\n\t\t\tPeachPayCustomer.shipping.address2(response.data.customer['shipping_address_2']);\n\t\t\tPeachPayCustomer.shipping.city(response.data.customer['shipping_city']);\n\t\t\tPeachPayCustomer.shipping.state(response.data.customer['shipping_state']);\n\t\t\tPeachPayCustomer.shipping.postal(response.data.customer['shipping_postcode']);\n\t\t\tPeachPayCustomer.shipping.country(response.data.customer['shipping_country']);\n\n\t\t\t$qs('#pp-billing-form')?.dispatchEvent(new Event('change'));\n\t\t}\n\n\t\tstore.dispatch(updateCartCalculation(response.data.cart_calculation_record));\n\t\tstore.dispatch(updateGatewayDetails(response.data.gateway_availability_details));\n\n\t\tif (DefaultCart.contents().length >= 1 && Carts.total() === 0) {\n\t\t\tstore.dispatch(updateAvailableGateways(['peachpay_free']));\n\t\t} else {\n\t\t\tstore.dispatch(updateAvailableGateways(response.data.available_gateway_ids));\n\t\t}\n\n\t\tif (DefaultCart.contents().length === 0) {\n\t\t\tsetOrderError(`<span>${getLocaleText('Cart is empty')}</span>`);\n\t\t}\n\n\t\tconst gatewayId = PaymentConfiguration.checkEligibleOrFindAlternate(PaymentConfiguration.selectedGateway());\n\t\tif (gatewayId) {\n\t\t\tstore.dispatch(setSelectedPaymentGateway(gatewayId));\n\t\t} else {\n\t\t\tstore.dispatch(setSelectedPaymentGateway(''));\n\t\t\tsetOrderError(`<span>${getLocaleText('There are no payment methods available')}</span>`);\n\t\t}\n\t}\n}\n\nfunction setOrderError(errorMessage: string) {\n\t$qsAll('.pp-continue-order-error', element => {\n\t\telement.innerHTML = '';\n\t\telement.classList.remove('pp-error');\n\t});\n\n\tif (errorMessage !== '') {\n\t\t$qsAll('.pp-continue-order-error', element => {\n\t\t\telement.innerHTML = errorMessage;\n\t\t\telement.classList.add('pp-error');\n\t\t});\n\t}\n}\n\nexport function renderOrderNotice(data: string) {\n\tconst message = stripHtml(data);\n\n\tconst $noticeElement = document.createElement('div');\n\t$noticeElement.classList.add('pp-notice');\n\t$noticeElement.innerHTML = message;\n\n\tif (isMobile()) {\n\t\t$qs('#pp-notice-container-mobile', $el => {\n\t\t\t$el.classList.remove('hide');\n\t\t\t$el.insertAdjacentElement('afterbegin', $noticeElement);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\t$el.classList.add('hide');\n\t\t\t}, 10050);\n\t\t});\n\t} else {\n\t\t$qs('#pp-notice-container-new', $el => {\n\t\t\t$el.classList.remove('hide');\n\t\t\t$el.insertAdjacentElement('afterbegin', $noticeElement);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\t$el.classList.add('hide');\n\t\t\t}, 10050);\n\t\t});\n\t}\n\n\t// Remove any 'pp-notice' elements currently in DOM after 10 seconds.\n\tsetTimeout(() => {\n\t\t$noticeElement?.remove();\n\t}, 10000);\n}\n\nasync function createPaymentTransaction(paymentGateway: string): Promise<string | null> {\n\tconst createTransactionURL = Feature.metadata<string>(FeatureFlag.EXPRESS_CHECKOUT, 'create_transaction_url');\n\tif (!createTransactionURL) {\n\t\tcaptureSentryException(new Error('Invalid or missing create transaction URL'));\n\t\treturn null;\n\t}\n\n\tconst formData = new FormData();\n\tformData.append('gateway_id', paymentGateway);\n\tformData.append('checkout_location', 'checkout-window');\n\n\ttry {\n\t\tconst response = await fetch(createTransactionURL, {\n\t\t\tmethod: 'POST',\n\t\t\tbody: formData,\n\t\t});\n\n\t\tconst body = await response.json() as IResponse<{transaction_id: string}>;\n\n\t\tif (!response.ok || !body.success) {\n\t\t\tcaptureSentryException(new Error('Failed to create a new payment transaction'));\n\t\t\treturn null;\n\t\t}\n\n\t\treturn body.data.transaction_id;\n\t} catch (error) {\n\t\tif (error instanceof Error) {\n\t\t\tcaptureSentryException(new Error(`Unknown error while attempting to create a new payment transaction :: ${error.toString()}`));\n\t\t}\n\n\t\treturn null;\n\t}\n}\n\nasync function updatePaymentTransaction(transactionId: string, options: TransactionUpdate): Promise<boolean> {\n\tconst updateTransactionURL = Feature.metadata<string>(FeatureFlag.EXPRESS_CHECKOUT, 'update_transaction_url');\n\tif (!updateTransactionURL) {\n\t\tcaptureSentryException(new Error('Invalid or missing update transaction URL'), {\n\t\t\ttransaction_id: transactionId,\n\t\t});\n\n\t\treturn false;\n\t}\n\n\ttry {\n\t\tconst formData = new FormData();\n\t\tformData.append('transaction_id', transactionId);\n\n\t\tif (options.paymentStatus) {\n\t\t\tformData.append('payment_status', options.paymentStatus);\n\t\t}\n\n\t\tif (options.orderStatus) {\n\t\t\tformData.append('order_status', options.orderStatus);\n\t\t}\n\n\t\tif (options.note) {\n\t\t\tformData.append('note', options.note);\n\t\t}\n\n\t\tconst response = await fetch(updateTransactionURL, {\n\t\t\tmethod: 'POST',\n\t\t\tbody: formData,\n\t\t});\n\n\t\tconst responseBody = await response.json() as IResponse<{transaction_id: string}>;\n\n\t\tif (!response.ok || !responseBody.success) {\n\t\t\tcaptureSentryException(new Error('Failed to update an existing payment transaction'), {\n\t\t\t\ttransaction_id: transactionId,\n\t\t\t});\n\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (error) {\n\t\tif (error instanceof Error) {\n\t\t\tcaptureSentryException(new Error(`Unknown error while attempting to update a existing payment transaction :: ${error.toString()}`), {\n\t\t\t\ttransaction_id: transactionId,\n\t\t\t});\n\t\t}\n\n\t\treturn false;\n\t}\n}\n\nexport function displayPaymentErrorMessage(error?: string): void {\n\t$qsAll('.pp-pm-error-text', $el => {\n\t\t$el.remove();\n\t});\n\n\tif (!error) {\n\t\treturn;\n\t}\n\n\tconst gatewayId = PaymentConfiguration.selectedGateway();\n\tconst $container = $qsAll(`div.pp-pm-saved-option[data-gateway=\"${gatewayId}\"]`);\n\n\t$container.forEach($el => {\n\t\t$el.insertAdjacentHTML('beforebegin', /* html */ `<div class=\"pp-pm-error-text\"><span>${error}</span></div>`);\n\t});\n}\n\n/**\n * Creates a payment attempt for the checkout page.\n */\nexport function createExpressCheckoutPaymentAttempt(orderService: OrderService): PaymentAttempt {\n\tlet transaction: Transaction | null = null;\n\tlet paymentResult: PaymentData;\n\n\treturn {\n\t\tgetTransactionId() {\n\t\t\tif (transaction) {\n\t\t\t\treturn transaction.getId();\n\t\t\t}\n\n\t\t\tif (transaction === null) {\n\t\t\t\tthrow new Error('Transaction failed to be created.');\n\t\t\t} else {\n\t\t\t\tthrow new Error('Transaction not created yet.');\n\t\t\t}\n\t\t},\n\t\tgetOrderId() {\n\t\t\tif (paymentResult?.order_id) {\n\t\t\t\treturn paymentResult.order_id;\n\t\t\t}\n\n\t\t\tthrow new Error('Order not created yet.');\n\t\t},\n\t\tstopLoading() {\n\t\t\tstore.dispatch(stopModalLoading());\n\t\t},\n\t\tsetPaymentMessage: displayPaymentErrorMessage,\n\n\t\tasync submitOrder<T extends PaymentData>(_dataType: string, extraFields: Record<string, string> = {}): Promise<T> {\n\t\t\tconst {error, result} = await orderService.placeOrder(transaction!, {\n\t\t\t\tpeachpay_transaction_id: transaction!.getId(),\n\t\t\t\t...extraFields,\n\t\t\t});\n\n\t\t\tif (error || !result || result.result !== 'success') {\n\t\t\t\tthrow new Error(error ? getErrorString(error) : getLocaleText('Unknown error occured while placing order. Please refresh the page and try again.'));\n\t\t\t}\n\n\t\t\tconst dataURL = new URL(result.redirect);\n\t\t\tconst [name, data] = dataURL.hash.split('=');\n\t\t\tif (name !== '#payment_data' || !data) {\n\t\t\t\tthrow new Error('Failed to retrieve paypal payment details from url: ' + result.redirect);\n\t\t\t}\n\n\t\t\tpaymentResult = JSON.parse(atob(decodeURIComponent(data))) as PaymentData;\n\n\t\t\treturn paymentResult as T;\n\t\t},\n\t\tredirectCancel() {\n\t\t\tif (!paymentResult) {\n\t\t\t\tthrow new Error('Payment result not set yet.');\n\t\t\t}\n\n\t\t\twindow.top!.location.href = paymentResult.cancel_url;\n\t\t},\n\t\tredirectSuccess() {\n\t\t\tif (!paymentResult) {\n\t\t\t\tthrow new Error('Payment result not set yet.');\n\t\t\t}\n\n\t\t\twindow.top!.location.href = paymentResult.success_url;\n\t\t},\n\n\t\tasync createTransaction(gatewayId: string) {\n\t\t\tconst {error, result} = await orderService.startTransaction(gatewayId);\n\t\t\tif (result) {\n\t\t\t\ttransaction = result;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthrow error;\n\t\t},\n\t\tasync completeTransaction(update: TransactionUpdate) {\n\t\t\tawait transaction!.complete(update);\n\t\t},\n\n\t\tfeatureEnabled(feature: FeatureFlag) {\n\t\t\treturn Feature.enabled(feature);\n\t\t},\n\t\tfeatureMetadata<T = string>(feature: FeatureFlag, key: string) {\n\t\t\tconst metadata = Feature.metadata<T>(feature, key);\n\t\t\tif (metadata === null) {\n\t\t\t\tthrow new Error(`Feature metadata for '${feature}' with metadata key '${key}' does not exist`);\n\t\t\t}\n\n\t\t\treturn metadata;\n\t\t},\n\t} satisfies PaymentAttempt;\n}\n","import {type ICartCalculationRecord, type ICartMetaData, type IShippingMethod} from '../../../@type/woocommerce/cart-calculation';\nimport {type DispatchAction, store} from '../store';\nimport {DispatchActionType} from '../models/DispatchActionType';\nimport {type KeyValue} from '../../../@type/dictionary';\nimport {getLocaleText} from '../util/translation';\nimport {MerchantConfiguration} from './merchantConfigurationReducer';\nimport {createDispatchUpdate} from './initialState';\n\n/**\n * Reducer for handling cart calculation state changes.\n * @param state\n * @param action\n */\nexport function cartReducer(state: ICartCalculationRecord, action: DispatchAction<unknown>): ICartCalculationRecord {\n\tswitch (action.type) {\n\t\tcase DispatchActionType.CART_CALCULATION:\n\t\t\treturn {\n\t\t\t\t...(action as DispatchAction<ICartCalculationRecord>).payload,\n\t\t\t};\n\t\tcase DispatchActionType.CART_SHIPPING_SELECTION: {\n\t\t\tconst {payload} = action as DispatchAction<ICartShippingSelection>;\n\t\t\tconst newState = {...state};\n\n\t\t\tif (!newState?.[payload.cartKey]?.package_record) {\n\t\t\t\treturn newState;\n\t\t\t}\n\n\t\t\tconst packageRecord = (newState[payload.cartKey]!).package_record;\n\t\t\tif (!packageRecord[payload.shippingPackageKey]) {\n\t\t\t\treturn newState;\n\t\t\t}\n\n\t\t\t(packageRecord[payload.shippingPackageKey]!).selected_method = payload.packageMethodId;\n\t\t\treturn newState;\n\t\t}\n\n\t\tdefault:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t};\n\t}\n}\n\n// ========================== Action Creators =======================\n\nexport const updateCartCalculation = createDispatchUpdate<ICartCalculationRecord>(DispatchActionType.CART_CALCULATION);\nexport const updateCartPackageShippingMethod = createDispatchUpdate<ICartShippingSelection>(DispatchActionType.CART_SHIPPING_SELECTION);\n\ninterface ICartShippingSelection {\n\tcartKey: string;\n\tshippingPackageKey: string;\n\tpackageMethodId: string;\n}\n\n// ========================== Store Selectors =======================\n\nfunction createCartSelectors(cartKey = '0') {\n\treturn {\n\t\tselectedShippingMethod: (packageKey = '0') => store.getState().calculatedCarts[cartKey]?.package_record?.[packageKey]?.selected_method ?? '',\n\t\tselectedShippingMethodDetails: (packageKey = '0') => store.getState().calculatedCarts[cartKey]?.package_record?.[packageKey] ?? null,\n\t\tcontents: () => store.getState().calculatedCarts[cartKey]?.cart ?? [],\n\t\tsubtotal: () => store.getState().calculatedCarts[cartKey]?.summary.subtotal ?? 0,\n\t\tfeeTotal: (fee: string) => store.getState().calculatedCarts[cartKey]?.summary.fees_record[fee] ?? 0,\n\t\ttotalAppliedFees: () => Object.entries(store.getState().calculatedCarts[cartKey]?.summary.fees_record ?? {}).reduce((previousValue, [_, value]) => previousValue + (value ?? 0), 0),\n\t\tcouponTotal: (coupon: string) => store.getState().calculatedCarts[cartKey]?.summary.coupons_record[coupon] ?? 0,\n\t\ttotalAppliedCoupons: () => Object.entries(store.getState().calculatedCarts[cartKey]?.summary.coupons_record ?? {}).reduce((previousValue, [_, value]) => previousValue + (value ?? 0), 0),\n\t\tcouponRecord: () => store.getState().calculatedCarts[cartKey]?.summary.coupons_record ?? {},\n\t\tgiftCardTotal: (giftCard: string) => store.getState().calculatedCarts[cartKey]?.summary.gift_card_record?.[giftCard] ?? 0,\n\t\ttotalAppliedGiftCards: () => Object.entries(store.getState().calculatedCarts[cartKey]?.summary.gift_card_record ?? {}).reduce((previousValue, [_, value]) => previousValue + (value ?? 0), 0),\n\t\ttotalShipping: () => store.getState().calculatedCarts[cartKey]?.summary.total_shipping ?? 0,\n\t\ttotalTax: () => store.getState().calculatedCarts[cartKey]?.summary.total_tax ?? 0,\n\t\ttotal: () => store.getState().calculatedCarts[cartKey]?.summary.total ?? 0,\n\t\tshippingMethods(packageKey = '0') {\n\t\t\tconst methods = store.getState().calculatedCarts[cartKey]?.package_record?.[packageKey]?.methods ?? {} as Record<string, IShippingMethod | undefined>;\n\n\t\t\treturn Object.entries(methods).map(([id, method]) => {\n\t\t\t\t(method!).id = id;\n\t\t\t\treturn method!;\n\t\t\t});\n\t\t},\n\t};\n}\n\nexport const DefaultCart = createCartSelectors('0');\n\nexport const Carts = {\n\tanyShippingMethodsAvailable() {\n\t\tfor (const calculatedCart of Object.values(store.getState().calculatedCarts)) {\n\t\t\tfor (const shippingPackage of Object.values(calculatedCart.package_record)) {\n\t\t\t\tif (Object.keys(shippingPackage.methods).length === 0) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t},\n\tneedsShipping() {\n\t\tfor (const calculatedCart of Object.values(store.getState().calculatedCarts)) {\n\t\t\tif (calculatedCart.needs_shipping) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t},\n\tsubscriptionPresent() {\n\t\tfor (const cartKey of Object.keys(store.getState().calculatedCarts)) {\n\t\t\tconst calculatedCart = store.getState().calculatedCarts[cartKey];\n\t\t\tif (!calculatedCart) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (calculatedCart.cart_meta.subscription) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t},\n\ttotal() {\n\t\tlet total = 0;\n\n\t\tfor (const cartKey of Object.keys(store.getState().calculatedCarts)) {\n\t\t\tconst calculatedCart = store.getState().calculatedCarts[cartKey];\n\t\t\tif (!calculatedCart) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\ttotal += calculatedCart.summary.total;\n\t\t}\n\n\t\treturn total;\n\t},\n};\n\ntype CartSummaryViewData = {\n\tcartSummary: Array<KeyValue<string, number>>;\n\tcartMeta: ICartMetaData;\n};\n\nexport function cartSummaryViewData(cartKey: string): () => CartSummaryViewData {\n\treturn () => {\n\t\tconst calculatedCart = store.getState().calculatedCarts[cartKey];\n\t\tif (!calculatedCart) {\n\t\t\treturn {\n\t\t\t\tcartSummary: new Array<KeyValue<string, number>>(),\n\t\t\t\tcartMeta: {\n\t\t\t\t\tis_virtual: false,\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\n\t\tconst cartSummary: Array<KeyValue<string, number>> = [];\n\t\tconst cartMeta = calculatedCart.cart_meta;\n\n\t\t// Subtotal\n\t\tcartSummary.push({\n\t\t\tkey: getLocaleText('Subtotal'),\n\t\t\tvalue: calculatedCart.summary.subtotal,\n\t\t});\n\n\t\tif (calculatedCart.cart.length > 0) {\n\t\t\t// Coupons\n\t\t\tfor (const [coupon, amount] of Object.entries(calculatedCart.summary.coupons_record)) {\n\t\t\t\tif (!amount) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tcartSummary.push({\n\t\t\t\t\tkey: `${getLocaleText('Coupon')} - (${coupon}) <button class=\"pp-coupon-remove-button\" data-coupon=\"${coupon}\" type=\"button\" tabindex=\"0\">[&times;]</button>`,\n\t\t\t\t\tvalue: -amount,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t// Fees\n\t\tfor (const [fee, amount] of Object.entries(calculatedCart.summary.fees_record)) {\n\t\t\tif (!amount) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tcartSummary.push({\n\t\t\t\tkey: `Fee - (${fee})`,\n\t\t\t\tvalue: amount,\n\t\t\t});\n\t\t}\n\n\t\t// Shipping\n\t\tif (!calculatedCart.cart_meta.is_virtual) {\n\t\t\tcartSummary.push({\n\t\t\t\tkey: getLocaleText('Shipping'),\n\t\t\t\tvalue: calculatedCart.summary.total_shipping,\n\t\t\t});\n\t\t}\n\n\t\t// Tax\n\t\tif (MerchantConfiguration.tax.displayMode() === 'excludeTax' && calculatedCart.summary.total_tax !== 0) {\n\t\t\tif (calculatedCart.summary.tax_lines?.length) {\n\t\t\t\tcalculatedCart.summary.tax_lines.forEach(tax_line => {\n\t\t\t\t\tcartSummary.push({\n\t\t\t\t\t\tkey: tax_line['label'] === 'Tax' ? getLocaleText('Tax') : tax_line['label'],\n\t\t\t\t\t\tvalue: parseFloat(tax_line['amount']),\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tcartSummary.push({\n\t\t\t\t\tkey: getLocaleText('Tax'),\n\t\t\t\t\tvalue: calculatedCart.summary.total_tax,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (calculatedCart.cart.length > 0) {\n\t\t\t// Gift cards\n\t\t\tfor (const [giftCard, amount] of Object.entries(calculatedCart.summary.gift_card_record)) {\n\t\t\t\tif (!amount) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tcartSummary.push({\n\t\t\t\t\tkey: `Gift card - (${giftCard})`,\n\t\t\t\t\tvalue: -amount,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t// Total\n\t\tcartSummary.push({\n\t\t\tkey: getLocaleText('Total'),\n\t\t\tvalue: calculatedCart.summary.total,\n\t\t});\n\n\t\treturn {cartSummary, cartMeta};\n\t};\n}\n","import {type IDictionary} from '../../../@type/dictionary';\nimport {type FeatureFlag} from '../../../@type/features';\nimport {type IFeatureSupport} from '../models/CheckoutData';\nimport {DispatchActionType} from '../models/DispatchActionType';\nimport {type IEnvironment, type LoadingMode, type ModalPage} from '../models/IEnvironment';\nimport {type DispatchAction, store} from '../store';\nimport {createDispatchUpdate} from './initialState';\n\nexport function environmentReducer(state: IEnvironment, action: DispatchAction<unknown>): IEnvironment {\n\tswitch (action.type) {\n\t\tcase DispatchActionType.ENVIRONMENT:\n\t\t\treturn {\n\t\t\t\t...(action as DispatchAction<IEnvironment>).payload,\n\t\t\t\tplugin: {...(action as DispatchAction<IEnvironment>).payload.plugin},\n\t\t\t\tmodalUI: {...(action as DispatchAction<IEnvironment>).payload.modalUI},\n\t\t\t};\n\t\tcase DispatchActionType.ENVIRONMENT_TRANSLATED_MODAL_TERMS:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\ttranslated_modal_terms: (action as DispatchAction<IDictionary>).payload,\n\t\t\t};\n\t\tcase DispatchActionType.ENVIRONMENT_SET_FEATURES:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tplugin: {\n\t\t\t\t\t...state.plugin,\n\t\t\t\t\tfeatureSupport: (action as DispatchAction<Record<string, IFeatureSupport | undefined>>).payload,\n\t\t\t\t},\n\t\t\t};\n\t\tdefault:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tmodalUI: {...state.modalUI},\n\t\t\t};\n\t}\n}\n\n// ======================= Action Creators =============================\n\nexport function updateEnvironment(options: {\n\ttranslated_modal_terms?: IDictionary;\n\tmodalButtonShadow?: boolean;\n\tmodalPageType?: ModalPage;\n\tmodalLoading?: LoadingMode;\n}): DispatchAction<IEnvironment> {\n\treturn {\n\t\ttype: DispatchActionType.ENVIRONMENT,\n\t\tpayload: {\n\t\t\ttranslated_modal_terms: options.translated_modal_terms ?? Environment.translated_modal_terms(),\n\t\t\tplugin: {\n\t\t\t\tfeatureSupport: store.getState().environment.plugin.featureSupport,\n\t\t\t},\n\t\t\tmodalUI: {\n\t\t\t\tpage: (options.modalPageType) ?? Environment.modalUI.page(),\n\t\t\t\tloadingMode: options.modalLoading ?? Environment.modalUI.loadingMode(),\n\t\t\t},\n\t\t},\n\t};\n}\n\nexport function setFeatureSupport(features: Record<string, IFeatureSupport | undefined> = {}): DispatchAction<Record<string, IFeatureSupport | undefined>> {\n\treturn {\n\t\ttype: DispatchActionType.ENVIRONMENT_SET_FEATURES,\n\t\tpayload: features,\n\t};\n}\n\nexport const updateTranslatedModalTerms = createDispatchUpdate<IDictionary>(DispatchActionType.ENVIRONMENT_TRANSLATED_MODAL_TERMS);\nexport const startModalLoading = () => updateEnvironment({modalLoading: 'loading'});\nexport const startModalProcessing = () => updateEnvironment({modalLoading: 'processing'});\nexport const stopModalLoading = () => updateEnvironment({modalLoading: 'finished'});\n\n// ======================= Store Selectors =============================\n\nexport const Environment = {\n\tlanguage: () => document.documentElement.lang ?? 'en-US',\n\tenvironment: () => store.getState().environment,\n\ttranslated_modal_terms: () => store.getState().environment.translated_modal_terms,\n\tmodalUI: {\n\t\tpage: () => store.getState().environment.modalUI.page,\n\t\tloadingMode: () => store.getState().environment.modalUI.loadingMode,\n\t},\n};\n\nexport const Feature = {\n\tenabled: (flag: FeatureFlag) => store.getState().environment.plugin.featureSupport[flag]?.enabled ?? false,\n\tmetadata: <T>(flag: FeatureFlag, key: string) => (store.getState().environment.plugin.featureSupport[flag]?.metadata?.[key] ?? null) as T | null,\n\tdynamicMetadata: <T>(flag: FeatureFlag, key: string, cartKey = '0') => (store.getState().calculatedCarts[cartKey]?.feature_metadata?.[flag]?.[key] ?? null) as T | null,\n};\n","import {type DispatchActionType} from '../models/DispatchActionType';\nimport {type IState} from '../models/IState';\nimport {type DispatchAction} from '../store';\n\n// Default state data. Required for reducers to work correctly right away.\nexport const initialState: IState = {\n\tenvironment: {\n\t\ttranslated_modal_terms: {},\n\t\tplugin: {\n\t\t\tfeatureSupport: {},\n\t\t},\n\t\tmodalUI: {\n\t\t\tpage: 'billing',\n\t\t\tloadingMode: 'finished',\n\t\t},\n\t},\n\tpeachPayOrder: {\n\t\terrorMessage: '',\n\t},\n\tmerchantConfiguration: {\n\t\tgeneral: {\n\t\t\tcurrency: {\n\t\t\t\tname: 'United States Dollar',\n\t\t\t\tcode: 'USD',\n\t\t\t\tsymbol: '$',\n\t\t\t\tposition: 'left',\n\t\t\t\tthousands_separator: ',',\n\t\t\t\tdecimal_separator: '.',\n\t\t\t\trounding: 'disabled',\n\t\t\t\tnumber_of_decimals: 2,\n\t\t\t\thidden: false,\n\t\t\t},\n\t\t},\n\t\tshipping: {\n\t\t\tshippingZones: 0,\n\t\t},\n\t\ttax: {\n\t\t\tdisplayPricesInCartAndCheckout: 'excludeTax',\n\t\t},\n\t},\n\tcalculatedCarts: {\n\t\t// Standard/Default cart is always the key \"0\"\n\t\t0: {\n\t\t\tneeds_shipping: false,\n\t\t\tpackage_record: {},\n\t\t\tcart: [],\n\t\t\tsummary: {\n\t\t\t\tfees_record: {},\n\t\t\t\tcoupons_record: {},\n\t\t\t\tgift_card_record: {},\n\t\t\t\tsubtotal: 0,\n\t\t\t\ttotal_shipping: 0,\n\t\t\t\ttax_lines: [],\n\t\t\t\ttotal_tax: 0,\n\t\t\t\ttotal: 0,\n\t\t\t},\n\t\t\tcart_meta: {\n\t\t\t\tis_virtual: false,\n\t\t\t},\n\t\t},\n\t},\n\tpaymentConfiguration: {\n\t\tselectedGateway: '',\n\t\tavailableGateways: [],\n\t\tgatewayAvailabilityDetails: {},\n\n\t\tgatewayConfigurations: {},\n\t},\n};\n\n/**\n * Returns a action creator to return a specific type of Dispatch Action without processing.\n */\nexport function createDispatchUpdate<T>(type: DispatchActionType): (payload: T) => DispatchAction<T> {\n\treturn (payload: T) => ({\n\t\ttype,\n\t\tpayload,\n\t});\n}\n","import {type ICurrencyConfiguration} from '../../../@type/woocommerce/currency-configuration';\nimport {type IMerchantConfiguration} from '../models/IMerchantConfiguration';\nimport {type DispatchAction, store} from '../store';\nimport {DispatchActionType} from '../models/DispatchActionType';\nimport {createDispatchUpdate} from './initialState';\n\n/**\n * Merchant settings reducer.\n */\nexport function merchantConfigurationReducer(state: IMerchantConfiguration, action: DispatchAction<unknown>): IMerchantConfiguration {\n\tswitch (action.type) {\n\t\tcase DispatchActionType.MERCHANT_GENERAL_CURRENCY:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tgeneral: {\n\t\t\t\t\t...state.general,\n\t\t\t\t\tcurrency: {\n\t\t\t\t\t\t...(action as DispatchAction<ICurrencyConfiguration>).payload,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\tcase DispatchActionType.MERCHANT_TAX:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\ttax: {\n\t\t\t\t\t...(action as DispatchAction<IMerchantConfiguration['tax']>).payload,\n\t\t\t\t},\n\t\t\t};\n\t\tcase DispatchActionType.MERCHANT_SHIPPING:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tshipping: {\n\t\t\t\t\t...(action as DispatchAction<IMerchantConfiguration['shipping']>).payload,\n\t\t\t\t},\n\t\t\t};\n\t\tdefault:\n\t\t\treturn {...state};\n\t}\n}\n\n// ======================== Action Creators ==============================\n\nexport const updateMerchantCurrencyConfig = createDispatchUpdate<ICurrencyConfiguration>(DispatchActionType.MERCHANT_GENERAL_CURRENCY);\nexport const updateMerchantTaxConfig = createDispatchUpdate<IMerchantConfiguration['tax']>(DispatchActionType.MERCHANT_TAX);\nexport const updateMerchantGeneralConfig = createDispatchUpdate<IMerchantConfiguration['general']>(DispatchActionType.MERCHANT_GENERAL);\nexport const updateMerchantShippingConfig = createDispatchUpdate<IMerchantConfiguration['shipping']>(DispatchActionType.MERCHANT_SHIPPING);\n\n// ========================= Store Selectors ===========================\n\nexport const MerchantConfiguration = {\n\tgeneral: {\n\t\twcLocationInfoData: () => store.getState().merchantConfiguration.general.wcLocationInfoData,\n\t},\n\tcurrency: {\n\t\tconfiguration: () => store.getState().merchantConfiguration.general.currency,\n\t\tcode: () => store.getState().merchantConfiguration.general.currency.code,\n\t\tsymbol: () => store.getState().merchantConfiguration.general.currency.symbol,\n\t},\n\ttax: {\n\t\tdisplayMode: () => store.getState().merchantConfiguration.tax.displayPricesInCartAndCheckout,\n\t},\n\tshipping: {\n\t\tshippingZones: () => store.getState().merchantConfiguration.shipping.shippingZones,\n\t},\n};\n","import {DispatchActionType} from '../models/DispatchActionType';\nimport {GatewayEligibility, type IPaymentConfiguration, type GatewayConfiguration, type GatewayEligibilityDetails} from '../models/GatewayConfiguration';\nimport {type DispatchAction, store} from '../store';\nimport {getLocaleText} from '../util/translation';\nimport {createDispatchUpdate} from './initialState';\n\nfunction paymentConfigurationReducer(state: IPaymentConfiguration, action: DispatchAction<unknown>): IPaymentConfiguration {\n\tswitch (action.type) {\n\t\tcase DispatchActionType.PAYMENT_REGISTER_GATEWAY_BATCH: {\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tgatewayConfigurations: {\n\t\t\t\t\t...state.gatewayConfigurations,\n\t\t\t\t\t...(action as DispatchAction<Record<string, GatewayConfiguration>>).payload,\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\n\t\tcase DispatchActionType.PAYMENT_UPDATE_AVAILABLE_GATEWAYS: {\n\t\t\tconst {payload} = action as DispatchAction<IPaymentConfiguration['availableGateways']>;\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tavailableGateways: payload,\n\t\t\t};\n\t\t}\n\n\t\tcase DispatchActionType.PAYMENT_UPDATE_GATEWAY_AVAILABILITY_DETAILS: {\n\t\t\tconst {payload} = action as DispatchAction<IPaymentConfiguration['gatewayAvailabilityDetails']>;\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tgatewayAvailabilityDetails: payload,\n\t\t\t};\n\t\t}\n\n\t\tcase DispatchActionType.PAYMENT_SET_SELECTED_GATEWAY: {\n\t\t\tconst {payload} = action as DispatchAction<string>;\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tselectedGateway: payload,\n\t\t\t};\n\t\t}\n\n\t\tdefault:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t};\n\t}\n}\n\n// ======================= Dispatch Helpers =============================\nconst registerGatewayBatch = createDispatchUpdate<Record<string, GatewayConfiguration>>(DispatchActionType.PAYMENT_REGISTER_GATEWAY_BATCH);\nconst setSelectedPaymentGateway = createDispatchUpdate<string>(DispatchActionType.PAYMENT_SET_SELECTED_GATEWAY);\nconst updateAvailableGateways = createDispatchUpdate<string[]>(DispatchActionType.PAYMENT_UPDATE_AVAILABLE_GATEWAYS);\nconst updateGatewayDetails = createDispatchUpdate<Record<string, GatewayEligibilityDetails>>(DispatchActionType.PAYMENT_UPDATE_GATEWAY_AVAILABILITY_DETAILS);\n\n// ======================= Store Selectors =============================\n\ntype GatewayEligibilityContext = {eligibility: GatewayEligibility; config: GatewayConfiguration; displayIndex?: number};\n\nconst PaymentConfiguration = {\n\tdata: () => (store.getState().paymentConfiguration),\n\tselectedGateway: () => store.getState().paymentConfiguration.selectedGateway,\n\tgatewayConfig: (gatewayId: string) => store.getState().paymentConfiguration.gatewayConfigurations[gatewayId] ?? null,\n\teligibleGatewayDetails(gatewayId: string): GatewayEligibilityDetails | null {\n\t\tconst config = store.getState().paymentConfiguration.gatewayConfigurations[gatewayId];\n\t\tif (!config) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst details = store.getState().paymentConfiguration.gatewayAvailabilityDetails[gatewayId] ?? {};\n\n\t\tif (config.browser === false) {\n\t\t\tdetails.browser = {\n\t\t\t\texplanation: getLocaleText('This payment method is not supported by your browser. Please try a different option.'),\n\t\t\t};\n\t\t}\n\n\t\tif (config.initialized === false) {\n\t\t\tdetails.initialized = {\n\t\t\t\texplanation: getLocaleText('Something went wrong initializing this payment method. Please try a different option or try again later.'),\n\t\t\t};\n\t\t}\n\n\t\treturn details;\n\t},\n\tsortGatewaysByEligibility(): GatewayEligibilityContext[] {\n\t\tlet displayIndex = 0;\n\t\tconst sortedEligibility = Object.values(store.getState().paymentConfiguration.gatewayConfigurations)\n\t\t\t.map<GatewayEligibilityContext>(config => ({config, eligibility: PaymentConfiguration.eligibleGateway(config.gatewayId)}))\n\t\t\t// Second we sort on the available gateways array so the methods are displayed in the same order as\n\t\t\t// configured by WC. If the method is ineligible the existing ordering should not be touched.\n\t\t\t.sort((a, b) => {\n\t\t\t\tconst indexA = store.getState().paymentConfiguration.availableGateways.indexOf(a.config.gatewayId);\n\t\t\t\tconst indexB = store.getState().paymentConfiguration.availableGateways.indexOf(b.config.gatewayId);\n\n\t\t\t\treturn indexA - indexB;\n\t\t\t})\n\t\t\t// First sorting on just eligibility. This puts all the in eligible gateways at the end of the array.\n\t\t\t.sort((a, b) => a.eligibility - b.eligibility)\n\t\t\t.map(context => {\n\t\t\t\tif (context.eligibility) {\n\t\t\t\t\tcontext.displayIndex = displayIndex;\n\t\t\t\t\tdisplayIndex++;\n\t\t\t\t}\n\n\t\t\t\treturn context;\n\t\t\t});\n\n\t\tconst selectedContextIndex = sortedEligibility.findIndex(context => context.config.gatewayId === PaymentConfiguration.selectedGateway());\n\t\tconst selectedContext = sortedEligibility[selectedContextIndex];\n\n\t\tif (selectedContext?.displayIndex && selectedContext.displayIndex > 2) {\n\t\t\t// Remove the selected context from the array.\n\t\t\tsortedEligibility.splice(selectedContextIndex, 1);\n\n\t\t\t// Get the index to place the selected context at.\n\t\t\tconst spliceIndex = sortedEligibility.findIndex(context => context.displayIndex === 2);\n\n\t\t\t// Splice the selected context into the array at the correct index.\n\t\t\tsortedEligibility.splice(spliceIndex, 0, selectedContext);\n\n\t\t\t// We have to remap the display index again after changing the order so the UI is rendered correctly.\n\t\t\tlet updatedDisplayIndex = 0;\n\t\t\treturn sortedEligibility.map(context => {\n\t\t\t\tcontext.displayIndex = undefined;\n\t\t\t\tif (context.eligibility) {\n\t\t\t\t\tcontext.displayIndex = updatedDisplayIndex;\n\t\t\t\t\tupdatedDisplayIndex++;\n\t\t\t\t}\n\n\t\t\t\treturn context;\n\t\t\t});\n\t\t}\n\n\t\treturn sortedEligibility;\n\t},\n\teligibleGateway(gatewayId: string): GatewayEligibility {\n\t\tconst config = store.getState().paymentConfiguration.gatewayConfigurations[gatewayId];\n\t\tif (!config) {\n\t\t\treturn GatewayEligibility.NotEligible;\n\t\t}\n\n\t\tif (!store.getState().paymentConfiguration.availableGateways.includes(config.gatewayId)) {\n\t\t\treturn GatewayEligibility.NotEligible;\n\t\t}\n\n\t\tconst availabilityDetails = PaymentConfiguration.eligibleGatewayDetails(gatewayId);\n\t\t// Lack of availability details means the gateway is eligible if it is also part of the availableGateways array.\n\t\tif (!availabilityDetails || Object.keys(availabilityDetails).length === 0) {\n\t\t\treturn GatewayEligibility.Eligible;\n\t\t}\n\n\t\tif (availabilityDetails.minimum) {\n\t\t\treturn GatewayEligibility.EligibleWithChange;\n\t\t}\n\n\t\tif (availabilityDetails.maximum) {\n\t\t\treturn GatewayEligibility.EligibleWithChange;\n\t\t}\n\n\t\tif (availabilityDetails.currency) {\n\t\t\tif (availabilityDetails.currency.available_options?.length) {\n\t\t\t\treturn GatewayEligibility.EligibleWithChange;\n\t\t\t}\n\n\t\t\treturn GatewayEligibility.NotEligible;\n\t\t}\n\n\t\tif (availabilityDetails.country?.available_options?.length) {\n\t\t\tif (availabilityDetails.country.available_options?.length) {\n\t\t\t\treturn GatewayEligibility.EligibleWithChange;\n\t\t\t}\n\n\t\t\treturn GatewayEligibility.NotEligible;\n\t\t}\n\n\t\tif (config.browser === false) {\n\t\t\treturn GatewayEligibility.NotEligible;\n\t\t}\n\n\t\tif (config.initialized === false) {\n\t\t\treturn GatewayEligibility.EligibleButErrored;\n\t\t}\n\n\t\treturn GatewayEligibility.Eligible;\n\t},\n\teligibleGatewayCount() {\n\t\tlet count = 0;\n\t\tconst data = PaymentConfiguration.data();\n\n\t\tfor (const [gatewayId] of Object.entries(data.gatewayConfigurations)) {\n\t\t\tif (PaymentConfiguration.eligibleGateway(gatewayId)) {\n\t\t\t\tcount++;\n\t\t\t}\n\t\t}\n\n\t\treturn count;\n\t},\n\tcheckEligibleOrFindAlternate(gatewayId: string): string | null {\n\t\tif (PaymentConfiguration.eligibleGateway(gatewayId)) {\n\t\t\treturn gatewayId;\n\t\t}\n\n\t\treturn PaymentConfiguration.firstEligibleMethod();\n\t},\n\tfirstEligibleMethod(): string | null {\n\t\tconst gatewayContexts = PaymentConfiguration.sortGatewaysByEligibility();\n\n\t\tfor (const context of gatewayContexts) {\n\t\t\tif (context.eligibility !== GatewayEligibility.NotEligible) {\n\t\t\t\treturn context.config.gatewayId;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t},\n};\n\nexport {\n\ttype GatewayEligibilityContext,\n\tPaymentConfiguration,\n\tpaymentConfigurationReducer,\n\tregisterGatewayBatch,\n\tupdateAvailableGateways,\n\tupdateGatewayDetails,\n\tsetSelectedPaymentGateway,\n};\n","import {type PaymentMethodCreateParams} from '@stripe/stripe-js';\nimport {$qsAll} from '../../../@shared/ts/dom';\nimport {formatAddress} from 'localized-address-format';\n\n/**\n * Gets or sets the value of a select element.\n */\nfunction selectGetSet($select: HTMLSelectElement, value?: string, changeEvent = false): string {\n\t// Set\n\tif (value !== undefined && typeof value === 'string') {\n\t\t$select.value = value;\n\t\tif (changeEvent) {\n\t\t\t$select.dispatchEvent(new Event('change', {bubbles: true}));\n\t\t}\n\t}\n\n\t// Get\n\treturn $select.selectedOptions[0]?.value ?? '';\n}\n\n/**\n * Gets or sets the value of a input[type=\"checkbox\"] element.\n */\nfunction checkboxGetSet($checkbox: HTMLInputElement, value?: boolean, changeEvent = false): string {\n\t// Set\n\tif (value !== undefined && typeof value === 'boolean') {\n\t\t$checkbox.checked = value;\n\n\t\tif (changeEvent) {\n\t\t\t$checkbox.dispatchEvent(new Event('change', {bubbles: true}));\n\t\t}\n\t}\n\n\t// Get\n\treturn $checkbox.checked ? $checkbox.value : '';\n}\n\n/**\n * Gets or sets the selected value of a input[type=\"radio\"] element group.\n */\nfunction radioGetSet($radios: HTMLInputElement[], value?: string, _changeEvent = false): string {\n\t// Set\n\tif (value !== undefined && typeof value === 'string') {\n\t\tthrow new Error('Radio input SET not implemented');\n\t}\n\n\t// Get\n\tfor (const radioField of $radios) {\n\t\tif ('checked' in radioField && radioField.checked) {\n\t\t\treturn radioField.value;\n\t\t}\n\t}\n\n\treturn '';\n}\n\n/**\n * Gets or sets the value of a input[type=\"text\"] or text like input element.\n */\nfunction inputGetSet($input: HTMLInputElement, value?: string, changeEvent = false): string {\n\t// SET text,phone,tel,email,date,time,... inputs\n\tif (value !== undefined && typeof value === 'string') {\n\t\t$input.value = value;\n\n\t\tif (changeEvent) {\n\t\t\t$input.dispatchEvent(new Event('change', {bubbles: true}));\n\t\t}\n\t}\n\n\t// GET text,phone,tel,email,date,time,... inputs\n\treturn $input.value;\n}\n\n/**\n * HTML input field getter/setter factory.\n */\nfunction fieldGetSet(selector: string) {\n\tconst getField = () => $qsAll<HTMLInputElement | HTMLSelectElement>(selector);\n\n\treturn (value?: string | boolean, changeEvent = false): string => {\n\t\tconst fields = getField();\n\t\tconst field = fields[0];\n\n\t\tif (!fields.length || !field) {\n\t\t\treturn '';\n\t\t}\n\n\t\t// Select input\n\t\tif (field.nodeName === 'SELECT' && 'selectedOptions' in field) {\n\t\t\treturn selectGetSet(field, value as string, changeEvent);\n\t\t}\n\n\t\t// Checkbox input\n\t\tif (field.nodeName === 'INPUT' && field.type === 'checkbox' && 'checked' in field) {\n\t\t\treturn checkboxGetSet(field, value as boolean, changeEvent);\n\t\t}\n\n\t\t// Radio input\n\t\tif (field.nodeName === 'INPUT' && field.type === 'radio' && 'checked' in field) {\n\t\t\treturn radioGetSet(fields as HTMLInputElement[], value as string, changeEvent);\n\t\t}\n\n\t\t// All other input types. Ex: text,phone,tel,email,date,time,...\n\t\treturn inputGetSet(field as HTMLInputElement, value as string, changeEvent);\n\t};\n}\n\n/**\n * Always returns the most up to date customer state\n */\nexport const PeachPayCustomer = {\n\tbilling: {\n\t\temail: fieldGetSet('#pp-billing-form [name=\"billing_email\"]'),\n\t\tfullName() {\n\t\t\tconst first = PeachPayCustomer.billing.firstName();\n\t\t\tconst last = PeachPayCustomer.billing.lastName();\n\n\t\t\tlet fullName = '';\n\t\t\tif (first) {\n\t\t\t\tfullName += first;\n\t\t\t}\n\n\t\t\tif (first && last) {\n\t\t\t\tfullName += ' ';\n\t\t\t}\n\n\t\t\tif (last) {\n\t\t\t\tfullName += last;\n\t\t\t}\n\n\t\t\treturn fullName;\n\t\t},\n\t\tfirstName: fieldGetSet('#pp-billing-form [name=\"billing_first_name\"]'),\n\t\tlastName: fieldGetSet('#pp-billing-form [name=\"billing_last_name\"]'),\n\t\tphone: fieldGetSet('#pp-billing-form [name=\"billing_phone\"]'),\n\t\tcompany: fieldGetSet('#pp-billing-form [name=\"billing_company\"]'),\n\t\taddress1: fieldGetSet('#pp-billing-form [name=\"billing_address_1\"]'),\n\t\taddress2: fieldGetSet('#pp-billing-form [name=\"billing_address_2\"]'),\n\t\tcity: fieldGetSet('#pp-billing-form [name=\"billing_city\"]'),\n\t\tpostal: fieldGetSet('#pp-billing-form [name=\"billing_postcode\"]'),\n\t\tstate: fieldGetSet('#pp-billing-form [name=\"billing_state\"]'),\n\t\tcountry: fieldGetSet('#pp-billing-form [name=\"billing_country\"]'),\n\t\tformattedAddress() {\n\t\t\treturn formatAddress({\n\t\t\t\tpostalCountry: PeachPayCustomer.billing.country(),\n\t\t\t\tadministrativeArea: PeachPayCustomer.billing.state(),\n\t\t\t\tlocality: PeachPayCustomer.billing.city(),\n\t\t\t\tpostalCode: PeachPayCustomer.billing.postal(),\n\t\t\t\torganization: PeachPayCustomer.billing.company(),\n\t\t\t\tname: PeachPayCustomer.billing.fullName(),\n\t\t\t\taddressLines: [\n\t\t\t\t\tPeachPayCustomer.billing.address1(),\n\t\t\t\t\tPeachPayCustomer.billing.address2(),\n\t\t\t\t],\n\t\t\t});\n\t\t},\n\t},\n\tshipToDifferentAddress: fieldGetSet('#pp-shipping-form [name=\"ship_to_different_address\"]'),\n\tshipping: {\n\t\temail: fieldGetSet('#pp-shipping-form [name=\"shipping_email\"]'),\n\t\tfullName() {\n\t\t\tconst first = PeachPayCustomer.shipping.firstName();\n\t\t\tconst last = PeachPayCustomer.shipping.lastName();\n\n\t\t\tlet fullName = '';\n\t\t\tif (first) {\n\t\t\t\tfullName += first;\n\t\t\t}\n\n\t\t\tif (first && last) {\n\t\t\t\tfullName += ' ';\n\t\t\t}\n\n\t\t\tif (last) {\n\t\t\t\tfullName += last;\n\t\t\t}\n\n\t\t\treturn fullName;\n\t\t},\n\t\tfirstName: fieldGetSet('#pp-shipping-form [name=\"shipping_first_name\"]'),\n\t\tlastName: fieldGetSet('#pp-shipping-form [name=\"shipping_last_name\"]'),\n\t\tphone: fieldGetSet('#pp-shipping-form [name=\"shipping_phone\"]'),\n\t\tcompany: fieldGetSet('#pp-shipping-form [name=\"shipping_company\"]'),\n\t\taddress1: fieldGetSet('#pp-shipping-form [name=\"shipping_address_1\"]'),\n\t\taddress2: fieldGetSet('#pp-shipping-form [name=\"shipping_address_2\"]'),\n\t\tcity: fieldGetSet('#pp-shipping-form [name=\"shipping_city\"]'),\n\t\tpostal: fieldGetSet('#pp-shipping-form [name=\"shipping_postcode\"]'),\n\t\tstate: fieldGetSet('#pp-shipping-form [name=\"shipping_state\"]'),\n\t\tcountry: fieldGetSet('#pp-shipping-form [name=\"shipping_country\"]'),\n\t\tformattedAddress() {\n\t\t\treturn formatAddress({\n\t\t\t\tpostalCountry: PeachPayCustomer.shipping.country(),\n\t\t\t\tadministrativeArea: PeachPayCustomer.shipping.state(),\n\t\t\t\tlocality: PeachPayCustomer.shipping.city(),\n\t\t\t\tpostalCode: PeachPayCustomer.shipping.postal(),\n\t\t\t\torganization: PeachPayCustomer.shipping.company(),\n\t\t\t\tname: PeachPayCustomer.shipping.fullName(),\n\t\t\t\taddressLines: [\n\t\t\t\t\tPeachPayCustomer.shipping.address1(),\n\t\t\t\t\tPeachPayCustomer.shipping.address2(),\n\t\t\t\t],\n\t\t\t});\n\t\t},\n\t},\n\tstripeBillingDetails() {\n\t\tconst details = {\n\t\t\tname: PeachPayCustomer.billing.fullName(),\n\t\t\temail: PeachPayCustomer.billing.email(),\n\t\t\tphone: PeachPayCustomer.billing.phone(),\n\t\t\taddress: {\n\t\t\t\tcity: PeachPayCustomer.billing.city(),\n\t\t\t\tcountry: PeachPayCustomer.billing.country(),\n\t\t\t\tline1: PeachPayCustomer.billing.address1(),\n\t\t\t\tline2: PeachPayCustomer.billing.address2(),\n\t\t\t\tpostal_code: PeachPayCustomer.billing.postal(),\n\t\t\t\tstate: PeachPayCustomer.billing.state(),\n\t\t\t},\n\t\t} as PaymentMethodCreateParams.BillingDetails;\n\n\t\tif (details.name === '') {\n\t\t\tdelete details.name;\n\t\t}\n\n\t\tif (details.email === '') {\n\t\t\tdelete details.email;\n\t\t}\n\n\t\tif (details.phone === '') {\n\t\t\tdelete details.phone;\n\t\t}\n\n\t\tif (details.address?.city === '') {\n\t\t\tdelete details.address.city;\n\t\t}\n\n\t\tif (details.address?.country === '') {\n\t\t\tdelete details.address.country;\n\t\t}\n\n\t\tif (details.address?.line1 === '') {\n\t\t\tdelete details.address.line1;\n\t\t}\n\n\t\tif (details.address?.line2 === '') {\n\t\t\tdelete details.address.line2;\n\t\t}\n\n\t\tif (details.address?.postal_code === '') {\n\t\t\tdelete details.address.postal_code;\n\t\t}\n\n\t\tif (details.address?.state === '') {\n\t\t\tdelete details.address.state;\n\t\t}\n\n\t\tif (Object.keys(details.address ?? {}).length === 0) {\n\t\t\tdelete details.address;\n\t\t}\n\n\t\treturn details;\n\t},\n\tstripeShippingDetails: () => ({\n\t\tname: PeachPayCustomer.shipping.fullName(),\n\t\tphone: PeachPayCustomer.shipping.phone(),\n\t\taddress: {\n\t\t\tcity: PeachPayCustomer.shipping.city(),\n\t\t\tcountry: PeachPayCustomer.shipping.country(),\n\t\t\tline1: PeachPayCustomer.shipping.address1(),\n\t\t\tline2: PeachPayCustomer.shipping.address2(),\n\t\t\tpostal_code: PeachPayCustomer.shipping.postal(),\n\t\t\tstate: PeachPayCustomer.shipping.state(),\n\t\t},\n\t}),\n};\n","import {$qs} from '../../../@shared/ts/dom';\nimport {maybeGotoPage} from '../features/modal';\nimport {store} from '../store';\nimport {Carts} from './cartReducer';\nimport {PeachPayCustomer} from './peachPayCustomerReducer';\n\nconst billingForm = () => $qs<HTMLFormElement>('#pp-billing-form') ?? undefined;\nconst shippingForm = () => $qs<HTMLFormElement>('#pp-shipping-form') ?? undefined;\nconst additionalForm = () => $qs<HTMLFormElement>('#pp-additional-form') ?? undefined;\n\nexport const PeachPayOrder = {\n\tcollectSelectedShipping() {\n\t\tconst carts = store.getState().calculatedCarts;\n\t\tconst selectedShippingMethodsRecord: Record<string, string> = {};\n\n\t\tfor (const cartKey of Object.keys(carts)) {\n\t\t\tconst cart = carts[cartKey];\n\n\t\t\tif (!cart) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfor (const packageKey of Object.keys(cart.package_record ?? {})) {\n\t\t\t\tconst packageRecord = cart.package_record[packageKey];\n\n\t\t\t\tif (!packageRecord) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tselectedShippingMethodsRecord[packageKey] = packageRecord.selected_method;\n\t\t\t}\n\t\t}\n\n\t\treturn selectedShippingMethodsRecord;\n\t},\n\tbilling: {\n\t\tcheckValidity() {\n\t\t\treturn billingForm()?.checkValidity() ?? true;\n\t\t},\n\t\tasync reportValidity() {\n\t\t\tawait maybeGotoPage('billing');\n\t\t\treturn billingForm()?.reportValidity() ?? true;\n\t\t},\n\t\tformData() {\n\t\t\treturn new FormData(billingForm());\n\t\t},\n\t},\n\tshipping: {\n\t\tcheckValidity() {\n\t\t\treturn shippingForm()?.checkValidity() ?? true;\n\t\t},\n\t\tasync reportValidity() {\n\t\t\tawait maybeGotoPage('shipping');\n\t\t\treturn shippingForm()?.reportValidity() ?? true;\n\t\t},\n\t\tformData() {\n\t\t\treturn new FormData(shippingForm());\n\t\t},\n\t},\n\tshippingOptions: {\n\t\tcheckValidity() {\n\t\t\treturn !Carts.needsShipping() || Carts.anyShippingMethodsAvailable();\n\t\t},\n\t\tasync reportValidity() {\n\t\t\tif (PeachPayOrder.shippingOptions.checkValidity()) {\n\t\t\t\tawait maybeGotoPage('shipping');\n\t\t\t\tPeachPayCustomer.shipToDifferentAddress(true, true);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t},\n\tadditional: {\n\t\tcheckValidity() {\n\t\t\treturn additionalForm()?.checkValidity() ?? true;\n\t\t},\n\t\tasync reportValidity() {\n\t\t\tawait maybeGotoPage('shipping');\n\t\t\treturn additionalForm()?.reportValidity() ?? true;\n\t\t},\n\t\tformData() {\n\t\t\treturn new FormData(additionalForm());\n\t\t},\n\t},\n\t/**\n\t * Checks all forms for validity. Returns false if any form is invalid. If\n\t * the form is not present then that form is considered valid.\n\t */\n\tcheckValidity(): boolean {\n\t\tif (!(billingForm()?.checkValidity() ?? true)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!(shippingForm()?.checkValidity() ?? true)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!PeachPayOrder.shippingOptions.checkValidity()) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!(additionalForm()?.checkValidity() ?? true)) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t},\n\t/**\n\t * Checks all forms for validity and reports the first invalid form to the\n\t *  customer.\n\t */\n\tasync reportValidity(): Promise<boolean> {\n\t\tif (!(billingForm()?.checkValidity() ?? true)) {\n\t\t\tawait maybeGotoPage('billing');\n\t\t\treturn billingForm()?.reportValidity() ?? true;\n\t\t}\n\n\t\tif (!(shippingForm()?.checkValidity() ?? true)) {\n\t\t\tawait maybeGotoPage('shipping');\n\t\t\treturn shippingForm()?.reportValidity() ?? true;\n\t\t}\n\n\t\tif (!PeachPayOrder.shippingOptions.checkValidity()) {\n\t\t\tawait PeachPayOrder.shippingOptions.reportValidity();\n\t\t}\n\n\t\tif (!(additionalForm()?.checkValidity() ?? true)) {\n\t\t\tawait maybeGotoPage('shipping');\n\t\t\treturn additionalForm()?.reportValidity() ?? true;\n\t\t}\n\n\t\treturn true;\n\t},\n\t/**\n\t * Gathers all form data from the billing, shipping, and additional forms.\n\t */\n\tformData() {\n\t\tconst formData = new FormData(billingForm());\n\n\t\tconst shippingFormData = new FormData(shippingForm());\n\t\tfor (const [key, value] of shippingFormData.entries()) {\n\t\t\tformData.append(key, value);\n\t\t}\n\n\t\tconst additionalFormData = new FormData(additionalForm());\n\t\tfor (const [key, value] of additionalFormData.entries()) {\n\t\t\tformData.append(key, value);\n\t\t}\n\n\t\treturn formData;\n\t},\n};\n","import {type IState} from '../models/IState';\nimport {type DispatchAction} from '../store';\n\nimport {cartReducer} from './cartReducer';\nimport {merchantConfigurationReducer} from './merchantConfigurationReducer';\nimport {environmentReducer} from './environmentReducer';\n\nimport {createDispatchUpdate, initialState} from './initialState';\nimport {paymentConfigurationReducer} from './paymentConfigurationReducer';\nimport {DispatchActionType} from '../models/DispatchActionType';\n\n// eslint-disable-next-line @typescript-eslint/default-param-last\nexport function rootReducer(state: IState = initialState, action: DispatchAction<unknown>): IState {\n\treturn {\n\t\t// All existing data.\n\t\t...state,\n\n\t\t// Let sub reducers handle nested reducing and handling related actions.\n\t\tenvironment: environmentReducer(state.environment, action),\n\t\tmerchantConfiguration: merchantConfigurationReducer(state.merchantConfiguration, action),\n\t\tcalculatedCarts: cartReducer(state.calculatedCarts, action),\n\t\tpaymentConfiguration: paymentConfigurationReducer(state.paymentConfiguration, action),\n\t};\n}\n\n/**\n * Dispatch action that changes zero state. Used to force a rerender when something outside of the redux store may have changed.\n */\nexport const render = createDispatchUpdate<void>(DispatchActionType.INIT);\n","import {$qsAll} from '../../@shared/ts/dom';\nimport {doAction} from '../../@shared/ts/hooks';\nimport {type CloseFlags} from '../../express-checkout-button/ts/sdk-checkout';\nimport {requestCartCalculation} from './payment/order';\nimport {startModalLoading, stopModalLoading} from './reducers/environmentReducer';\nimport {store} from './store';\n\nfunction checkoutCloseFlags() {\n\tconst flags: CloseFlags = {};\n\n\treturn {\n\t\tgetFlags() {\n\t\t\treturn {...flags};\n\t\t},\n\t\tsetRedirect(url: string) {\n\t\t\tflags.redirect = url;\n\t\t},\n\t\tsetReload() {\n\t\t\tflags.reload = true;\n\t\t},\n\t\tsetRefresh() {\n\t\t\tflags.refresh = true;\n\t\t},\n\t\tresetFlags() {\n\t\t\tdelete flags.redirect;\n\t\t\tdelete flags.reload;\n\t\t\tdelete flags.refresh;\n\t\t},\n\t};\n}\n\nconst SDKFlags = checkoutCloseFlags();\n\nfunction initSDKEvents() {\n\twindow.addEventListener('message', async event => {\n\t\tif (event.origin !== location.origin) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.data.type === 'peachpay_checkout_opened') {\n\t\t\t// When the express checkout is reopened we want all existing notices to be removed\n\t\t\t$qsAll('.pp-notice').forEach($el => {\n\t\t\t\t$el.remove();\n\t\t\t});\n\n\t\t\t// We also want the Express checkout to be up to date with the current cart\n\t\t\tstore.dispatch(startModalLoading());\n\t\t\tawait requestCartCalculation('pull');\n\t\t\tawait doAction('after_modal_open');\n\t\t\tstore.dispatch(stopModalLoading());\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.data.type === 'peachpay_checkout_closed') {\n\t\t\twindow.top?.postMessage({type: 'peachpay_checkout_close_flags', data: SDKFlags.getFlags()}, location.origin);\n\n\t\t\tSDKFlags.resetFlags();\n\t\t}\n\t});\n}\n\nfunction closeCheckout() {\n\tif (window.top === window) {\n\t\twindow.location.href = '/cart';\n\t\treturn;\n\t}\n\n\twindow.top?.postMessage({type: 'peachpay_checkout_close'}, location.origin);\n}\n\nexport {\n\tinitSDKEvents,\n\n\tSDKFlags,\n\n\tcloseCheckout,\n};\n","import {initialState} from './reducers/initialState';\nimport {type IState} from './models/IState';\nimport {rootReducer} from './reducers/rootReducer';\n\nexport interface DispatchAction<T> {\n\ttype: string;\n\tpayload: T;\n}\ninterface Store<S> {\n\t/**\n\t * Used to update the state of the application.\n\t * @param action A plain object representing the change in state.\n\t */\n\tdispatch<T>(action: DispatchAction<T>): void;\n\n\t/**\n\t * A readonly object of the current state of the application. This should not be mutated.\n\t */\n\tgetState(): Readonly<S>;\n\n\t/**\n\t * Used to listen for updates to the state. Ex: Rerendering UI when data changes.\n\t * @param listener The callback for when the state changes.\n\t * @returns A void function to cancel the listeners from further updates.\n\t */\n\tsubscribe(listener: () => void): () => void;\n}\n\n/**\n * Should be treated as the single source of truth for the modal state.\n */\nexport const store = createStore<IState>(rootReducer, initialState);\n\n/**\n * Creates a simplified redux store.\n * Simplified version of: https://github.com/reduxjs/redux/blob/master/src/createStore.ts\n */\nfunction createStore<S>(reducer: <T>(state: S, action: DispatchAction<T>) => S, preloadedState: S): Store<S> {\n\tlet isDispatching = false;\n\tconst currentReducer = reducer;\n\tlet currentState: S = preloadedState;\n\n\tlet currentListeners: Array<() => void> | null = [];\n\tlet nextListeners = currentListeners;\n\n\tconst dispatch = <T>(action: DispatchAction<T>) => {\n\t\tif (typeof action !== 'object') {\n\t\t\tthrow new TypeError('You may only dispatch plain objects. Received: ' + typeof action);\n\t\t}\n\n\t\tif (typeof action.type === 'undefined') {\n\t\t\tthrow new TypeError('You may not have an undefined \"type\" property.');\n\t\t}\n\n\t\tif (isDispatching) {\n\t\t\tthrow new Error('Reducers may not dispatch actions.');\n\t\t}\n\n\t\ttry {\n\t\t\tisDispatching = true;\n\t\t\tcurrentState = currentReducer(currentState, action);\n\t\t} finally {\n\t\t\tisDispatching = false;\n\t\t}\n\n\t\t// eslint-disable-next-line no-multi-assign\n\t\tconst listeners = (currentListeners = nextListeners);\n\t\tfor (let i = 0; i < listeners?.length; i++) {\n\t\t\tconst listener = listeners[i];\n\t\t\tlistener?.();\n\t\t}\n\n\t\treturn action;\n\t};\n\n\tconst getState = () => {\n\t\tif (isDispatching) {\n\t\t\tthrow new Error('You may not call getState from within a reducer.');\n\t\t}\n\n\t\treturn currentState;\n\t};\n\n\tconst subscribe = (listener: () => void) => {\n\t\tif (typeof listener !== 'function') {\n\t\t\tthrow new TypeError('Expected a listener to be a function. Instead received: ' + typeof listener);\n\t\t}\n\n\t\tif (isDispatching) {\n\t\t\tthrow new Error('You may not add a subscriber from a subscription function.');\n\t\t}\n\n\t\tlet isSubscribed = true;\n\t\tif (nextListeners === currentListeners) {\n\t\t\tnextListeners = currentListeners?.slice() ?? null;\n\t\t}\n\n\t\tnextListeners?.push(listener);\n\n\t\treturn () => {\n\t\t\tif (!isSubscribed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (isDispatching) {\n\t\t\t\tthrow new Error('You may not remove a subscriber while reducing or inside a subscription function.');\n\t\t\t}\n\n\t\t\tisSubscribed = false;\n\n\t\t\tif (nextListeners === currentListeners) {\n\t\t\t\tnextListeners = currentListeners?.slice() ?? null;\n\t\t\t}\n\n\t\t\tconst index = nextListeners?.indexOf(listener) ?? 0;\n\t\t\tnextListeners.slice(index, 1);\n\t\t\tcurrentListeners = null;\n\t\t};\n\t};\n\n\tdispatch({type: 'init'} as DispatchAction<unknown>);\n\n\tconst store: Store<S> = {\n\t\tdispatch,\n\t\tgetState,\n\t\tsubscribe,\n\t};\n\n\treturn store;\n}\n","/**\n * Capitalizes the first letter in a string.\n */\nexport function capitalizeFirstLetter(string: string) {\n\tconst stringToUpper = String(string);\n\treturn stringToUpper.charAt(0).toUpperCase() + stringToUpper.slice(1);\n}\n","import {FeatureFlag} from '../../../@type/features';\nimport {type WCCartItem} from '../../../@type/woocommerce/cart-item';\nimport {DefaultCart} from '../reducers/cartReducer';\nimport {Feature} from '../reducers/environmentReducer';\nimport {MerchantConfiguration} from '../reducers/merchantConfigurationReducer';\nimport {formatCostString, formatCurrencyString} from './currency';\nimport {capitalizeFirstLetter} from './string';\nimport {getLocaleText} from './translation';\n\n/**\n * Gets the quantity from the cart item\n */\nexport function cartItemQuantity(cartItem: WCCartItem | null): number {\n\treturn typeof cartItem?.quantity === 'string' ? Number.parseInt(cartItem.quantity) : (cartItem?.quantity ?? 0);\n}\n\nexport function bundleQuantityLabel(item: WCCartItem) {\n\tlet bundleItemQuantity = '';\n\tif (item.is_part_of_bundle) {\n\t\tconst bundle = DefaultCart.contents().find(cartItem => cartItem.item_key === item.bundled_by);\n\t\tif (bundle && !isNaN(parseInt(bundle.quantity))) {\n\t\t\tbundleItemQuantity = ` × ${cartItemQuantity(item) / parseInt(bundle.quantity)}`;\n\t\t}\n\t}\n\n\treturn bundleItemQuantity;\n}\n\nexport function cartItemLabel(item: WCCartItem) {\n\tlet {name} = item;\n\n\t// The store ugoprobaseball.com has an extra options plugin configured\n\t// in a non-standard way, which is why we need to include the variation\n\t// in name as it does not come back in the formatted item data.\n\tif (item.formatted_item_data && item.name_with_variation) {\n\t\tname = item.name_with_variation;\n\t}\n\n\tif (!item.is_part_of_bundle) {\n\t\tname = '<span>' + name + '</span>';\n\t}\n\n\tconst variationTitle = !item.attributes && item.variation_title ? ` - ${item.variation_title}` : '';\n\n\tconst label = `${name}${variationTitle}`;\n\n\treturn label;\n}\n\nexport function cartItemDisplayAmount(item: WCCartItem): string {\n\tif (item.is_subscription) {\n\t\tconst stringAmount = item.subscription_price_string?.indexOf(String(item.display_price ?? item.price)) ? formatCostString(Number.parseFloat(item.display_price ?? item.price)) : '';\n\t\treturn `${MerchantConfiguration.currency.symbol()}${stringAmount}${item.subscription_price_string ?? ''}`;\n\t}\n\n\tif (item.is_bundle) {\n\t\tconst bundlePrice: number = Number.parseFloat(item.display_price ?? item.price);\n\t\tlet bundleTotal = bundlePrice * Number.parseFloat(item.quantity);\n\t\tconst subItems = DefaultCart.contents().filter(cartItem => cartItem.bundled_by === item.item_key);\n\t\tsubItems.forEach((subItem: WCCartItem) => {\n\t\t\tif (bundlePrice > 0) {\n\t\t\t\tconst subItemPrice: number = Number.parseFloat(subItem.display_price ?? subItem.price);\n\t\t\t\tbundleTotal += subItemPrice * Number.parseFloat(subItem.quantity);\n\t\t\t}\n\t\t});\n\t\treturn `${formatCurrencyString(bundleTotal)}`;\n\t}\n\n\tif (item.is_part_of_bundle) {\n\t\treturn `${formatCurrencyString(Number.parseFloat(item.display_price ?? item.price))}/${getLocaleText('each')}`;\n\t}\n\n\treturn `${formatCurrencyString(Number.parseFloat(item.display_price ?? item.price) * cartItemQuantity(item))}`;\n}\n\nexport function cartItemVariationHTML(item: WCCartItem) {\n\tif (item.formatted_item_data) {\n\t\treturn `${metaDataRowsHTML(item)}${formattedItemDataHTMLTemplate(item)}`;\n\t}\n\n\tlet variationRowHTML = '';\n\n\tif (!item.attributes) {\n\t\treturn variationRowHTML;\n\t}\n\n\tconst keys = Object.keys(item.attributes);\n\tfor (const key of keys) {\n\t\tconst formattedKey = capitalizeFirstLetter(\n\t\t\tkey\n\t\t\t\t.replace('attribute_', '')\n\t\t\t\t.replace('pa_', '')\n\t\t\t\t.replace(/-/g, ' '),\n\t\t);\n\t\tconst formattedValue = String(item.attributes[key]).toUpperCase();\n\t\tvariationRowHTML += `<dt>${formattedKey}: </dt><dd>${formattedValue}</dd>`;\n\t}\n\n\treturn `${metaDataRowsHTML(item)}<dl>${variationRowHTML}</dl>`;\n}\n\nfunction metaDataRowsHTML(item: WCCartItem) {\n\tif (!item.meta_data || Object.entries(item.meta_data).length === 0) {\n\t\treturn '';\n\t}\n\n\tlet html = '';\n\tfor (const meta of item.meta_data) {\n\t\tconst keyText = capitalizeFirstLetter(meta.key.replace(/_/g, ' '));\n\t\thtml += `<dt>${keyText}: </dt><dd>${meta.value || '(none)'}</dd>`;\n\t}\n\n\treturn `<dl>${html}</dl>`;\n}\n\nfunction formattedItemDataHTMLTemplate(item: WCCartItem) {\n\tif (!item.formatted_item_data) {\n\t\treturn '';\n\t}\n\n\treturn item.formatted_item_data.replace(/&nbsp;/g, '');\n}\n\ntype AddToCartOptions = {\n\tvariationId?: number;\n\tvariationAttributes?: Array<[name: string, value: string]>;\n};\nasync function addProductToCart(productId: number, quantity = 1, options?: AddToCartOptions): Promise<boolean> {\n\tconst addToCartURL = Feature.metadata<string>(FeatureFlag.EXPRESS_CHECKOUT, 'add_to_cart_url');\n\n\tif (!addToCartURL) {\n\t\treturn false;\n\t}\n\n\tconst formData = new FormData();\n\tformData.set('add-to-cart', String(productId));\n\tformData.set('quantity', String(quantity));\n\n\tif (options?.variationAttributes) {\n\t\tformData.set('product_id', String(productId));\n\t\tformData.set('variation_id', String(options?.variationId ?? productId));\n\n\t\tfor (const [name, value] of options.variationAttributes) {\n\t\t\tformData.set(`${name}`, value);\n\t\t}\n\t}\n\n\tconst response = await fetch(addToCartURL, {\n\t\tmethod: 'POST',\n\t\theaders: {Accept: 'application/json'},\n\t\tbody: formData,\n\t});\n\n\tif (!response.ok) {\n\t\treturn false;\n\t}\n\n\treturn true;\n}\n\nexport {\n\taddProductToCart,\n};\n","import {MerchantConfiguration} from '../reducers/merchantConfigurationReducer';\n\n/**\n * Creates a formatted string that includes the beginning and end\n * currency symbols along with any needed decimal and thousands\n * separator symbols.\n *\n * @example // Example assuming USD currency context:\n *  formatCurrencyString(\"5\")   // returns \"$5.00\"\n *  formatCurrencyString(\"3.7\") // returns \"$3.70\"\n */\nexport function formatCurrencyString(cost: number) {\n\tconst {symbol, position} = MerchantConfiguration.currency.configuration();\n\n\tif (typeof cost !== 'number') {\n\t\tcost = 0;\n\t}\n\n\tlet formattedCurrency = '';\n\tif (position === 'left' || position === 'left_space') {\n\t\tlet negSymbol = '';\n\t\tlet formattedCost = formatCostString(cost);\n\t\tif (cost < 0) {\n\t\t\tnegSymbol = '−';\n\t\t\tformattedCost = formatCostString(Math.abs(cost));\n\t\t}\n\n\t\tformattedCurrency = `${negSymbol}${symbol}${position === 'left_space' ? ' ' : ''}${formattedCost}`;\n\t} else {\n\t\tformattedCurrency = `${formatCostString(cost)}${position === 'right_space' ? ' ' : ''}${symbol}`;\n\t}\n\n\treturn formattedCurrency;\n}\n/**\n * Creates a formatted string that includes the decimal and\n * thousands separator symbols to fixed decimal length.\n *\n * @example // Example assuming USD currency context:\n *  formatCostString(\"5\")   // returns \"5.00\"\n *  formatCostString(\"3.7\") // returns \"3.70\"\n */\n\n// eslint-disable-next-line complexity\nexport function formatCostString(cost: number): string {\n\tconst {code, thousands_separator: thousandsSeparator, decimal_separator: decimalSeparator, rounding, number_of_decimals: decimals} = MerchantConfiguration.currency.configuration();\n\n\tif (typeof cost !== 'number') {\n\t\tcost = 0;\n\t}\n\n\tif (code === 'JPY' || code === 'HUF') {\n\t\treturn cost.toString();\n\t}\n\n\t// We would prefer to always default to 2 decimal points event if the store sets decimal point to 0\n\tconst numberOfDecimals = decimals || 2;\n\n\tswitch (rounding) {\n\t\tcase 'up':\n\t\t\tswitch (numberOfDecimals) {\n\t\t\t\tcase 0:\n\t\t\t\t\tcost = Math.ceil(cost);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\t\tcost = Math.ceil(cost * 10) / 10;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tcost = Math.ceil(cost * 100) / 100;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tcost = Math.ceil(cost * 1000) / 1000;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tcost = Math.ceil(cost);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tbreak;\n\t\tcase 'down':\n\t\t\tswitch (numberOfDecimals) {\n\t\t\t\tcase 0:\n\t\t\t\t\tcost = Math.floor(cost);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\t\tcost = Math.floor(cost * 10) / 10;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tcost = Math.floor(cost * 100) / 100;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tcost = Math.floor(cost * 1000) / 1000;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tcost = Math.floor(cost);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tbreak;\n\t\tcase 'nearest':\n\t\t\t// In the future support may need added for rounding to a specific 0.50, 0.10 type situation. That would go here.\n\t\t\tswitch (numberOfDecimals) {\n\t\t\t\tcase 0:\n\t\t\t\t\tcost = Math.round(cost);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\t\tcost = Math.round(cost * 10) / 10;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tcost = Math.round(cost * 100) / 100;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tcost = Math.round(cost * 1000) / 1000;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tcost = Math.round(cost);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\t// This is to make sure if rounding is disabled and decimals are set to zero that the decimals are cut off because when\n\t// decimal length is zero we actually render 3 decimal points.\n\tcost = Number.parseFloat(cost.toFixed(decimals));\n\n\tlet formattedPrice = '';\n\ttry {\n\t\tconst currencySplit = cost.toFixed(numberOfDecimals).split('.');\n\t\tlet dollarAmount = currencySplit[0];\n\t\tconst centsAmount = currencySplit[1] ?? '';\n\n\t\t// We reverse the string because we want to chunk numbers from back of  the string and not front. Eases the operation of chunking.\n\t\tconst rev = currencySplit?.[0]?.split('').reverse().join('') ?? '';\n\t\tconst revFormat = rev.match(/.{1,3}/g)?.join(thousandsSeparator) ?? '';\n\t\tdollarAmount = revFormat.split('').reverse().join('');\n\t\tformattedPrice += dollarAmount;\n\t\tif (centsAmount !== '') {\n\t\t\tformattedPrice += decimalSeparator + centsAmount;\n\t\t}\n\n\t\treturn formattedPrice;\n\t} catch {\n\t\treturn cost.toFixed(decimals);\n\t}\n}\n","function debounce<TFunc extends Function>(this: unknown, func: TFunc, timeout = 300, abortController?: DebounceAbortController) {\n\tlet timer: NodeJS.Timeout | undefined;\n\n\tabortController?.onAbort(() => {\n\t\tif (timer) {\n\t\t\tclearTimeout(timer);\n\t\t\ttimer = undefined;\n\t\t}\n\t});\n\n\treturn (...args: unknown[]) => {\n\t\tclearTimeout(timer);\n\t\ttimer = setTimeout(() => {\n\t\t\ttimer = undefined;\n\t\t\tfunc.apply(this, args);\n\t\t}, timeout);\n\t};\n}\n\nclass DebounceAbortController {\n\tprivate readonly eventTarget: EventTarget;\n\n\tconstructor() {\n\t\t// Old browsers do not support EventTarget as a stand alone class. We\n\t\t// fallback to using a document fragment which implements the same\n\t\t// interface.\n\t\tif (window['EventTarget']) {\n\t\t\tthis.eventTarget = new EventTarget();\n\t\t} else {\n\t\t\tthis.eventTarget = document.createDocumentFragment();\n\t\t}\n\t}\n\n\tpublic abort(): void {\n\t\tthis.eventTarget.dispatchEvent(new Event('abort'));\n\t}\n\n\tpublic onAbort(listener: () => void): void {\n\t\tthis.eventTarget.addEventListener('abort', listener);\n\t}\n}\n\nexport {\n\tdebounce,\n\tDebounceAbortController,\n};\n","import {Environment} from '../reducers/environmentReducer';\n\n/**\n * If the environment language is English or the key is not found,\n * the key is returned. Otherwise, the key's translation\n * in the environment language is returned.\n */\nexport function getLocaleText(key: string): string {\n\tconst translatedModalTerms = Environment.translated_modal_terms();\n\n\t// eslint-disable-next-line @typescript-eslint/prefer-nullish-coalescing\n\treturn translatedModalTerms?.[key] || key;\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \"-\" + {\"318\":\"507c0de5c9a4138c7af9\",\"669\":\"b291e10503644007c50b\",\"795\":\"a4cf5182b1bccb3916ce\",\"796\":\"083b80526ab8dbd33d83\",\"820\":\"e2a369801a10dbba1c08\"}[chunkId] + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/wp-content/plugins/peachpay-for-woocommerce/public/dist/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t748: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkpeachpay_for_woocommerce\"] = self[\"webpackChunkpeachpay_for_woocommerce\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","var global =\n  (typeof globalThis !== 'undefined' && globalThis) ||\n  (typeof self !== 'undefined' && self) ||\n  (typeof global !== 'undefined' && global)\n\nvar support = {\n  searchParams: 'URLSearchParams' in global,\n  iterable: 'Symbol' in global && 'iterator' in Symbol,\n  blob:\n    'FileReader' in global &&\n    'Blob' in global &&\n    (function() {\n      try {\n        new Blob()\n        return true\n      } catch (e) {\n        return false\n      }\n    })(),\n  formData: 'FormData' in global,\n  arrayBuffer: 'ArrayBuffer' in global\n}\n\nfunction isDataView(obj) {\n  return obj && DataView.prototype.isPrototypeOf(obj)\n}\n\nif (support.arrayBuffer) {\n  var viewClasses = [\n    '[object Int8Array]',\n    '[object Uint8Array]',\n    '[object Uint8ClampedArray]',\n    '[object Int16Array]',\n    '[object Uint16Array]',\n    '[object Int32Array]',\n    '[object Uint32Array]',\n    '[object Float32Array]',\n    '[object Float64Array]'\n  ]\n\n  var isArrayBufferView =\n    ArrayBuffer.isView ||\n    function(obj) {\n      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n    }\n}\n\nfunction normalizeName(name) {\n  if (typeof name !== 'string') {\n    name = String(name)\n  }\n  if (/[^a-z0-9\\-#$%&'*+.^_`|~!]/i.test(name) || name === '') {\n    throw new TypeError('Invalid character in header field name: \"' + name + '\"')\n  }\n  return name.toLowerCase()\n}\n\nfunction normalizeValue(value) {\n  if (typeof value !== 'string') {\n    value = String(value)\n  }\n  return value\n}\n\n// Build a destructive iterator for the value list\nfunction iteratorFor(items) {\n  var iterator = {\n    next: function() {\n      var value = items.shift()\n      return {done: value === undefined, value: value}\n    }\n  }\n\n  if (support.iterable) {\n    iterator[Symbol.iterator] = function() {\n      return iterator\n    }\n  }\n\n  return iterator\n}\n\nexport function Headers(headers) {\n  this.map = {}\n\n  if (headers instanceof Headers) {\n    headers.forEach(function(value, name) {\n      this.append(name, value)\n    }, this)\n  } else if (Array.isArray(headers)) {\n    headers.forEach(function(header) {\n      this.append(header[0], header[1])\n    }, this)\n  } else if (headers) {\n    Object.getOwnPropertyNames(headers).forEach(function(name) {\n      this.append(name, headers[name])\n    }, this)\n  }\n}\n\nHeaders.prototype.append = function(name, value) {\n  name = normalizeName(name)\n  value = normalizeValue(value)\n  var oldValue = this.map[name]\n  this.map[name] = oldValue ? oldValue + ', ' + value : value\n}\n\nHeaders.prototype['delete'] = function(name) {\n  delete this.map[normalizeName(name)]\n}\n\nHeaders.prototype.get = function(name) {\n  name = normalizeName(name)\n  return this.has(name) ? this.map[name] : null\n}\n\nHeaders.prototype.has = function(name) {\n  return this.map.hasOwnProperty(normalizeName(name))\n}\n\nHeaders.prototype.set = function(name, value) {\n  this.map[normalizeName(name)] = normalizeValue(value)\n}\n\nHeaders.prototype.forEach = function(callback, thisArg) {\n  for (var name in this.map) {\n    if (this.map.hasOwnProperty(name)) {\n      callback.call(thisArg, this.map[name], name, this)\n    }\n  }\n}\n\nHeaders.prototype.keys = function() {\n  var items = []\n  this.forEach(function(value, name) {\n    items.push(name)\n  })\n  return iteratorFor(items)\n}\n\nHeaders.prototype.values = function() {\n  var items = []\n  this.forEach(function(value) {\n    items.push(value)\n  })\n  return iteratorFor(items)\n}\n\nHeaders.prototype.entries = function() {\n  var items = []\n  this.forEach(function(value, name) {\n    items.push([name, value])\n  })\n  return iteratorFor(items)\n}\n\nif (support.iterable) {\n  Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n}\n\nfunction consumed(body) {\n  if (body.bodyUsed) {\n    return Promise.reject(new TypeError('Already read'))\n  }\n  body.bodyUsed = true\n}\n\nfunction fileReaderReady(reader) {\n  return new Promise(function(resolve, reject) {\n    reader.onload = function() {\n      resolve(reader.result)\n    }\n    reader.onerror = function() {\n      reject(reader.error)\n    }\n  })\n}\n\nfunction readBlobAsArrayBuffer(blob) {\n  var reader = new FileReader()\n  var promise = fileReaderReady(reader)\n  reader.readAsArrayBuffer(blob)\n  return promise\n}\n\nfunction readBlobAsText(blob) {\n  var reader = new FileReader()\n  var promise = fileReaderReady(reader)\n  reader.readAsText(blob)\n  return promise\n}\n\nfunction readArrayBufferAsText(buf) {\n  var view = new Uint8Array(buf)\n  var chars = new Array(view.length)\n\n  for (var i = 0; i < view.length; i++) {\n    chars[i] = String.fromCharCode(view[i])\n  }\n  return chars.join('')\n}\n\nfunction bufferClone(buf) {\n  if (buf.slice) {\n    return buf.slice(0)\n  } else {\n    var view = new Uint8Array(buf.byteLength)\n    view.set(new Uint8Array(buf))\n    return view.buffer\n  }\n}\n\nfunction Body() {\n  this.bodyUsed = false\n\n  this._initBody = function(body) {\n    /*\n      fetch-mock wraps the Response object in an ES6 Proxy to\n      provide useful test harness features such as flush. However, on\n      ES5 browsers without fetch or Proxy support pollyfills must be used;\n      the proxy-pollyfill is unable to proxy an attribute unless it exists\n      on the object before the Proxy is created. This change ensures\n      Response.bodyUsed exists on the instance, while maintaining the\n      semantic of setting Request.bodyUsed in the constructor before\n      _initBody is called.\n    */\n    this.bodyUsed = this.bodyUsed\n    this._bodyInit = body\n    if (!body) {\n      this._bodyText = ''\n    } else if (typeof body === 'string') {\n      this._bodyText = body\n    } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n      this._bodyBlob = body\n    } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n      this._bodyFormData = body\n    } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n      this._bodyText = body.toString()\n    } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n      this._bodyArrayBuffer = bufferClone(body.buffer)\n      // IE 10-11 can't handle a DataView body.\n      this._bodyInit = new Blob([this._bodyArrayBuffer])\n    } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n      this._bodyArrayBuffer = bufferClone(body)\n    } else {\n      this._bodyText = body = Object.prototype.toString.call(body)\n    }\n\n    if (!this.headers.get('content-type')) {\n      if (typeof body === 'string') {\n        this.headers.set('content-type', 'text/plain;charset=UTF-8')\n      } else if (this._bodyBlob && this._bodyBlob.type) {\n        this.headers.set('content-type', this._bodyBlob.type)\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n      }\n    }\n  }\n\n  if (support.blob) {\n    this.blob = function() {\n      var rejected = consumed(this)\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return Promise.resolve(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as blob')\n      } else {\n        return Promise.resolve(new Blob([this._bodyText]))\n      }\n    }\n\n    this.arrayBuffer = function() {\n      if (this._bodyArrayBuffer) {\n        var isConsumed = consumed(this)\n        if (isConsumed) {\n          return isConsumed\n        }\n        if (ArrayBuffer.isView(this._bodyArrayBuffer)) {\n          return Promise.resolve(\n            this._bodyArrayBuffer.buffer.slice(\n              this._bodyArrayBuffer.byteOffset,\n              this._bodyArrayBuffer.byteOffset + this._bodyArrayBuffer.byteLength\n            )\n          )\n        } else {\n          return Promise.resolve(this._bodyArrayBuffer)\n        }\n      } else {\n        return this.blob().then(readBlobAsArrayBuffer)\n      }\n    }\n  }\n\n  this.text = function() {\n    var rejected = consumed(this)\n    if (rejected) {\n      return rejected\n    }\n\n    if (this._bodyBlob) {\n      return readBlobAsText(this._bodyBlob)\n    } else if (this._bodyArrayBuffer) {\n      return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n    } else if (this._bodyFormData) {\n      throw new Error('could not read FormData body as text')\n    } else {\n      return Promise.resolve(this._bodyText)\n    }\n  }\n\n  if (support.formData) {\n    this.formData = function() {\n      return this.text().then(decode)\n    }\n  }\n\n  this.json = function() {\n    return this.text().then(JSON.parse)\n  }\n\n  return this\n}\n\n// HTTP methods whose capitalization should be normalized\nvar methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\nfunction normalizeMethod(method) {\n  var upcased = method.toUpperCase()\n  return methods.indexOf(upcased) > -1 ? upcased : method\n}\n\nexport function Request(input, options) {\n  if (!(this instanceof Request)) {\n    throw new TypeError('Please use the \"new\" operator, this DOM object constructor cannot be called as a function.')\n  }\n\n  options = options || {}\n  var body = options.body\n\n  if (input instanceof Request) {\n    if (input.bodyUsed) {\n      throw new TypeError('Already read')\n    }\n    this.url = input.url\n    this.credentials = input.credentials\n    if (!options.headers) {\n      this.headers = new Headers(input.headers)\n    }\n    this.method = input.method\n    this.mode = input.mode\n    this.signal = input.signal\n    if (!body && input._bodyInit != null) {\n      body = input._bodyInit\n      input.bodyUsed = true\n    }\n  } else {\n    this.url = String(input)\n  }\n\n  this.credentials = options.credentials || this.credentials || 'same-origin'\n  if (options.headers || !this.headers) {\n    this.headers = new Headers(options.headers)\n  }\n  this.method = normalizeMethod(options.method || this.method || 'GET')\n  this.mode = options.mode || this.mode || null\n  this.signal = options.signal || this.signal\n  this.referrer = null\n\n  if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n    throw new TypeError('Body not allowed for GET or HEAD requests')\n  }\n  this._initBody(body)\n\n  if (this.method === 'GET' || this.method === 'HEAD') {\n    if (options.cache === 'no-store' || options.cache === 'no-cache') {\n      // Search for a '_' parameter in the query string\n      var reParamSearch = /([?&])_=[^&]*/\n      if (reParamSearch.test(this.url)) {\n        // If it already exists then set the value with the current time\n        this.url = this.url.replace(reParamSearch, '$1_=' + new Date().getTime())\n      } else {\n        // Otherwise add a new '_' parameter to the end with the current time\n        var reQueryString = /\\?/\n        this.url += (reQueryString.test(this.url) ? '&' : '?') + '_=' + new Date().getTime()\n      }\n    }\n  }\n}\n\nRequest.prototype.clone = function() {\n  return new Request(this, {body: this._bodyInit})\n}\n\nfunction decode(body) {\n  var form = new FormData()\n  body\n    .trim()\n    .split('&')\n    .forEach(function(bytes) {\n      if (bytes) {\n        var split = bytes.split('=')\n        var name = split.shift().replace(/\\+/g, ' ')\n        var value = split.join('=').replace(/\\+/g, ' ')\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\n      }\n    })\n  return form\n}\n\nfunction parseHeaders(rawHeaders) {\n  var headers = new Headers()\n  // Replace instances of \\r\\n and \\n followed by at least one space or horizontal tab with a space\n  // https://tools.ietf.org/html/rfc7230#section-3.2\n  var preProcessedHeaders = rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ')\n  // Avoiding split via regex to work around a common IE11 bug with the core-js 3.6.0 regex polyfill\n  // https://github.com/github/fetch/issues/748\n  // https://github.com/zloirock/core-js/issues/751\n  preProcessedHeaders\n    .split('\\r')\n    .map(function(header) {\n      return header.indexOf('\\n') === 0 ? header.substr(1, header.length) : header\n    })\n    .forEach(function(line) {\n      var parts = line.split(':')\n      var key = parts.shift().trim()\n      if (key) {\n        var value = parts.join(':').trim()\n        headers.append(key, value)\n      }\n    })\n  return headers\n}\n\nBody.call(Request.prototype)\n\nexport function Response(bodyInit, options) {\n  if (!(this instanceof Response)) {\n    throw new TypeError('Please use the \"new\" operator, this DOM object constructor cannot be called as a function.')\n  }\n  if (!options) {\n    options = {}\n  }\n\n  this.type = 'default'\n  this.status = options.status === undefined ? 200 : options.status\n  this.ok = this.status >= 200 && this.status < 300\n  this.statusText = options.statusText === undefined ? '' : '' + options.statusText\n  this.headers = new Headers(options.headers)\n  this.url = options.url || ''\n  this._initBody(bodyInit)\n}\n\nBody.call(Response.prototype)\n\nResponse.prototype.clone = function() {\n  return new Response(this._bodyInit, {\n    status: this.status,\n    statusText: this.statusText,\n    headers: new Headers(this.headers),\n    url: this.url\n  })\n}\n\nResponse.error = function() {\n  var response = new Response(null, {status: 0, statusText: ''})\n  response.type = 'error'\n  return response\n}\n\nvar redirectStatuses = [301, 302, 303, 307, 308]\n\nResponse.redirect = function(url, status) {\n  if (redirectStatuses.indexOf(status) === -1) {\n    throw new RangeError('Invalid status code')\n  }\n\n  return new Response(null, {status: status, headers: {location: url}})\n}\n\nexport var DOMException = global.DOMException\ntry {\n  new DOMException()\n} catch (err) {\n  DOMException = function(message, name) {\n    this.message = message\n    this.name = name\n    var error = Error(message)\n    this.stack = error.stack\n  }\n  DOMException.prototype = Object.create(Error.prototype)\n  DOMException.prototype.constructor = DOMException\n}\n\nexport function fetch(input, init) {\n  return new Promise(function(resolve, reject) {\n    var request = new Request(input, init)\n\n    if (request.signal && request.signal.aborted) {\n      return reject(new DOMException('Aborted', 'AbortError'))\n    }\n\n    var xhr = new XMLHttpRequest()\n\n    function abortXhr() {\n      xhr.abort()\n    }\n\n    xhr.onload = function() {\n      var options = {\n        status: xhr.status,\n        statusText: xhr.statusText,\n        headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n      }\n      options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL')\n      var body = 'response' in xhr ? xhr.response : xhr.responseText\n      setTimeout(function() {\n        resolve(new Response(body, options))\n      }, 0)\n    }\n\n    xhr.onerror = function() {\n      setTimeout(function() {\n        reject(new TypeError('Network request failed'))\n      }, 0)\n    }\n\n    xhr.ontimeout = function() {\n      setTimeout(function() {\n        reject(new TypeError('Network request failed'))\n      }, 0)\n    }\n\n    xhr.onabort = function() {\n      setTimeout(function() {\n        reject(new DOMException('Aborted', 'AbortError'))\n      }, 0)\n    }\n\n    function fixUrl(url) {\n      try {\n        return url === '' && global.location.href ? global.location.href : url\n      } catch (e) {\n        return url\n      }\n    }\n\n    xhr.open(request.method, fixUrl(request.url), true)\n\n    if (request.credentials === 'include') {\n      xhr.withCredentials = true\n    } else if (request.credentials === 'omit') {\n      xhr.withCredentials = false\n    }\n\n    if ('responseType' in xhr) {\n      if (support.blob) {\n        xhr.responseType = 'blob'\n      } else if (\n        support.arrayBuffer &&\n        request.headers.get('Content-Type') &&\n        request.headers.get('Content-Type').indexOf('application/octet-stream') !== -1\n      ) {\n        xhr.responseType = 'arraybuffer'\n      }\n    }\n\n    if (init && typeof init.headers === 'object' && !(init.headers instanceof Headers)) {\n      Object.getOwnPropertyNames(init.headers).forEach(function(name) {\n        xhr.setRequestHeader(name, normalizeValue(init.headers[name]))\n      })\n    } else {\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value)\n      })\n    }\n\n    if (request.signal) {\n      request.signal.addEventListener('abort', abortXhr)\n\n      xhr.onreadystatechange = function() {\n        // DONE (success or failure)\n        if (xhr.readyState === 4) {\n          request.signal.removeEventListener('abort', abortXhr)\n        }\n      }\n    }\n\n    xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n  })\n}\n\nfetch.polyfill = true\n\nif (!global.fetch) {\n  global.fetch = fetch\n  global.Headers = Headers\n  global.Request = Request\n  global.Response = Response\n}\n","/*! formdata-polyfill. MIT License. Jimmy W?rting <https://jimmy.warting.se/opensource> */\n;(function(){var h;function l(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}var m=\"function\"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};\nfunction n(a){a=[\"object\"==typeof globalThis&&globalThis,a,\"object\"==typeof window&&window,\"object\"==typeof self&&self,\"object\"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error(\"Cannot find global object\");}var q=n(this);function r(a,b){if(b)a:{var c=q;a=a.split(\".\");for(var d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))break a;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&m(c,a,{configurable:!0,writable:!0,value:b})}}\nr(\"Symbol\",function(a){function b(f){if(this instanceof b)throw new TypeError(\"Symbol is not a constructor\");return new c(d+(f||\"\")+\"_\"+e++,f)}function c(f,g){this.A=f;m(this,\"description\",{configurable:!0,writable:!0,value:g})}if(a)return a;c.prototype.toString=function(){return this.A};var d=\"jscomp_symbol_\"+(1E9*Math.random()>>>0)+\"_\",e=0;return b});\nr(\"Symbol.iterator\",function(a){if(a)return a;a=Symbol(\"Symbol.iterator\");for(var b=\"Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array\".split(\" \"),c=0;c<b.length;c++){var d=q[b[c]];\"function\"===typeof d&&\"function\"!=typeof d.prototype[a]&&m(d.prototype,a,{configurable:!0,writable:!0,value:function(){return u(l(this))}})}return a});function u(a){a={next:a};a[Symbol.iterator]=function(){return this};return a}\nfunction v(a){var b=\"undefined\"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):{next:l(a)}}var w;if(\"function\"==typeof Object.setPrototypeOf)w=Object.setPrototypeOf;else{var y;a:{var z={a:!0},A={};try{A.__proto__=z;y=A.a;break a}catch(a){}y=!1}w=y?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+\" is not extensible\");return a}:null}var B=w;function C(){this.m=!1;this.j=null;this.v=void 0;this.h=1;this.u=this.C=0;this.l=null}\nfunction D(a){if(a.m)throw new TypeError(\"Generator is already running\");a.m=!0}C.prototype.o=function(a){this.v=a};C.prototype.s=function(a){this.l={D:a,F:!0};this.h=this.C||this.u};C.prototype.return=function(a){this.l={return:a};this.h=this.u};function E(a,b){a.h=3;return{value:b}}function F(a){this.g=new C;this.G=a}F.prototype.o=function(a){D(this.g);if(this.g.j)return G(this,this.g.j.next,a,this.g.o);this.g.o(a);return H(this)};\nfunction I(a,b){D(a.g);var c=a.g.j;if(c)return G(a,\"return\"in c?c[\"return\"]:function(d){return{value:d,done:!0}},b,a.g.return);a.g.return(b);return H(a)}F.prototype.s=function(a){D(this.g);if(this.g.j)return G(this,this.g.j[\"throw\"],a,this.g.o);this.g.s(a);return H(this)};\nfunction G(a,b,c,d){try{var e=b.call(a.g.j,c);if(!(e instanceof Object))throw new TypeError(\"Iterator result \"+e+\" is not an object\");if(!e.done)return a.g.m=!1,e;var f=e.value}catch(g){return a.g.j=null,a.g.s(g),H(a)}a.g.j=null;d.call(a.g,f);return H(a)}function H(a){for(;a.g.h;)try{var b=a.G(a.g);if(b)return a.g.m=!1,{value:b.value,done:!1}}catch(c){a.g.v=void 0,a.g.s(c)}a.g.m=!1;if(a.g.l){b=a.g.l;a.g.l=null;if(b.F)throw b.D;return{value:b.return,done:!0}}return{value:void 0,done:!0}}\nfunction J(a){this.next=function(b){return a.o(b)};this.throw=function(b){return a.s(b)};this.return=function(b){return I(a,b)};this[Symbol.iterator]=function(){return this}}function K(a,b){b=new J(new F(b));B&&a.prototype&&B(b,a.prototype);return b}function L(a,b){a instanceof String&&(a+=\"\");var c=0,d=!1,e={next:function(){if(!d&&c<a.length){var f=c++;return{value:b(f,a[f]),done:!1}}d=!0;return{done:!0,value:void 0}}};e[Symbol.iterator]=function(){return e};return e}\nr(\"Array.prototype.entries\",function(a){return a?a:function(){return L(this,function(b,c){return[b,c]})}});\nif(\"undefined\"!==typeof Blob&&(\"undefined\"===typeof FormData||!FormData.prototype.keys)){var M=function(a,b){for(var c=0;c<a.length;c++)b(a[c])},N=function(a){return a.replace(/\\r?\\n|\\r/g,\"\\r\\n\")},O=function(a,b,c){if(b instanceof Blob){c=void 0!==c?String(c+\"\"):\"string\"===typeof b.name?b.name:\"blob\";if(b.name!==c||\"[object Blob]\"===Object.prototype.toString.call(b))b=new File([b],c);return[String(a),b]}return[String(a),String(b)]},P=function(a,b){if(a.length<b)throw new TypeError(b+\" argument required, but only \"+\na.length+\" present.\");},Q=\"object\"===typeof globalThis?globalThis:\"object\"===typeof window?window:\"object\"===typeof self?self:this,R=Q.FormData,S=Q.XMLHttpRequest&&Q.XMLHttpRequest.prototype.send,T=Q.Request&&Q.fetch,U=Q.navigator&&Q.navigator.sendBeacon,V=Q.Element&&Q.Element.prototype,W=Q.Symbol&&Symbol.toStringTag;W&&(Blob.prototype[W]||(Blob.prototype[W]=\"Blob\"),\"File\"in Q&&!File.prototype[W]&&(File.prototype[W]=\"File\"));try{new File([],\"\")}catch(a){Q.File=function(b,c,d){b=new Blob(b,d||{});\nObject.defineProperties(b,{name:{value:c},lastModified:{value:+(d&&void 0!==d.lastModified?new Date(d.lastModified):new Date)},toString:{value:function(){return\"[object File]\"}}});W&&Object.defineProperty(b,W,{value:\"File\"});return b}}var escape=function(a){return a.replace(/\\n/g,\"%0A\").replace(/\\r/g,\"%0D\").replace(/\"/g,\"%22\")},X=function(a){this.i=[];var b=this;a&&M(a.elements,function(c){if(c.name&&!c.disabled&&\"submit\"!==c.type&&\"button\"!==c.type&&!c.matches(\"form fieldset[disabled] *\"))if(\"file\"===\nc.type){var d=c.files&&c.files.length?c.files:[new File([],\"\",{type:\"application/octet-stream\"})];M(d,function(e){b.append(c.name,e)})}else\"select-multiple\"===c.type||\"select-one\"===c.type?M(c.options,function(e){!e.disabled&&e.selected&&b.append(c.name,e.value)}):\"checkbox\"===c.type||\"radio\"===c.type?c.checked&&b.append(c.name,c.value):(d=\"textarea\"===c.type?N(c.value):c.value,b.append(c.name,d))})};h=X.prototype;h.append=function(a,b,c){P(arguments,2);this.i.push(O(a,b,c))};h.delete=function(a){P(arguments,\n1);var b=[];a=String(a);M(this.i,function(c){c[0]!==a&&b.push(c)});this.i=b};h.entries=function b(){var c,d=this;return K(b,function(e){1==e.h&&(c=0);if(3!=e.h)return c<d.i.length?e=E(e,d.i[c]):(e.h=0,e=void 0),e;c++;e.h=2})};h.forEach=function(b,c){P(arguments,1);for(var d=v(this),e=d.next();!e.done;e=d.next()){var f=v(e.value);e=f.next().value;f=f.next().value;b.call(c,f,e,this)}};h.get=function(b){P(arguments,1);var c=this.i;b=String(b);for(var d=0;d<c.length;d++)if(c[d][0]===b)return c[d][1];\nreturn null};h.getAll=function(b){P(arguments,1);var c=[];b=String(b);M(this.i,function(d){d[0]===b&&c.push(d[1])});return c};h.has=function(b){P(arguments,1);b=String(b);for(var c=0;c<this.i.length;c++)if(this.i[c][0]===b)return!0;return!1};h.keys=function c(){var d=this,e,f,g,k,p;return K(c,function(t){1==t.h&&(e=v(d),f=e.next());if(3!=t.h){if(f.done){t.h=0;return}g=f.value;k=v(g);p=k.next().value;return E(t,p)}f=e.next();t.h=2})};h.set=function(c,d,e){P(arguments,2);c=String(c);var f=[],g=O(c,\nd,e),k=!0;M(this.i,function(p){p[0]===c?k&&(k=!f.push(g)):f.push(p)});k&&f.push(g);this.i=f};h.values=function d(){var e=this,f,g,k,p,t;return K(d,function(x){1==x.h&&(f=v(e),g=f.next());if(3!=x.h){if(g.done){x.h=0;return}k=g.value;p=v(k);p.next();t=p.next().value;return E(x,t)}g=f.next();x.h=2})};X.prototype._asNative=function(){for(var d=new R,e=v(this),f=e.next();!f.done;f=e.next()){var g=v(f.value);f=g.next().value;g=g.next().value;d.append(f,g)}return d};X.prototype._blob=function(){var d=\"----formdata-polyfill-\"+\nMath.random(),e=[],f=\"--\"+d+'\\r\\nContent-Disposition: form-data; name=\"';this.forEach(function(g,k){return\"string\"==typeof g?e.push(f+escape(N(k))+('\"\\r\\n\\r\\n'+N(g)+\"\\r\\n\")):e.push(f+escape(N(k))+('\"; filename=\"'+escape(g.name)+'\"\\r\\nContent-Type: '+(g.type||\"application/octet-stream\")+\"\\r\\n\\r\\n\"),g,\"\\r\\n\")});e.push(\"--\"+d+\"--\");return new Blob(e,{type:\"multipart/form-data; boundary=\"+d})};X.prototype[Symbol.iterator]=function(){return this.entries()};X.prototype.toString=function(){return\"[object FormData]\"};\nV&&!V.matches&&(V.matches=V.matchesSelector||V.mozMatchesSelector||V.msMatchesSelector||V.oMatchesSelector||V.webkitMatchesSelector||function(d){d=(this.document||this.ownerDocument).querySelectorAll(d);for(var e=d.length;0<=--e&&d.item(e)!==this;);return-1<e});W&&(X.prototype[W]=\"FormData\");if(S){var Y=Q.XMLHttpRequest.prototype.setRequestHeader;Q.XMLHttpRequest.prototype.setRequestHeader=function(d,e){Y.call(this,d,e);\"content-type\"===d.toLowerCase()&&(this.B=!0)};Q.XMLHttpRequest.prototype.send=\nfunction(d){d instanceof X?(d=d._blob(),this.B||this.setRequestHeader(\"Content-Type\",d.type),S.call(this,d)):S.call(this,d)}}T&&(Q.fetch=function(d,e){e&&e.body&&e.body instanceof X&&(e.body=e.body._blob());return T.call(this,d,e)});U&&(Q.navigator.sendBeacon=function(d,e){e instanceof X&&(e=e._asNative());return U.call(this,d,e)});Q.FormData=X};})();\n","/**\r\n * A collection of shims that provide minimal functionality of the ES6 collections.\r\n *\r\n * These implementations are not meant to be used outside of the ResizeObserver\r\n * modules as they cover only a limited range of use cases.\r\n */\r\n/* eslint-disable require-jsdoc, valid-jsdoc */\r\nvar MapShim = (function () {\r\n    if (typeof Map !== 'undefined') {\r\n        return Map;\r\n    }\r\n    /**\r\n     * Returns index in provided array that matches the specified key.\r\n     *\r\n     * @param {Array<Array>} arr\r\n     * @param {*} key\r\n     * @returns {number}\r\n     */\r\n    function getIndex(arr, key) {\r\n        var result = -1;\r\n        arr.some(function (entry, index) {\r\n            if (entry[0] === key) {\r\n                result = index;\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n        return result;\r\n    }\r\n    return /** @class */ (function () {\r\n        function class_1() {\r\n            this.__entries__ = [];\r\n        }\r\n        Object.defineProperty(class_1.prototype, \"size\", {\r\n            /**\r\n             * @returns {boolean}\r\n             */\r\n            get: function () {\r\n                return this.__entries__.length;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        /**\r\n         * @param {*} key\r\n         * @returns {*}\r\n         */\r\n        class_1.prototype.get = function (key) {\r\n            var index = getIndex(this.__entries__, key);\r\n            var entry = this.__entries__[index];\r\n            return entry && entry[1];\r\n        };\r\n        /**\r\n         * @param {*} key\r\n         * @param {*} value\r\n         * @returns {void}\r\n         */\r\n        class_1.prototype.set = function (key, value) {\r\n            var index = getIndex(this.__entries__, key);\r\n            if (~index) {\r\n                this.__entries__[index][1] = value;\r\n            }\r\n            else {\r\n                this.__entries__.push([key, value]);\r\n            }\r\n        };\r\n        /**\r\n         * @param {*} key\r\n         * @returns {void}\r\n         */\r\n        class_1.prototype.delete = function (key) {\r\n            var entries = this.__entries__;\r\n            var index = getIndex(entries, key);\r\n            if (~index) {\r\n                entries.splice(index, 1);\r\n            }\r\n        };\r\n        /**\r\n         * @param {*} key\r\n         * @returns {void}\r\n         */\r\n        class_1.prototype.has = function (key) {\r\n            return !!~getIndex(this.__entries__, key);\r\n        };\r\n        /**\r\n         * @returns {void}\r\n         */\r\n        class_1.prototype.clear = function () {\r\n            this.__entries__.splice(0);\r\n        };\r\n        /**\r\n         * @param {Function} callback\r\n         * @param {*} [ctx=null]\r\n         * @returns {void}\r\n         */\r\n        class_1.prototype.forEach = function (callback, ctx) {\r\n            if (ctx === void 0) { ctx = null; }\r\n            for (var _i = 0, _a = this.__entries__; _i < _a.length; _i++) {\r\n                var entry = _a[_i];\r\n                callback.call(ctx, entry[1], entry[0]);\r\n            }\r\n        };\r\n        return class_1;\r\n    }());\r\n})();\n\n/**\r\n * Detects whether window and document objects are available in current environment.\r\n */\r\nvar isBrowser = typeof window !== 'undefined' && typeof document !== 'undefined' && window.document === document;\n\n// Returns global object of a current environment.\r\nvar global$1 = (function () {\r\n    if (typeof global !== 'undefined' && global.Math === Math) {\r\n        return global;\r\n    }\r\n    if (typeof self !== 'undefined' && self.Math === Math) {\r\n        return self;\r\n    }\r\n    if (typeof window !== 'undefined' && window.Math === Math) {\r\n        return window;\r\n    }\r\n    // eslint-disable-next-line no-new-func\r\n    return Function('return this')();\r\n})();\n\n/**\r\n * A shim for the requestAnimationFrame which falls back to the setTimeout if\r\n * first one is not supported.\r\n *\r\n * @returns {number} Requests' identifier.\r\n */\r\nvar requestAnimationFrame$1 = (function () {\r\n    if (typeof requestAnimationFrame === 'function') {\r\n        // It's required to use a bounded function because IE sometimes throws\r\n        // an \"Invalid calling object\" error if rAF is invoked without the global\r\n        // object on the left hand side.\r\n        return requestAnimationFrame.bind(global$1);\r\n    }\r\n    return function (callback) { return setTimeout(function () { return callback(Date.now()); }, 1000 / 60); };\r\n})();\n\n// Defines minimum timeout before adding a trailing call.\r\nvar trailingTimeout = 2;\r\n/**\r\n * Creates a wrapper function which ensures that provided callback will be\r\n * invoked only once during the specified delay period.\r\n *\r\n * @param {Function} callback - Function to be invoked after the delay period.\r\n * @param {number} delay - Delay after which to invoke callback.\r\n * @returns {Function}\r\n */\r\nfunction throttle (callback, delay) {\r\n    var leadingCall = false, trailingCall = false, lastCallTime = 0;\r\n    /**\r\n     * Invokes the original callback function and schedules new invocation if\r\n     * the \"proxy\" was called during current request.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    function resolvePending() {\r\n        if (leadingCall) {\r\n            leadingCall = false;\r\n            callback();\r\n        }\r\n        if (trailingCall) {\r\n            proxy();\r\n        }\r\n    }\r\n    /**\r\n     * Callback invoked after the specified delay. It will further postpone\r\n     * invocation of the original function delegating it to the\r\n     * requestAnimationFrame.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    function timeoutCallback() {\r\n        requestAnimationFrame$1(resolvePending);\r\n    }\r\n    /**\r\n     * Schedules invocation of the original function.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    function proxy() {\r\n        var timeStamp = Date.now();\r\n        if (leadingCall) {\r\n            // Reject immediately following calls.\r\n            if (timeStamp - lastCallTime < trailingTimeout) {\r\n                return;\r\n            }\r\n            // Schedule new call to be in invoked when the pending one is resolved.\r\n            // This is important for \"transitions\" which never actually start\r\n            // immediately so there is a chance that we might miss one if change\r\n            // happens amids the pending invocation.\r\n            trailingCall = true;\r\n        }\r\n        else {\r\n            leadingCall = true;\r\n            trailingCall = false;\r\n            setTimeout(timeoutCallback, delay);\r\n        }\r\n        lastCallTime = timeStamp;\r\n    }\r\n    return proxy;\r\n}\n\n// Minimum delay before invoking the update of observers.\r\nvar REFRESH_DELAY = 20;\r\n// A list of substrings of CSS properties used to find transition events that\r\n// might affect dimensions of observed elements.\r\nvar transitionKeys = ['top', 'right', 'bottom', 'left', 'width', 'height', 'size', 'weight'];\r\n// Check if MutationObserver is available.\r\nvar mutationObserverSupported = typeof MutationObserver !== 'undefined';\r\n/**\r\n * Singleton controller class which handles updates of ResizeObserver instances.\r\n */\r\nvar ResizeObserverController = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance of ResizeObserverController.\r\n     *\r\n     * @private\r\n     */\r\n    function ResizeObserverController() {\r\n        /**\r\n         * Indicates whether DOM listeners have been added.\r\n         *\r\n         * @private {boolean}\r\n         */\r\n        this.connected_ = false;\r\n        /**\r\n         * Tells that controller has subscribed for Mutation Events.\r\n         *\r\n         * @private {boolean}\r\n         */\r\n        this.mutationEventsAdded_ = false;\r\n        /**\r\n         * Keeps reference to the instance of MutationObserver.\r\n         *\r\n         * @private {MutationObserver}\r\n         */\r\n        this.mutationsObserver_ = null;\r\n        /**\r\n         * A list of connected observers.\r\n         *\r\n         * @private {Array<ResizeObserverSPI>}\r\n         */\r\n        this.observers_ = [];\r\n        this.onTransitionEnd_ = this.onTransitionEnd_.bind(this);\r\n        this.refresh = throttle(this.refresh.bind(this), REFRESH_DELAY);\r\n    }\r\n    /**\r\n     * Adds observer to observers list.\r\n     *\r\n     * @param {ResizeObserverSPI} observer - Observer to be added.\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverController.prototype.addObserver = function (observer) {\r\n        if (!~this.observers_.indexOf(observer)) {\r\n            this.observers_.push(observer);\r\n        }\r\n        // Add listeners if they haven't been added yet.\r\n        if (!this.connected_) {\r\n            this.connect_();\r\n        }\r\n    };\r\n    /**\r\n     * Removes observer from observers list.\r\n     *\r\n     * @param {ResizeObserverSPI} observer - Observer to be removed.\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverController.prototype.removeObserver = function (observer) {\r\n        var observers = this.observers_;\r\n        var index = observers.indexOf(observer);\r\n        // Remove observer if it's present in registry.\r\n        if (~index) {\r\n            observers.splice(index, 1);\r\n        }\r\n        // Remove listeners if controller has no connected observers.\r\n        if (!observers.length && this.connected_) {\r\n            this.disconnect_();\r\n        }\r\n    };\r\n    /**\r\n     * Invokes the update of observers. It will continue running updates insofar\r\n     * it detects changes.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverController.prototype.refresh = function () {\r\n        var changesDetected = this.updateObservers_();\r\n        // Continue running updates if changes have been detected as there might\r\n        // be future ones caused by CSS transitions.\r\n        if (changesDetected) {\r\n            this.refresh();\r\n        }\r\n    };\r\n    /**\r\n     * Updates every observer from observers list and notifies them of queued\r\n     * entries.\r\n     *\r\n     * @private\r\n     * @returns {boolean} Returns \"true\" if any observer has detected changes in\r\n     *      dimensions of it's elements.\r\n     */\r\n    ResizeObserverController.prototype.updateObservers_ = function () {\r\n        // Collect observers that have active observations.\r\n        var activeObservers = this.observers_.filter(function (observer) {\r\n            return observer.gatherActive(), observer.hasActive();\r\n        });\r\n        // Deliver notifications in a separate cycle in order to avoid any\r\n        // collisions between observers, e.g. when multiple instances of\r\n        // ResizeObserver are tracking the same element and the callback of one\r\n        // of them changes content dimensions of the observed target. Sometimes\r\n        // this may result in notifications being blocked for the rest of observers.\r\n        activeObservers.forEach(function (observer) { return observer.broadcastActive(); });\r\n        return activeObservers.length > 0;\r\n    };\r\n    /**\r\n     * Initializes DOM listeners.\r\n     *\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverController.prototype.connect_ = function () {\r\n        // Do nothing if running in a non-browser environment or if listeners\r\n        // have been already added.\r\n        if (!isBrowser || this.connected_) {\r\n            return;\r\n        }\r\n        // Subscription to the \"Transitionend\" event is used as a workaround for\r\n        // delayed transitions. This way it's possible to capture at least the\r\n        // final state of an element.\r\n        document.addEventListener('transitionend', this.onTransitionEnd_);\r\n        window.addEventListener('resize', this.refresh);\r\n        if (mutationObserverSupported) {\r\n            this.mutationsObserver_ = new MutationObserver(this.refresh);\r\n            this.mutationsObserver_.observe(document, {\r\n                attributes: true,\r\n                childList: true,\r\n                characterData: true,\r\n                subtree: true\r\n            });\r\n        }\r\n        else {\r\n            document.addEventListener('DOMSubtreeModified', this.refresh);\r\n            this.mutationEventsAdded_ = true;\r\n        }\r\n        this.connected_ = true;\r\n    };\r\n    /**\r\n     * Removes DOM listeners.\r\n     *\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverController.prototype.disconnect_ = function () {\r\n        // Do nothing if running in a non-browser environment or if listeners\r\n        // have been already removed.\r\n        if (!isBrowser || !this.connected_) {\r\n            return;\r\n        }\r\n        document.removeEventListener('transitionend', this.onTransitionEnd_);\r\n        window.removeEventListener('resize', this.refresh);\r\n        if (this.mutationsObserver_) {\r\n            this.mutationsObserver_.disconnect();\r\n        }\r\n        if (this.mutationEventsAdded_) {\r\n            document.removeEventListener('DOMSubtreeModified', this.refresh);\r\n        }\r\n        this.mutationsObserver_ = null;\r\n        this.mutationEventsAdded_ = false;\r\n        this.connected_ = false;\r\n    };\r\n    /**\r\n     * \"Transitionend\" event handler.\r\n     *\r\n     * @private\r\n     * @param {TransitionEvent} event\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverController.prototype.onTransitionEnd_ = function (_a) {\r\n        var _b = _a.propertyName, propertyName = _b === void 0 ? '' : _b;\r\n        // Detect whether transition may affect dimensions of an element.\r\n        var isReflowProperty = transitionKeys.some(function (key) {\r\n            return !!~propertyName.indexOf(key);\r\n        });\r\n        if (isReflowProperty) {\r\n            this.refresh();\r\n        }\r\n    };\r\n    /**\r\n     * Returns instance of the ResizeObserverController.\r\n     *\r\n     * @returns {ResizeObserverController}\r\n     */\r\n    ResizeObserverController.getInstance = function () {\r\n        if (!this.instance_) {\r\n            this.instance_ = new ResizeObserverController();\r\n        }\r\n        return this.instance_;\r\n    };\r\n    /**\r\n     * Holds reference to the controller's instance.\r\n     *\r\n     * @private {ResizeObserverController}\r\n     */\r\n    ResizeObserverController.instance_ = null;\r\n    return ResizeObserverController;\r\n}());\n\n/**\r\n * Defines non-writable/enumerable properties of the provided target object.\r\n *\r\n * @param {Object} target - Object for which to define properties.\r\n * @param {Object} props - Properties to be defined.\r\n * @returns {Object} Target object.\r\n */\r\nvar defineConfigurable = (function (target, props) {\r\n    for (var _i = 0, _a = Object.keys(props); _i < _a.length; _i++) {\r\n        var key = _a[_i];\r\n        Object.defineProperty(target, key, {\r\n            value: props[key],\r\n            enumerable: false,\r\n            writable: false,\r\n            configurable: true\r\n        });\r\n    }\r\n    return target;\r\n});\n\n/**\r\n * Returns the global object associated with provided element.\r\n *\r\n * @param {Object} target\r\n * @returns {Object}\r\n */\r\nvar getWindowOf = (function (target) {\r\n    // Assume that the element is an instance of Node, which means that it\r\n    // has the \"ownerDocument\" property from which we can retrieve a\r\n    // corresponding global object.\r\n    var ownerGlobal = target && target.ownerDocument && target.ownerDocument.defaultView;\r\n    // Return the local global object if it's not possible extract one from\r\n    // provided element.\r\n    return ownerGlobal || global$1;\r\n});\n\n// Placeholder of an empty content rectangle.\r\nvar emptyRect = createRectInit(0, 0, 0, 0);\r\n/**\r\n * Converts provided string to a number.\r\n *\r\n * @param {number|string} value\r\n * @returns {number}\r\n */\r\nfunction toFloat(value) {\r\n    return parseFloat(value) || 0;\r\n}\r\n/**\r\n * Extracts borders size from provided styles.\r\n *\r\n * @param {CSSStyleDeclaration} styles\r\n * @param {...string} positions - Borders positions (top, right, ...)\r\n * @returns {number}\r\n */\r\nfunction getBordersSize(styles) {\r\n    var positions = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        positions[_i - 1] = arguments[_i];\r\n    }\r\n    return positions.reduce(function (size, position) {\r\n        var value = styles['border-' + position + '-width'];\r\n        return size + toFloat(value);\r\n    }, 0);\r\n}\r\n/**\r\n * Extracts paddings sizes from provided styles.\r\n *\r\n * @param {CSSStyleDeclaration} styles\r\n * @returns {Object} Paddings box.\r\n */\r\nfunction getPaddings(styles) {\r\n    var positions = ['top', 'right', 'bottom', 'left'];\r\n    var paddings = {};\r\n    for (var _i = 0, positions_1 = positions; _i < positions_1.length; _i++) {\r\n        var position = positions_1[_i];\r\n        var value = styles['padding-' + position];\r\n        paddings[position] = toFloat(value);\r\n    }\r\n    return paddings;\r\n}\r\n/**\r\n * Calculates content rectangle of provided SVG element.\r\n *\r\n * @param {SVGGraphicsElement} target - Element content rectangle of which needs\r\n *      to be calculated.\r\n * @returns {DOMRectInit}\r\n */\r\nfunction getSVGContentRect(target) {\r\n    var bbox = target.getBBox();\r\n    return createRectInit(0, 0, bbox.width, bbox.height);\r\n}\r\n/**\r\n * Calculates content rectangle of provided HTMLElement.\r\n *\r\n * @param {HTMLElement} target - Element for which to calculate the content rectangle.\r\n * @returns {DOMRectInit}\r\n */\r\nfunction getHTMLElementContentRect(target) {\r\n    // Client width & height properties can't be\r\n    // used exclusively as they provide rounded values.\r\n    var clientWidth = target.clientWidth, clientHeight = target.clientHeight;\r\n    // By this condition we can catch all non-replaced inline, hidden and\r\n    // detached elements. Though elements with width & height properties less\r\n    // than 0.5 will be discarded as well.\r\n    //\r\n    // Without it we would need to implement separate methods for each of\r\n    // those cases and it's not possible to perform a precise and performance\r\n    // effective test for hidden elements. E.g. even jQuery's ':visible' filter\r\n    // gives wrong results for elements with width & height less than 0.5.\r\n    if (!clientWidth && !clientHeight) {\r\n        return emptyRect;\r\n    }\r\n    var styles = getWindowOf(target).getComputedStyle(target);\r\n    var paddings = getPaddings(styles);\r\n    var horizPad = paddings.left + paddings.right;\r\n    var vertPad = paddings.top + paddings.bottom;\r\n    // Computed styles of width & height are being used because they are the\r\n    // only dimensions available to JS that contain non-rounded values. It could\r\n    // be possible to utilize the getBoundingClientRect if only it's data wasn't\r\n    // affected by CSS transformations let alone paddings, borders and scroll bars.\r\n    var width = toFloat(styles.width), height = toFloat(styles.height);\r\n    // Width & height include paddings and borders when the 'border-box' box\r\n    // model is applied (except for IE).\r\n    if (styles.boxSizing === 'border-box') {\r\n        // Following conditions are required to handle Internet Explorer which\r\n        // doesn't include paddings and borders to computed CSS dimensions.\r\n        //\r\n        // We can say that if CSS dimensions + paddings are equal to the \"client\"\r\n        // properties then it's either IE, and thus we don't need to subtract\r\n        // anything, or an element merely doesn't have paddings/borders styles.\r\n        if (Math.round(width + horizPad) !== clientWidth) {\r\n            width -= getBordersSize(styles, 'left', 'right') + horizPad;\r\n        }\r\n        if (Math.round(height + vertPad) !== clientHeight) {\r\n            height -= getBordersSize(styles, 'top', 'bottom') + vertPad;\r\n        }\r\n    }\r\n    // Following steps can't be applied to the document's root element as its\r\n    // client[Width/Height] properties represent viewport area of the window.\r\n    // Besides, it's as well not necessary as the <html> itself neither has\r\n    // rendered scroll bars nor it can be clipped.\r\n    if (!isDocumentElement(target)) {\r\n        // In some browsers (only in Firefox, actually) CSS width & height\r\n        // include scroll bars size which can be removed at this step as scroll\r\n        // bars are the only difference between rounded dimensions + paddings\r\n        // and \"client\" properties, though that is not always true in Chrome.\r\n        var vertScrollbar = Math.round(width + horizPad) - clientWidth;\r\n        var horizScrollbar = Math.round(height + vertPad) - clientHeight;\r\n        // Chrome has a rather weird rounding of \"client\" properties.\r\n        // E.g. for an element with content width of 314.2px it sometimes gives\r\n        // the client width of 315px and for the width of 314.7px it may give\r\n        // 314px. And it doesn't happen all the time. So just ignore this delta\r\n        // as a non-relevant.\r\n        if (Math.abs(vertScrollbar) !== 1) {\r\n            width -= vertScrollbar;\r\n        }\r\n        if (Math.abs(horizScrollbar) !== 1) {\r\n            height -= horizScrollbar;\r\n        }\r\n    }\r\n    return createRectInit(paddings.left, paddings.top, width, height);\r\n}\r\n/**\r\n * Checks whether provided element is an instance of the SVGGraphicsElement.\r\n *\r\n * @param {Element} target - Element to be checked.\r\n * @returns {boolean}\r\n */\r\nvar isSVGGraphicsElement = (function () {\r\n    // Some browsers, namely IE and Edge, don't have the SVGGraphicsElement\r\n    // interface.\r\n    if (typeof SVGGraphicsElement !== 'undefined') {\r\n        return function (target) { return target instanceof getWindowOf(target).SVGGraphicsElement; };\r\n    }\r\n    // If it's so, then check that element is at least an instance of the\r\n    // SVGElement and that it has the \"getBBox\" method.\r\n    // eslint-disable-next-line no-extra-parens\r\n    return function (target) { return (target instanceof getWindowOf(target).SVGElement &&\r\n        typeof target.getBBox === 'function'); };\r\n})();\r\n/**\r\n * Checks whether provided element is a document element (<html>).\r\n *\r\n * @param {Element} target - Element to be checked.\r\n * @returns {boolean}\r\n */\r\nfunction isDocumentElement(target) {\r\n    return target === getWindowOf(target).document.documentElement;\r\n}\r\n/**\r\n * Calculates an appropriate content rectangle for provided html or svg element.\r\n *\r\n * @param {Element} target - Element content rectangle of which needs to be calculated.\r\n * @returns {DOMRectInit}\r\n */\r\nfunction getContentRect(target) {\r\n    if (!isBrowser) {\r\n        return emptyRect;\r\n    }\r\n    if (isSVGGraphicsElement(target)) {\r\n        return getSVGContentRect(target);\r\n    }\r\n    return getHTMLElementContentRect(target);\r\n}\r\n/**\r\n * Creates rectangle with an interface of the DOMRectReadOnly.\r\n * Spec: https://drafts.fxtf.org/geometry/#domrectreadonly\r\n *\r\n * @param {DOMRectInit} rectInit - Object with rectangle's x/y coordinates and dimensions.\r\n * @returns {DOMRectReadOnly}\r\n */\r\nfunction createReadOnlyRect(_a) {\r\n    var x = _a.x, y = _a.y, width = _a.width, height = _a.height;\r\n    // If DOMRectReadOnly is available use it as a prototype for the rectangle.\r\n    var Constr = typeof DOMRectReadOnly !== 'undefined' ? DOMRectReadOnly : Object;\r\n    var rect = Object.create(Constr.prototype);\r\n    // Rectangle's properties are not writable and non-enumerable.\r\n    defineConfigurable(rect, {\r\n        x: x, y: y, width: width, height: height,\r\n        top: y,\r\n        right: x + width,\r\n        bottom: height + y,\r\n        left: x\r\n    });\r\n    return rect;\r\n}\r\n/**\r\n * Creates DOMRectInit object based on the provided dimensions and the x/y coordinates.\r\n * Spec: https://drafts.fxtf.org/geometry/#dictdef-domrectinit\r\n *\r\n * @param {number} x - X coordinate.\r\n * @param {number} y - Y coordinate.\r\n * @param {number} width - Rectangle's width.\r\n * @param {number} height - Rectangle's height.\r\n * @returns {DOMRectInit}\r\n */\r\nfunction createRectInit(x, y, width, height) {\r\n    return { x: x, y: y, width: width, height: height };\r\n}\n\n/**\r\n * Class that is responsible for computations of the content rectangle of\r\n * provided DOM element and for keeping track of it's changes.\r\n */\r\nvar ResizeObservation = /** @class */ (function () {\r\n    /**\r\n     * Creates an instance of ResizeObservation.\r\n     *\r\n     * @param {Element} target - Element to be observed.\r\n     */\r\n    function ResizeObservation(target) {\r\n        /**\r\n         * Broadcasted width of content rectangle.\r\n         *\r\n         * @type {number}\r\n         */\r\n        this.broadcastWidth = 0;\r\n        /**\r\n         * Broadcasted height of content rectangle.\r\n         *\r\n         * @type {number}\r\n         */\r\n        this.broadcastHeight = 0;\r\n        /**\r\n         * Reference to the last observed content rectangle.\r\n         *\r\n         * @private {DOMRectInit}\r\n         */\r\n        this.contentRect_ = createRectInit(0, 0, 0, 0);\r\n        this.target = target;\r\n    }\r\n    /**\r\n     * Updates content rectangle and tells whether it's width or height properties\r\n     * have changed since the last broadcast.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    ResizeObservation.prototype.isActive = function () {\r\n        var rect = getContentRect(this.target);\r\n        this.contentRect_ = rect;\r\n        return (rect.width !== this.broadcastWidth ||\r\n            rect.height !== this.broadcastHeight);\r\n    };\r\n    /**\r\n     * Updates 'broadcastWidth' and 'broadcastHeight' properties with a data\r\n     * from the corresponding properties of the last observed content rectangle.\r\n     *\r\n     * @returns {DOMRectInit} Last observed content rectangle.\r\n     */\r\n    ResizeObservation.prototype.broadcastRect = function () {\r\n        var rect = this.contentRect_;\r\n        this.broadcastWidth = rect.width;\r\n        this.broadcastHeight = rect.height;\r\n        return rect;\r\n    };\r\n    return ResizeObservation;\r\n}());\n\nvar ResizeObserverEntry = /** @class */ (function () {\r\n    /**\r\n     * Creates an instance of ResizeObserverEntry.\r\n     *\r\n     * @param {Element} target - Element that is being observed.\r\n     * @param {DOMRectInit} rectInit - Data of the element's content rectangle.\r\n     */\r\n    function ResizeObserverEntry(target, rectInit) {\r\n        var contentRect = createReadOnlyRect(rectInit);\r\n        // According to the specification following properties are not writable\r\n        // and are also not enumerable in the native implementation.\r\n        //\r\n        // Property accessors are not being used as they'd require to define a\r\n        // private WeakMap storage which may cause memory leaks in browsers that\r\n        // don't support this type of collections.\r\n        defineConfigurable(this, { target: target, contentRect: contentRect });\r\n    }\r\n    return ResizeObserverEntry;\r\n}());\n\nvar ResizeObserverSPI = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance of ResizeObserver.\r\n     *\r\n     * @param {ResizeObserverCallback} callback - Callback function that is invoked\r\n     *      when one of the observed elements changes it's content dimensions.\r\n     * @param {ResizeObserverController} controller - Controller instance which\r\n     *      is responsible for the updates of observer.\r\n     * @param {ResizeObserver} callbackCtx - Reference to the public\r\n     *      ResizeObserver instance which will be passed to callback function.\r\n     */\r\n    function ResizeObserverSPI(callback, controller, callbackCtx) {\r\n        /**\r\n         * Collection of resize observations that have detected changes in dimensions\r\n         * of elements.\r\n         *\r\n         * @private {Array<ResizeObservation>}\r\n         */\r\n        this.activeObservations_ = [];\r\n        /**\r\n         * Registry of the ResizeObservation instances.\r\n         *\r\n         * @private {Map<Element, ResizeObservation>}\r\n         */\r\n        this.observations_ = new MapShim();\r\n        if (typeof callback !== 'function') {\r\n            throw new TypeError('The callback provided as parameter 1 is not a function.');\r\n        }\r\n        this.callback_ = callback;\r\n        this.controller_ = controller;\r\n        this.callbackCtx_ = callbackCtx;\r\n    }\r\n    /**\r\n     * Starts observing provided element.\r\n     *\r\n     * @param {Element} target - Element to be observed.\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverSPI.prototype.observe = function (target) {\r\n        if (!arguments.length) {\r\n            throw new TypeError('1 argument required, but only 0 present.');\r\n        }\r\n        // Do nothing if current environment doesn't have the Element interface.\r\n        if (typeof Element === 'undefined' || !(Element instanceof Object)) {\r\n            return;\r\n        }\r\n        if (!(target instanceof getWindowOf(target).Element)) {\r\n            throw new TypeError('parameter 1 is not of type \"Element\".');\r\n        }\r\n        var observations = this.observations_;\r\n        // Do nothing if element is already being observed.\r\n        if (observations.has(target)) {\r\n            return;\r\n        }\r\n        observations.set(target, new ResizeObservation(target));\r\n        this.controller_.addObserver(this);\r\n        // Force the update of observations.\r\n        this.controller_.refresh();\r\n    };\r\n    /**\r\n     * Stops observing provided element.\r\n     *\r\n     * @param {Element} target - Element to stop observing.\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverSPI.prototype.unobserve = function (target) {\r\n        if (!arguments.length) {\r\n            throw new TypeError('1 argument required, but only 0 present.');\r\n        }\r\n        // Do nothing if current environment doesn't have the Element interface.\r\n        if (typeof Element === 'undefined' || !(Element instanceof Object)) {\r\n            return;\r\n        }\r\n        if (!(target instanceof getWindowOf(target).Element)) {\r\n            throw new TypeError('parameter 1 is not of type \"Element\".');\r\n        }\r\n        var observations = this.observations_;\r\n        // Do nothing if element is not being observed.\r\n        if (!observations.has(target)) {\r\n            return;\r\n        }\r\n        observations.delete(target);\r\n        if (!observations.size) {\r\n            this.controller_.removeObserver(this);\r\n        }\r\n    };\r\n    /**\r\n     * Stops observing all elements.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverSPI.prototype.disconnect = function () {\r\n        this.clearActive();\r\n        this.observations_.clear();\r\n        this.controller_.removeObserver(this);\r\n    };\r\n    /**\r\n     * Collects observation instances the associated element of which has changed\r\n     * it's content rectangle.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverSPI.prototype.gatherActive = function () {\r\n        var _this = this;\r\n        this.clearActive();\r\n        this.observations_.forEach(function (observation) {\r\n            if (observation.isActive()) {\r\n                _this.activeObservations_.push(observation);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Invokes initial callback function with a list of ResizeObserverEntry\r\n     * instances collected from active resize observations.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverSPI.prototype.broadcastActive = function () {\r\n        // Do nothing if observer doesn't have active observations.\r\n        if (!this.hasActive()) {\r\n            return;\r\n        }\r\n        var ctx = this.callbackCtx_;\r\n        // Create ResizeObserverEntry instance for every active observation.\r\n        var entries = this.activeObservations_.map(function (observation) {\r\n            return new ResizeObserverEntry(observation.target, observation.broadcastRect());\r\n        });\r\n        this.callback_.call(ctx, entries, ctx);\r\n        this.clearActive();\r\n    };\r\n    /**\r\n     * Clears the collection of active observations.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverSPI.prototype.clearActive = function () {\r\n        this.activeObservations_.splice(0);\r\n    };\r\n    /**\r\n     * Tells whether observer has active observations.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    ResizeObserverSPI.prototype.hasActive = function () {\r\n        return this.activeObservations_.length > 0;\r\n    };\r\n    return ResizeObserverSPI;\r\n}());\n\n// Registry of internal observers. If WeakMap is not available use current shim\r\n// for the Map collection as it has all required methods and because WeakMap\r\n// can't be fully polyfilled anyway.\r\nvar observers = typeof WeakMap !== 'undefined' ? new WeakMap() : new MapShim();\r\n/**\r\n * ResizeObserver API. Encapsulates the ResizeObserver SPI implementation\r\n * exposing only those methods and properties that are defined in the spec.\r\n */\r\nvar ResizeObserver = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance of ResizeObserver.\r\n     *\r\n     * @param {ResizeObserverCallback} callback - Callback that is invoked when\r\n     *      dimensions of the observed elements change.\r\n     */\r\n    function ResizeObserver(callback) {\r\n        if (!(this instanceof ResizeObserver)) {\r\n            throw new TypeError('Cannot call a class as a function.');\r\n        }\r\n        if (!arguments.length) {\r\n            throw new TypeError('1 argument required, but only 0 present.');\r\n        }\r\n        var controller = ResizeObserverController.getInstance();\r\n        var observer = new ResizeObserverSPI(callback, controller, this);\r\n        observers.set(this, observer);\r\n    }\r\n    return ResizeObserver;\r\n}());\r\n// Expose public methods of ResizeObserver.\r\n[\r\n    'observe',\r\n    'unobserve',\r\n    'disconnect'\r\n].forEach(function (method) {\r\n    ResizeObserver.prototype[method] = function () {\r\n        var _a;\r\n        return (_a = observers.get(this))[method].apply(_a, arguments);\r\n    };\r\n});\n\nvar index = (function () {\r\n    // Export existing implementation if available.\r\n    if (typeof global$1.ResizeObserver !== 'undefined') {\r\n        return global$1.ResizeObserver;\r\n    }\r\n    return ResizeObserver;\r\n})();\n\nexport default index;\n","// IOS Safari/Desktop Safari browsers < 10.3\nimport 'url-search-params-polyfill';\nimport 'whatwg-fetch';\nimport 'formdata-polyfill';\nimport ResizeObservePollyFill from 'resize-observer-polyfill';\n\nwindow.ResizeObserver = window.ResizeObserver || ResizeObservePollyFill;\n\nPromise.allSettled = Promise.allSettled || async function (promises: Array<Promise<unknown>>) {\n\tconst mappedPromises = promises.map(async p => p\n\t\t.then(value => ({\n\t\t\tstatus: 'fulfilled',\n\t\t\tvalue,\n\t\t}))\n\t\t.catch((reason: unknown) => ({\n\t\t\tstatus: 'rejected',\n\t\t\treason,\n\t\t})));\n\treturn Promise.all(mappedPromises);\n};\n\ndeclare global {\n\tinterface FormData {\n\t\t// Not sure why this is needed, but it is -\\_(o_o)_/-\n\t\tentries(): IterableIterator<[string, string]>;\n\t}\n}\n","import {type IGLOBAL} from './IGlobal';\n\n/**\n * Global variable object. It should be avoided importing other then in main.ts or phased\n * out completely in the future through a more robust data structure to allow for better\n * testing and more deterministic code\n * @deprecated New use of globals should be done though the redux\n * store with dispatching changes and subscribing for updates.\n */\nexport const GLOBAL: IGLOBAL = {\n\tcheckoutData: null,\n};\n","import {getLocaleText} from '../../ts/util/translation';\nimport chevronImageURL from '../../../../public/img/chevron-down-solid.svg';\nimport {maybeFetchWP} from '../../../@shared/ts/maybe';\nimport {FeatureFlag} from '../../../@type/features';\nimport {Feature, startModalLoading, stopModalLoading} from '../reducers/environmentReducer';\nimport {getErrorString} from '../../../@shared/ts/error';\nimport {store} from '../store';\nimport {requestCartCalculation} from '../payment/order';\nimport {$qs} from '../../../@shared/ts/dom';\nimport {type CheckoutData} from '../models/CheckoutData';\nimport {Carts} from '../reducers/cartReducer';\n\nexport function initMerchantAccount(checkoutData: CheckoutData) {\n\tconst accountDetails = checkoutData.merchant_customer_account;\n\n\t// If the user is logged in then we don't need to do anything\n\tif (accountDetails.logged_in) {\n\t\treturn;\n\t}\n\n\tif (accountDetails.checkout_login_enabled) {\n\t\tmountLoginHTML();\n\t\tsetupLoginEvents();\n\t}\n\n\tif (accountDetails.checkout_registration_enabled || accountDetails.checkout_registration_with_subscription_enabled) {\n\t\tmountRegistrationHTML(accountDetails);\n\t\tsetupRegistrationEvents();\n\t}\n\n\tlet previousCartContainsSubscription = false;\n\tconst unsubscribe = store.subscribe(() => {\n\t\t// A user might get logged in after placing the order but then encountering an error with the\n\t\t// payment. In this case we need to remove the login/registration forms.\n\t\tconst isLoggedIn = Feature.dynamicMetadata<boolean>(FeatureFlag.EXPRESS_CHECKOUT, 'logged_in') ?? false;\n\t\tif (isLoggedIn) {\n\t\t\tdocument.querySelector('#login-container')?.remove();\n\t\t\tdocument.querySelector('#register-container')?.remove();\n\n\t\t\tunsubscribe();\n\t\t}\n\n\t\tconst currentCartContainsSubscription = Carts.subscriptionPresent();\n\t\tif (previousCartContainsSubscription === currentCartContainsSubscription) {\n\t\t\treturn;\n\t\t}\n\n\t\tpreviousCartContainsSubscription = currentCartContainsSubscription;\n\n\t\t// At this point we can assume:\n\t\t// 1. The user is not logged in\n\t\t// 2. The user has the option to register an account\n\n\t\t// At this point we cannot assume:\n\t\t// 1. The user may or may not have the option to login\n\t\t// 2. The user may or may not have a subscription in their cart\n\n\t\ttoggleRegistrationDisplay(shouldShowRegistration(accountDetails, Carts.subscriptionPresent()));\n\t\ttoggleRegistrationCheckboxDisplay(shouldShowRegistrationCheckbox(accountDetails, Carts.subscriptionPresent()));\n\t\ttoggleRegistrationCredentialsDisplay(shouldShowRegistrationCredentials(accountDetails, Carts.subscriptionPresent()));\n\t});\n}\n\nfunction mountLoginHTML() {\n\tconst lostPasswordURL = Feature.metadata<string>(FeatureFlag.EXPRESS_CHECKOUT, 'lost_password_url') ?? '';\n\n\tconst html = `\n\t<div id=\"login-container\">\n\t\t<style>\n\t\t\t#login-container details {\n\t\t\t\tborder-radius: 8px;\n\t\t\t\tborder: 1px solid #e0e0e0;\n\t\t\t\tmargin-bottom: 12px;\n\t\t\t\toverflow: hidden;\n\t\t\t}\n\t\t\t#login-container summary {\n\t\t\t\tpadding: 8px;\n\t\t\t\tborder-radius: 8px;\n\t\t\t\tcursor: pointer;\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-direction: row;\n\t\t\t\talign-items: center;\n\t\t\t\tbackground-color: var(--peachpay-theme-color-light);\n\n\t\t\t}\n\t\t\t#login-container details[open] summary {\n\t\t\t\tborder-bottom-left-radius: 0;\n\t\t\t\tborder-bottom-right-radius: 0;\n\t\t\t\tborder-bottom: 1px solid #e0e0e0;\n\t\t\t}\n\t\t\t#login-container details[open] summary > img {\n\t\t\t\ttransform: rotate(180deg);\n\t\t\t}\n\t\t\t#login-container form {\n\t\t\t\tpadding: 8px;\n\t\t\t}\n\t\t\tdetails > summary {\n\t\t\t\tlist-style: none;\n\t\t\t}\n\t\t\tdetails > summary::-webkit-details-marker {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\n\t\t\t.forgot-password{\n\t\t\t\tborder-radius: 8px;\n\t\t\t\tpadding: 8px;\n\t\t\t\tcolor: var(--peachpay-theme-color);\n\t\t\t}\n\n\t\t\t.forgot-password:hover{\n\t\t\t\tbackground-color: var(--peachpay-theme-color-light);\n\t\t\t}\n\t\t</style>\n\t\t<details>\n\t\t\t<summary>\n\t\t\t\t<span style=\"flex: 1;\">${getLocaleText('Have an account?')}</span>\n\t\t\t\t<img src=\"${chevronImageURL}\" class=\"pp-accordion-arrow\" style=\"scale: 1.2; margin-right: 12px\">\n\t\t\t</summary>\n\t\t\t<span style=\"display: block; margin: 8px 8px 0;\">\n\t\t\t\t${getLocaleText('If you have shopped with us before, please enter your login details below. If you are a new customer, please proceed to the next section.')}\n\t\t\t</span>\n\t\t\t<form id=\"login-user\" class=\"pp-form\" style=\"margin-top: 8px 8px 0x;\">\n\t\t\t\t<div class=\"pp-fw-50 flex\">\n\t\t\t\t\t<input name=\"username\" type=\"text\" class=\"pp-fw-100 text-input\" placeholder=\" \" required/>\n\t\t\t\t\t<label class=\"pp-form-label\" for=\"username\">${getLocaleText('Username or email')}</label>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"pp-fw-50 flex\">\n\t\t\t\t\t<input name=\"password\" type=\"password\" class=\"pp-fw-100 text-input\" placeholder=\" \" required/>\n\t\t\t\t\t<label class=\"pp-form-label\" for=\"password\">${getLocaleText('Password')}</label>\n\t\t\t\t</div>\n\t\t\t\t<span id=\"login-error\" class=\"error hide\"></span>\n\t\t\t\t<label class=\"pp-fw-100 flex\">\n\t\t\t\t\t<input name=\"remember\" type=\"checkbox\" value=\"forever\"/>\n\t\t\t\t\t<span>${getLocaleText('Remember me')}</span>\n\t\t\t\t</label>\n\t\t\t</form>\n\t\t\t<div class=\"flex row\" style=\"padding: 8px;\">\n\t\t\t\t<button type=\"submit\" form=\"login-user\" class=\"btn\" style=\"padding: 8px; min-width: 7rem; width: auto; margin-right: 8px;\">${getLocaleText('Login')}</button>\n\t\t\t\t<a class=\"forgot-password\" href=\"${lostPasswordURL}\" onclick=\"window.top.location.href = this.href; return false;\">${getLocaleText('Lost your password?')}</a>\n\t\t\t</div>\n\t\t</details>\n\t</div>`;\n\n\tdocument.querySelector('#pp-billing-page')?.insertAdjacentHTML('afterbegin', html);\n}\n\nfunction setupLoginEvents() {\n\tdocument.querySelector('#login-user')?.addEventListener('submit', async event => {\n\t\tevent.preventDefault();\n\n\t\tconst $form = event.target as HTMLFormElement;\n\t\tconst ajaxURL = Feature.metadata<string>(FeatureFlag.EXPRESS_CHECKOUT, 'admin_ajax_url');\n\t\tconst loginNonce = Feature.dynamicMetadata<string>(FeatureFlag.EXPRESS_CHECKOUT, 'login_nonce');\n\n\t\t$qs('#login-error')?.classList.add('hide');\n\n\t\tif (!$form || !ajaxURL || !loginNonce) {\n\t\t\t$qs('#login-error', $el => {\n\t\t\t\t$el.innerHTML = getLocaleText('An unknown error occurred while logging in. Please refresh the page and try again.');\n\t\t\t\t$el.classList.remove('hide');\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tstore.dispatch(startModalLoading());\n\n\t\tconst formData = new FormData($form);\n\t\tformData.append('security', loginNonce);\n\t\tformData.append('action', 'peachpay_ajax_login');\n\n\t\tconst {error: loginError, result: loginResult} = await maybeFetchWP<{success: boolean; message: string}>(ajaxURL, {\n\t\t\tmethod: 'POST',\n\t\t\tbody: formData,\n\t\t});\n\n\t\tif (loginError || !loginResult || !loginResult.success) {\n\t\t\tconst errorMessage = loginError ? getErrorString(loginError) : loginResult?.message ?? 'An unknown error occurred while logging in. Please try again later.';\n\t\t\tconst cleanHTML = (htmlString: string) => {\n\t\t\t\tconst temporalDivElement = document.createElement('div');\n\t\t\t\ttemporalDivElement.innerHTML = htmlString;\n\t\t\t\ttemporalDivElement.querySelectorAll('a,script').forEach($el => {\n\t\t\t\t\t$el.remove();\n\t\t\t\t});\n\t\t\t\treturn temporalDivElement.innerHTML;\n\t\t\t};\n\n\t\t\t$qs('#login-error', $el => {\n\t\t\t\t$el.innerHTML = cleanHTML(errorMessage);\n\t\t\t\t$el.classList.remove('hide');\n\t\t\t});\n\t\t\tstore.dispatch(stopModalLoading());\n\t\t\treturn;\n\t\t}\n\n\t\t// Remove the login/registration forms from the checkout. They are no longer needed.\n\t\tdocument.querySelector('#login-container')?.remove();\n\t\tdocument.querySelector('#register-container')?.remove();\n\n\t\tawait requestCartCalculation('pull');\n\t\tstore.dispatch(stopModalLoading());\n\t});\n}\n\nfunction mountRegistrationHTML(accountDetails: CheckoutData['merchant_customer_account']) {\n\tconst usernameHTML = (displayed: boolean) => `\n\t\t<div id=\"register-username\" class=\"${accountDetails.auto_generate_password ? 'pp-fw-100' : 'pp-fw-50'} flex\">\n\t\t\t<input name=\"account_username\" type=\"text\" class=\"pp-fw-100 text-input\" placeholder=\" \" required ${displayed ? '' : 'disabled'}/>\n\t\t\t<label class=\"pp-form-label\" for=\"account_username\">${getLocaleText('Account username')}</label>\n\t\t</div>`;\n\n\tconst passwordHTML = (displayed: boolean) => `\n\t\t<div id=\"register-password\" class=\"${accountDetails.auto_generate_username ? 'pp-fw-100' : 'pp-fw-50'} flex\">\n\t\t\t<input name=\"account_password\" type=\"password\" class=\"pp-fw-100 text-input\" placeholder=\" \" required ${displayed ? '' : 'disabled'}/>\n\t\t\t<label class=\"pp-form-label\" for=\"account_password\">${getLocaleText('Create account password')}</label>\n\t\t</div>`;\n\n\tconst showRegistration = shouldShowRegistration(accountDetails, false);\n\tconst showRegistrationCheckbox = shouldShowRegistrationCheckbox(accountDetails, false);\n\tconst showRegistrationCredentials = shouldShowRegistrationCredentials(accountDetails, false);\n\n\tconst containerHTML = `\n\t<div id=\"register-container\" class=\"pp-form pp-fw-100 ${showRegistration ? '' : 'hide'}\">\n\t\t<div id=\"register-account\" class=\"flex pp-fw-100 ${showRegistrationCheckbox ? '' : 'hide'}\">\n\t\t\t<div class=\"pp-fw-100 flex\">\n\t\t\t\t<label>\n\t\t\t\t\t<input id=\"createaccount\" type=\"checkbox\" name=\"createaccount\" value=\"1\"/>\n\t\t\t\t\t${getLocaleText('Create an account?')}\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t</div>\n\t\t<div id=\"register-credentials\" class=\"pp-form pp-fw-100 ${showRegistrationCredentials ? '' : 'hide'}\">\n\t\t\t${accountDetails.auto_generate_username ? '' : usernameHTML(showRegistrationCredentials)}\n\t\t\t${accountDetails.auto_generate_password ? '' : passwordHTML(showRegistrationCredentials)}\n\t\t</div>\n\t</div>`;\n\n\tdocument.querySelector('#pp-billing-form')?.insertAdjacentHTML('beforeend', containerHTML);\n}\n\nfunction setupRegistrationEvents() {\n\tdocument.querySelector('#createaccount')?.addEventListener('click', async event => {\n\t\tconst $target = event.target as HTMLInputElement;\n\n\t\ttoggleRegistrationCredentialsDisplay($target.checked);\n\t});\n}\n\nfunction shouldShowRegistrationCheckbox(accountDetails: CheckoutData['merchant_customer_account'], subscriptionPresent: boolean) {\n\tif (subscriptionPresent) {\n\t\treturn false;\n\t}\n\n\treturn accountDetails.allow_guest_checkout;\n}\n\nfunction toggleRegistrationCheckboxDisplay(show: boolean) {\n\tdocument.querySelector('#register-account')?.classList.toggle('hide', !show);\n}\n\nfunction shouldShowRegistrationCredentials(accountDetails: CheckoutData['merchant_customer_account'], subscriptionPresent: boolean) {\n\treturn subscriptionPresent || !accountDetails.allow_guest_checkout;\n}\n\nfunction toggleRegistrationCredentialsDisplay(show: boolean) {\n\tif (show) {\n\t\t$qs('#register-credentials')?.classList.remove('hide');\n\t\t$qs('#register-username input')?.removeAttribute('disabled');\n\t\t$qs('#register-password input')?.removeAttribute('disabled');\n\t} else {\n\t\t$qs('#register-credentials')?.classList.add('hide');\n\t\t// Add disabled so form validation doesn't complain when fields are not displayed\n\t\t$qs('#register-username input')?.setAttribute('disabled', '');\n\t\t$qs('#register-password input')?.setAttribute('disabled', '');\n\t}\n}\n\nfunction shouldShowRegistration(accountDetails: CheckoutData['merchant_customer_account'], subscriptionPresent: boolean): boolean {\n\t// Registration is shown if:\n\t//     Checkout registration is enabled\n\t//   or:\n\t//     A subscription is present and registration with a subscription is enabled\n\treturn accountDetails.checkout_registration_enabled || (subscriptionPresent && accountDetails.checkout_registration_with_subscription_enabled);\n}\n\nfunction toggleRegistrationDisplay(show: boolean) {\n\t$qs('#register-container')?.classList.toggle('hide', !show);\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","'use strict';\n\n// do not edit .js files directly - edit src/index.jst\n\n\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  // true if both NaN, false otherwise\n  return a!==a && b!==b;\n};\n","/**\n * Copyright 2019 Google LLC. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at.\n *\n *      Http://www.apache.org/licenses/LICENSE-2.0.\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport isEqual from \"fast-deep-equal\";\n\nexport const DEFAULT_ID = \"__googleMapsScriptId\";\n\n// https://developers.google.com/maps/documentation/javascript/libraries#libraries-for-dynamic-library-import\nexport type Library =\n  | \"core\"\n  | \"maps\"\n  | \"places\"\n  | \"geocoding\"\n  | \"routes\"\n  | \"marker\"\n  | \"geometry\"\n  | \"elevation\"\n  | \"streetView\"\n  | \"journeySharing\"\n  | \"drawing\"\n  | \"visualization\";\n\nexport type Libraries = Library[];\n\n/**\n * The Google Maps JavaScript API\n * [documentation](https://developers.google.com/maps/documentation/javascript/tutorial)\n * is the authoritative source for [[LoaderOptions]].\n/**\n * Loader options\n */\nexport interface LoaderOptions {\n  /**\n   * See https://developers.google.com/maps/documentation/javascript/get-api-key.\n   */\n  apiKey: string;\n  /**\n   * @deprecated See https://developers.google.com/maps/premium/overview.\n   */\n  channel?: string;\n  /**\n   * @deprecated See https://developers.google.com/maps/premium/overview, use `apiKey` instead.\n   */\n  client?: string;\n  /**\n   * In your application you can specify release channels or version numbers:\n   *\n   * The weekly version is specified with `version=weekly`. This version is\n   * updated once per week, and is the most current.\n   *\n   * ```\n   * const loader = Loader({apiKey, version: 'weekly'});\n   * ```\n   *\n   * The quarterly version is specified with `version=quarterly`. This version\n   * is updated once per quarter, and is the most predictable.\n   *\n   * ```\n   * const loader = Loader({apiKey, version: 'quarterly'});\n   * ```\n   *\n   * The version number is specified with `version=n.nn`. You can choose\n   * `version=3.40`, `version=3.39`, or `version=3.38`. Version numbers are\n   * updated once per quarter.\n   *\n   * ```\n   * const loader = Loader({apiKey, version: '3.40'});\n   * ```\n   *\n   * If you do not explicitly specify a version, you will receive the\n   * weekly version by default.\n   */\n  version?: string;\n  /**\n   * The id of the script tag. Before adding a new script, the Loader will check for an existing one.\n   */\n  id?: string;\n  /**\n   * When loading the Maps JavaScript API via the URL you may optionally load\n   * additional libraries through use of the libraries URL parameter. Libraries\n   * are modules of code that provide additional functionality to the main Maps\n   * JavaScript API but are not loaded unless you specifically request them.\n   *\n   * ```\n   * const loader = Loader({\n   *  apiKey,\n   *  libraries: ['drawing', 'geometry', 'places', 'visualization'],\n   * });\n   * ```\n   *\n   * Set the [list of libraries](https://developers.google.com/maps/documentation/javascript/libraries) for more options.\n   */\n  libraries?: Libraries;\n  /**\n   * By default, the Maps JavaScript API uses the user's preferred language\n   * setting as specified in the browser, when displaying textual information\n   * such as the names for controls, copyright notices, driving directions and\n   * labels on maps. In most cases, it's preferable to respect the browser\n   * setting. However, if you want the Maps JavaScript API to ignore the\n   * browser's language setting, you can force it to display information in a\n   * particular language when loading the Maps JavaScript API code.\n   *\n   * For example, the following example localizes the language to Japan:\n   *\n   * ```\n   * const loader = Loader({apiKey, language: 'ja', region: 'JP'});\n   * ```\n   *\n   * See the [list of supported\n   * languages](https://developers.google.com/maps/faq#languagesupport). Note\n   * that new languages are added often, so this list may not be exhaustive.\n   *\n   */\n  language?: string;\n  /**\n   * When you load the Maps JavaScript API from maps.googleapis.com it applies a\n   * default bias for application behavior towards the United States. If you\n   * want to alter your application to serve different map tiles or bias the\n   * application (such as biasing geocoding results towards the region), you can\n   * override this default behavior by adding a region parameter when loading\n   * the Maps JavaScript API code.\n   *\n   * The region parameter accepts Unicode region subtag identifiers which\n   * (generally) have a one-to-one mapping to country code Top-Level Domains\n   * (ccTLDs). Most Unicode region identifiers are identical to ISO 3166-1\n   * codes, with some notable exceptions. For example, Great Britain's ccTLD is\n   * \"uk\" (corresponding to the domain .co.uk) while its region identifier is\n   * \"GB.\"\n   *\n   * For example, the following example localizes the map to the United Kingdom:\n   *\n   * ```\n   * const loader = Loader({apiKey, region: 'GB'});\n   * ```\n   */\n  region?: string;\n  /**\n   * @deprecated Passing `mapIds` is no longer required in the script tag.\n   */\n  mapIds?: string[];\n  /**\n   * Use a custom url and path to load the Google Maps API script.\n   */\n  url?: string;\n  /**\n   * Use a cryptographic nonce attribute.\n   */\n  nonce?: string;\n  /**\n   * The number of script load retries.\n   */\n  retries?: number;\n  /**\n   * Maps JS customers can configure HTTP Referrer Restrictions in the Cloud\n   * Console to limit which URLs are allowed to use a particular API Key. By\n   * default, these restrictions can be configured to allow only certain paths\n   * to use an API Key. If any URL on the same domain or origin may use the API\n   * Key, you can set `auth_referrer_policy=origin` to limit the amount of data\n   * sent when authorizing requests from the Maps JavaScript API. This is\n   * available starting in version 3.46. When this parameter is specified and\n   * HTTP Referrer Restrictions are enabled on Cloud Console, Maps JavaScript\n   * API will only be able to load if there is an HTTP Referrer Restriction that\n   * matches the current website's domain without a path specified.\n   */\n  authReferrerPolicy?: \"origin\";\n}\n\n/**\n * The status of the [[Loader]].\n */\nexport enum LoaderStatus {\n  INITIALIZED,\n  LOADING,\n  SUCCESS,\n  FAILURE,\n}\n\n/**\n * [[Loader]] makes it easier to add Google Maps JavaScript API to your application\n * dynamically using\n * [Promises](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise).\n * It works by dynamically creating and appending a script node to the the\n * document head and wrapping the callback function so as to return a promise.\n *\n * ```\n * const loader = new Loader({\n *   apiKey: \"\",\n *   version: \"weekly\",\n *   libraries: [\"places\"]\n * });\n *\n * loader.load().then((google) => {\n *   const map = new google.maps.Map(...)\n * })\n * ```\n */\nexport class Loader {\n  private static instance: Loader;\n  /**\n   * See [[LoaderOptions.version]]\n   */\n  public readonly version: string;\n  /**\n   * See [[LoaderOptions.apiKey]]\n   */\n  public readonly apiKey: string;\n  /**\n   * See [[LoaderOptions.channel]]\n   */\n  public readonly channel: string;\n  /**\n   * See [[LoaderOptions.client]]\n   */\n  public readonly client: string;\n  /**\n   * See [[LoaderOptions.id]]\n   */\n  public readonly id: string;\n  /**\n   * See [[LoaderOptions.libraries]]\n   */\n  public readonly libraries: Libraries;\n  /**\n   * See [[LoaderOptions.language]]\n   */\n  public readonly language: string;\n\n  /**\n   * See [[LoaderOptions.region]]\n   */\n  public readonly region: string;\n\n  /**\n   * See [[LoaderOptions.mapIds]]\n   */\n  public readonly mapIds: string[];\n\n  /**\n   * See [[LoaderOptions.nonce]]\n   */\n  public readonly nonce: string | null;\n\n  /**\n   * See [[LoaderOptions.retries]]\n   */\n  public readonly retries: number;\n\n  /**\n   * See [[LoaderOptions.url]]\n   */\n  public readonly url: string;\n  /**\n   * See [[LoaderOptions.authReferrerPolicy]]\n   */\n  public readonly authReferrerPolicy: \"origin\";\n\n  private callbacks: ((e: ErrorEvent) => void)[] = [];\n  private done = false;\n  private loading = false;\n  private onerrorEvent: ErrorEvent;\n  private errors: ErrorEvent[] = [];\n\n  /**\n   * Creates an instance of Loader using [[LoaderOptions]]. No defaults are set\n   * using this library, instead the defaults are set by the Google Maps\n   * JavaScript API server.\n   *\n   * ```\n   * const loader = Loader({apiKey, version: 'weekly', libraries: ['places']});\n   * ```\n   */\n  constructor({\n    apiKey,\n    authReferrerPolicy,\n    channel,\n    client,\n    id = DEFAULT_ID,\n    language,\n    libraries = [],\n    mapIds,\n    nonce,\n    region,\n    retries = 3,\n    url = \"https://maps.googleapis.com/maps/api/js\",\n    version,\n  }: LoaderOptions) {\n    this.apiKey = apiKey;\n    this.authReferrerPolicy = authReferrerPolicy;\n    this.channel = channel;\n    this.client = client;\n    this.id = id || DEFAULT_ID; // Do not allow empty string\n    this.language = language;\n    this.libraries = libraries;\n    this.mapIds = mapIds;\n    this.nonce = nonce;\n    this.region = region;\n    this.retries = retries;\n    this.url = url;\n    this.version = version;\n\n    if (Loader.instance) {\n      if (!isEqual(this.options, Loader.instance.options)) {\n        throw new Error(\n          `Loader must not be called again with different options. ${JSON.stringify(\n            this.options\n          )} !== ${JSON.stringify(Loader.instance.options)}`\n        );\n      }\n\n      return Loader.instance;\n    }\n\n    Loader.instance = this;\n  }\n\n  public get options(): LoaderOptions {\n    return {\n      version: this.version,\n      apiKey: this.apiKey,\n      channel: this.channel,\n      client: this.client,\n      id: this.id,\n      libraries: this.libraries,\n      language: this.language,\n      region: this.region,\n      mapIds: this.mapIds,\n      nonce: this.nonce,\n      url: this.url,\n      authReferrerPolicy: this.authReferrerPolicy,\n    };\n  }\n\n  public get status(): LoaderStatus {\n    if (this.errors.length) {\n      return LoaderStatus.FAILURE;\n    }\n    if (this.done) {\n      return LoaderStatus.SUCCESS;\n    }\n    if (this.loading) {\n      return LoaderStatus.LOADING;\n    }\n    return LoaderStatus.INITIALIZED;\n  }\n\n  private get failed(): boolean {\n    return this.done && !this.loading && this.errors.length >= this.retries + 1;\n  }\n\n  /**\n   * CreateUrl returns the Google Maps JavaScript API script url given the [[LoaderOptions]].\n   *\n   * @ignore\n   * @deprecated\n   */\n  public createUrl(): string {\n    let url = this.url;\n\n    url += `?callback=__googleMapsCallback`;\n\n    if (this.apiKey) {\n      url += `&key=${this.apiKey}`;\n    }\n\n    if (this.channel) {\n      url += `&channel=${this.channel}`;\n    }\n\n    if (this.client) {\n      url += `&client=${this.client}`;\n    }\n\n    if (this.libraries.length > 0) {\n      url += `&libraries=${this.libraries.join(\",\")}`;\n    }\n\n    if (this.language) {\n      url += `&language=${this.language}`;\n    }\n\n    if (this.region) {\n      url += `&region=${this.region}`;\n    }\n\n    if (this.version) {\n      url += `&v=${this.version}`;\n    }\n\n    if (this.mapIds) {\n      url += `&map_ids=${this.mapIds.join(\",\")}`;\n    }\n\n    if (this.authReferrerPolicy) {\n      url += `&auth_referrer_policy=${this.authReferrerPolicy}`;\n    }\n\n    return url;\n  }\n\n  public deleteScript(): void {\n    const script = document.getElementById(this.id);\n    if (script) {\n      script.remove();\n    }\n  }\n\n  /**\n   * Load the Google Maps JavaScript API script and return a Promise.\n   * @deprecated, use importLibrary() instead.\n   */\n  public load(): Promise<typeof google> {\n    return this.loadPromise();\n  }\n\n  /**\n   * Load the Google Maps JavaScript API script and return a Promise.\n   *\n   * @ignore\n   * @deprecated, use importLibrary() instead.\n   */\n  public loadPromise(): Promise<typeof google> {\n    return new Promise((resolve, reject) => {\n      this.loadCallback((err: ErrorEvent) => {\n        if (!err) {\n          resolve(window.google);\n        } else {\n          reject(err.error);\n        }\n      });\n    });\n  }\n\n  /**\n   * See https://developers.google.com/maps/documentation/javascript/reference/top-level#google.maps.importLibrary\n   */\n  public importLibrary(name: \"core\"): Promise<google.maps.CoreLibrary>;\n  public importLibrary(name: \"maps\"): Promise<google.maps.MapsLibrary>;\n  public importLibrary(name: \"places\"): Promise<google.maps.PlacesLibrary>;\n  public importLibrary(\n    name: \"geocoding\"\n  ): Promise<google.maps.GeocodingLibrary>;\n  public importLibrary(name: \"routes\"): Promise<google.maps.RoutesLibrary>;\n  public importLibrary(name: \"marker\"): Promise<google.maps.MarkerLibrary>;\n  public importLibrary(name: \"geometry\"): Promise<google.maps.GeometryLibrary>;\n  public importLibrary(\n    name: \"elevation\"\n  ): Promise<google.maps.ElevationLibrary>;\n  public importLibrary(\n    name: \"streetView\"\n  ): Promise<google.maps.StreetViewLibrary>;\n  public importLibrary(\n    name: \"journeySharing\"\n  ): Promise<google.maps.JourneySharingLibrary>;\n  public importLibrary(name: \"drawing\"): Promise<google.maps.DrawingLibrary>;\n  public importLibrary(\n    name: \"visualization\"\n  ): Promise<google.maps.VisualizationLibrary>;\n  public importLibrary(name: Library): Promise<unknown>;\n  public importLibrary(name: Library): Promise<unknown> {\n    this.execute();\n    return google.maps.importLibrary(name);\n  }\n\n  /**\n   * Load the Google Maps JavaScript API script with a callback.\n   * @deprecated, use importLibrary() instead.\n   */\n  public loadCallback(fn: (e: ErrorEvent) => void): void {\n    this.callbacks.push(fn);\n    this.execute();\n  }\n\n  /**\n   * Set the script on document.\n   */\n  private setScript(): void {\n    if (document.getElementById(this.id)) {\n      // TODO wrap onerror callback for cases where the script was loaded elsewhere\n      this.callback();\n      return;\n    }\n\n    const params = {\n      key: this.apiKey,\n      channel: this.channel,\n      client: this.client,\n      libraries: this.libraries.length && this.libraries,\n      v: this.version,\n      mapIds: this.mapIds,\n      language: this.language,\n      region: this.region,\n      authReferrerPolicy: this.authReferrerPolicy,\n    };\n    // keep the URL minimal:\n    Object.keys(params).forEach(\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      (key) => !(params as any)[key] && delete (params as any)[key]\n    );\n\n    if (!window?.google?.maps?.importLibrary) {\n      // tweaked copy of https://developers.google.com/maps/documentation/javascript/load-maps-js-api#dynamic-library-import\n      // which also sets the base url, the id, and the nonce\n      /* eslint-disable */\n      ((g) => {\n        // @ts-ignore\n        let h,\n          a,\n          k,\n          p = \"The Google Maps JavaScript API\",\n          c = \"google\",\n          l = \"importLibrary\",\n          q = \"__ib__\",\n          m = document,\n          b = window;\n        // @ts-ignore\n        b = b[c] || (b[c] = {});\n        // @ts-ignore\n        const d = b.maps || (b.maps = {}),\n          r = new Set(),\n          e = new URLSearchParams(),\n          u = () =>\n            // @ts-ignore\n            h || (h = new Promise(async (f, n) => {\n              await (a = m.createElement(\"script\"));\n              a.id = this.id;\n              e.set(\"libraries\", [...r] + \"\");\n              // @ts-ignore\n              for (k in g) e.set(k.replace(/[A-Z]/g, (t) => \"_\" + t[0].toLowerCase()), g[k]);\n              e.set(\"callback\", c + \".maps.\" + q);\n              a.src = this.url + `?` + e;\n              d[q] = f;\n              a.onerror = () => (h = n(Error(p + \" could not load.\")));\n              // @ts-ignore\n              a.nonce = this.nonce || m.querySelector(\"script[nonce]\")?.nonce || \"\";\n              m.head.append(a);\n            }));\n        // @ts-ignore\n        d[l] ? console.warn(p + \" only loads once. Ignoring:\", g) : (d[l] = (f, ...n) => r.add(f) && u().then(() => d[l](f, ...n)));\n      })(params);\n      /* eslint-enable */\n    }\n\n    // While most libraries populate the global namespace when loaded via bootstrap params,\n    // this is not the case for \"marker\" when used with the inline bootstrap loader\n    // (and maybe others in the future). So ensure there is an importLibrary for each:\n    const libraryPromises = this.libraries.map((library) =>\n      this.importLibrary(library)\n    );\n    // ensure at least one library, to kick off loading...\n    if (!libraryPromises.length) {\n      libraryPromises.push(this.importLibrary(\"core\"));\n    }\n    Promise.all(libraryPromises).then(\n      () => this.callback(),\n      (error) => {\n        const event = new ErrorEvent(\"error\", { error }); // for backwards compat\n        this.loadErrorCallback(event);\n      }\n    );\n  }\n\n  /**\n   * Reset the loader state.\n   */\n  private reset(): void {\n    this.deleteScript();\n    this.done = false;\n    this.loading = false;\n    this.errors = [];\n    this.onerrorEvent = null;\n  }\n\n  private resetIfRetryingFailed(): void {\n    if (this.failed) {\n      this.reset();\n    }\n  }\n\n  private loadErrorCallback(e: ErrorEvent): void {\n    this.errors.push(e);\n\n    if (this.errors.length <= this.retries) {\n      const delay = this.errors.length * 2 ** this.errors.length;\n\n      console.error(\n        `Failed to load Google Maps script, retrying in ${delay} ms.`\n      );\n\n      setTimeout(() => {\n        this.deleteScript();\n        this.setScript();\n      }, delay);\n    } else {\n      this.onerrorEvent = e;\n      this.callback();\n    }\n  }\n\n  private callback(): void {\n    this.done = true;\n    this.loading = false;\n\n    this.callbacks.forEach((cb) => {\n      cb(this.onerrorEvent);\n    });\n\n    this.callbacks = [];\n  }\n\n  private execute(): void {\n    this.resetIfRetryingFailed();\n\n    if (this.done) {\n      this.callback();\n    } else {\n      // short circuit and warn if google.maps is already loaded\n      if (window.google && window.google.maps && window.google.maps.version) {\n        console.warn(\n          \"Google Maps already loaded outside @googlemaps/js-api-loader.\" +\n            \"This may result in undesirable behavior as options and script parameters may not match.\"\n        );\n        this.callback();\n        return;\n      }\n\n      if (this.loading) {\n        // do nothing but wait\n      } else {\n        this.loading = true;\n\n        this.setScript();\n      }\n    }\n  }\n}\n","import {Feature} from '../reducers/environmentReducer';\nimport {$qs} from '../../../@shared/ts/dom';\nimport {FeatureFlag} from '../../../@type/features';\nimport {Loader} from '@googlemaps/js-api-loader';\nimport {PeachPayCustomer} from '../reducers/peachPayCustomerReducer';\nimport {PeachPayOrder} from '../reducers/peachPayOrderReducer';\n\nfunction shouldEnableAddressAutocomplete() {\n\tif (Feature.enabled(FeatureFlag.ADDRESS_AUTOCOMPLETE)) {\n\t\tconst activeLocations = Feature.metadata(FeatureFlag.ADDRESS_AUTOCOMPLETE, 'active_locations');\n\n\t\tif (activeLocations === 'default' || activeLocations === 'express_checkout_only') {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n}\n\nexport function initAddressAutocomplete() {\n\tif (!shouldEnableAddressAutocomplete()) {\n\t\treturn;\n\t}\n\n\tconst loader = new Loader({\n\t\tapiKey: 'AIzaSyAL_j0UvKJacQhZ3OedCj_bkcTbuO63MVU',\n\t\tversion: 'weekly',\n\t\tlibraries: ['places'],\n\t});\n\n\tloader.importLibrary('places').then(async () => {\n\t\tconst autocompleteOptions = {\n\t\t\tfields: ['address_components'],\n\t\t\ttypes: ['address'],\n\t\t};\n\n\t\tconst billingInput = $qs<HTMLInputElement>('#pp-billing-form [name=\"billing_address_1\"]');\n\t\tif (billingInput) {\n\t\t\tconst billingAddressAutocomplete = new google.maps.places.Autocomplete(billingInput, autocompleteOptions);\n\t\t\tbillingAddressAutocomplete?.addListener('place_changed', async () => {\n\t\t\t\tconst place = billingAddressAutocomplete.getPlace();\n\t\t\t\tawait fillInAddress(place, 'billing');\n\t\t\t});\n\t\t}\n\n\t\tconst shippingInput = $qs<HTMLInputElement>('#pp-shipping-form [name=\"shipping_address_1\"]');\n\t\tif (shippingInput) {\n\t\t\tconst shippingAddressAutocomplete = new google.maps.places.Autocomplete(shippingInput, autocompleteOptions);\n\t\t\tshippingAddressAutocomplete?.addListener('place_changed', async () => {\n\t\t\t\tconst place = shippingAddressAutocomplete.getPlace();\n\t\t\t\tawait fillInAddress(place, 'shipping');\n\t\t\t});\n\t\t}\n\t}).catch(error => {\n\t\tconsole.log('An error occurred during Google Maps Places API importLibrary:', error);\n\t});\n}\n\nasync function fillInAddress(place: google.maps.places.PlaceResult, addressType: 'billing' | 'shipping'): Promise<void> {\n\tconst form = addressType === 'billing' ? PeachPayCustomer.billing : PeachPayCustomer.shipping;\n\n\t//  \"street_number\" + \"route\" is the street address\n\tconst streetNumber = place.address_components?.find(\n\t\tcomponent => component.types[0] === 'street_number',\n\t)?.long_name ?? '';\n\tconst route = place.address_components?.find(\n\t\tcomponent => component.types.includes('route'),\n\t)?.long_name ?? '';\n\tform.address1(`${streetNumber} ${route}`, true);\n\n\t// \"subpremise\" is the apartment number\n\tconst subpremise = place.address_components?.find(\n\t\tcomponent => component.types.includes('subpremise'),\n\t)?.long_name ?? '';\n\tform.address2(subpremise, true);\n\n\t// \"locality\",\"political\" is the city\n\tconst city = place.address_components?.find(\n\t\tcomponent => component.types.includes('locality')// For US\n\t\t\t\t\t\t\t\t\t|| component.types.includes('postal_town'), // For UK\n\t)?.long_name ?? '';\n\tform.city(city, true);\n\n\t// \"postal_code\" is the zip code\n\tconst postalCode = place.address_components?.find(\n\t\tcomponent => component.types.includes('postal_code'),\n\t)?.long_name ?? '';\n\tform.postal(postalCode, true);\n\n\t// \"country\", \"political\" is the country\n\tconst country = place.address_components?.find(\n\t\tcomponent => component.types.includes('country'),\n\t)?.short_name ?? '';\n\tform.country(country, true);\n\n\t// \"administrative_area_level_1\", \"political\" is the state\n\tconst state = place.address_components?.find(\n\t\tcomponent => component.types.includes('administrative_area_level_1'),\n\t)?.short_name?.split('.').join('') ?? '';\n\tform.state(state, true);\n\n\tawait (addressType === 'billing' ? PeachPayOrder.billing : PeachPayOrder.shipping)?.reportValidity();\n}\n","/**\n * This function filters click and keypress events for those we should consider \"positive\".\n * Click, Space, and Enter events return true. This allows for keyboard accessibility to\n * events using non-standard HTML elements.\n */\nexport function eventClick(event: MouseEvent | KeyboardEvent) {\n\tif (event.type === 'click') {\n\t\treturn true;\n\t}\n\n\tif (event.type === 'keypress') {\n\t\tconst {key} = event as KeyboardEvent;\n\t\tif ((key === 'Enter') || (key === ' ')) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n}\n","import {type ICartCalculationResponse} from '../../../@type/woocommerce/cart-calculation';\nimport {consumeCartCalculationResponse} from '../payment/order';\nimport {Feature, startModalLoading, stopModalLoading} from '../reducers/environmentReducer';\nimport {store} from '../store';\nimport {eventClick} from '../util/dom';\nimport {$qsAll} from '../../../@shared/ts/dom';\nimport {FeatureFlag} from '../../../@type/features';\nimport {captureSentryException} from '../../../@shared/ts/sentry';\nimport {maybeFetchWP} from '../../../@shared/ts/maybe';\nimport {getErrorString} from '../../../@shared/ts/error';\nimport {SDKFlags} from '../sdk';\n\nexport function initQuantityChangerEvent() {\n\tif (!Feature.enabled(FeatureFlag.QUANTITY_CHANGER)) {\n\t\t$qsAll('#pp-summary-body, #pp-summary-body-mobile', $removeButtons => {\n\t\t\t$removeButtons.addEventListener('click', async (event: Event) => {\n\t\t\t\tconst $target = event.target as HTMLElement;\n\n\t\t\t\tif ($target.closest('.pp-item-remover-btn')) {\n\t\t\t\t\tconst cartItemKey = $target.closest<HTMLElement>('.pp-item-remover-btn')?.dataset['qid'];\n\t\t\t\t\tawait changeQuantity(cartItemKey, 0, true);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\treturn;\n\t}\n\n\t// Targeting root of each cart list to simplify event listener and only ever set the listeners once.\n\t$qsAll('#pp-summary-body, #pp-summary-body-mobile, .pp-related-product-body', $cartContainer => {\n\t\t$cartContainer.addEventListener('click', handleCartContainerEvent);\n\t\t$cartContainer.addEventListener('keypress', handleCartContainerEvent);\n\t});\n}\n\nasync function handleCartContainerEvent(event: MouseEvent | KeyboardEvent) {\n\tconst $target = event.target as HTMLElement;\n\t// Item qty updates on Enter, Space, blur, or 3/4 second after being updated.\n\tif ($target.closest('.qty-fs') && event.type === 'keypress') { // Ignore clicks, we need those to select qty-fs.\n\t\tconst $inputTarget = event.target as HTMLInputElement;\n\t\tconst cartItemKey = $target.closest<HTMLElement>('.qty-fs')?.dataset['qid'];\n\t\tif ($inputTarget.value && $inputTarget.checkValidity()) {\n\t\t\tif (eventClick(event)) { // Update value immediately on Enter or Space.\n\t\t\t\tawait changeQuantity(cartItemKey, Number.parseInt($inputTarget.value), true);\n\t\t\t} else if (event.type === 'keypress') { // Else if the qty was updated, set a blur event listener and the timer.\n\t\t\t\t$target.addEventListener('blur', async () => {\n\t\t\t\t\tawait changeQuantity(cartItemKey, Number.parseInt($inputTarget.value), true);\n\t\t\t\t}, {once: true});\n\t\t\t\tawait new Promise(r => {\n\t\t\t\t\tsetTimeout(r, 750);\n\t\t\t\t});\n\t\t\t\tif (!document.activeElement!.classList.contains('qty-fs')) {\n\t\t\t\t\t// Do nothing if we've already blurred.\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t$target.blur();\n\t\t\t}\n\t\t}\n\n\t\treturn;\n\t}\n\n\t// The rest of the events are eventClick events.\n\tif (!eventClick(event)) {\n\t\treturn;\n\t}\n\n\tif (!$target.closest('.qty-btn') && !$target.closest('.qty-fs') && !$target.closest('.pp-item-remover-btn')) {\n\t\treturn; // What was clicked was not a quantity button.\n\t}\n\n\tif ($target.closest('.qty-btn')) {\n\t\tconst $button = $target.closest<HTMLElement>('.qty-btn');\n\t\tconst cartItemKey = $button?.dataset['qid'];\n\n\t\tif ($button?.classList.contains('decrease-qty')) {\n\t\t\tawait changeQuantity(cartItemKey, -1, false);\n\t\t} else if ($button?.classList.contains('increase-qty')) {\n\t\t\tawait changeQuantity(cartItemKey, 1, false);\n\t\t}\n\t} else if ($target.closest('.pp-item-remover-btn')) {\n\t\tconst cartItemKey = $target.closest<HTMLElement>('.pp-item-remover-btn')!.dataset['qid'];\n\t\tawait changeQuantity(cartItemKey, 0, true);\n\t}\n}\n\nasync function changeQuantity(cartItemKey: string | undefined, amount = 1, set = false) {\n\tconst quantityChangeURL = Feature.metadata<string>(FeatureFlag.QUANTITY_CHANGER, 'quantity_changed_url');\n\tif (!quantityChangeURL || !cartItemKey) {\n\t\treturn;\n\t}\n\n\tstore.dispatch(startModalLoading());\n\n\tconst formData = new FormData();\n\tformData.append('cart_item_key', cartItemKey);\n\tformData.append('quantity', String(amount));\n\tformData.append('absolute', String(set));\n\n\tconst {error, result} = await maybeFetchWP<ICartCalculationResponse>(quantityChangeURL, {\n\t\tmethod: 'POST',\n\t\tbody: formData,\n\t});\n\n\tif (error || !result) {\n\t\tcaptureSentryException(error instanceof Error ? error : new Error(getErrorString(error)));\n\t\tstore.dispatch(stopModalLoading());\n\n\t\treturn;\n\t}\n\n\tSDKFlags.setRefresh();\n\n\tconsumeCartCalculationResponse(result);\n\tstore.dispatch(stopModalLoading());\n}\n","import {type WCCartItem} from '../../../@type/woocommerce/cart-item';\nimport {bundleQuantityLabel, cartItemDisplayAmount, cartItemLabel, cartItemQuantity, cartItemVariationHTML} from '../util/cart';\nimport {store} from '../store';\nimport {MerchantConfiguration} from '../reducers/merchantConfigurationReducer';\nimport {DefaultCart} from '../reducers/cartReducer';\nimport {Feature} from '../reducers/environmentReducer';\nimport {initQuantityChangerEvent} from './quantityChanger';\nimport {getLocaleText} from '../util/translation';\nimport {$qs, $qsAll} from '../../../@shared/ts/dom';\nimport {FeatureFlag} from '../../../@type/features';\nimport trashcanURL from '../../img/trashcan.svg';\nimport trashcanRedURL from '../../img/trashcan-red.svg';\nimport qtyMinusImageURL from '../../img/qty-minus.svg';\nimport qtyPlusImageURL from '../../img/qty-plus.svg';\n\nexport function initCart() {\n\tinitCartEvents();\n\tinitQuantityChangerEvent();\n}\n\nfunction initCartEvents() {\n\t/**\n\t * Handle cart rerendering\n\t * Uses a captured variable for culling unneeded rendering\n\t */\n\tlet previousCartData = '';\n\tlet previousCurrencyData = '';\n\tstore.subscribe(() => {\n\t\t// To avoid noticeable cart rerendering from images reloading after any state changes we check if the current cart has\n\t\t// changed by stringifying the cart data and comparing strings.\n\t\t// For plain objects it is the fastest method and incredibly simple: https://stackoverflow.com/questions/1068834/object-comparison-in-javascript\n\t\t// This also now extends to price totals if the total is not the same we will re render the cart\n\t\tconst cartData = JSON.stringify(DefaultCart.contents());\n\t\tconst currencyData = JSON.stringify(MerchantConfiguration.currency.configuration());\n\t\tif (cartData !== previousCartData || currencyData !== previousCurrencyData) {\n\t\t\tpreviousCartData = cartData;\n\t\t\tpreviousCurrencyData = currencyData;\n\t\t\trenderOrderSummaryItems(DefaultCart.contents());\n\t\t}\n\t});\n}\n\nfunction renderOrderSummaryItems(cart: WCCartItem[]): void {\n\tconst $tbody = $qs('#pp-summary-body');\n\tconst $tbodyMobile = $qs('#pp-summary-body-mobile');\n\n\tif (!$tbody || !$tbodyMobile) {\n\t\treturn;\n\t}\n\n\tclearOrderSummary();\n\n\tif (DefaultCart.contents().length === 0) {\n\t\tconst $message = `<div class=\"pp-order-summary-item\"><p>${getLocaleText('Cart is empty')}</p></div>`;\n\n\t\t$tbody.innerHTML = $message;\n\t\t$tbodyMobile.innerHTML = $message;\n\t\treturn;\n\t}\n\n\tfor (let i = 0; i < cart.length; i++) {\n\t\tconst item = cart[i];\n\t\t// If an item has no quantity, there is no need to show it.\n\t\tif (!item || cartItemQuantity(item) === 0) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tlet $cartRow;\n\t\tif (item.is_part_of_bundle) {\n\t\t\tcontinue;\n\t\t} else {\n\t\t\tconst itemBundle: WCCartItem[] = [];\n\t\t\titemBundle.push(item);\n\t\t\t// In the case of bundles, render the item's bundle items with it\n\t\t\tfor (let j = i + 1; j < cart.length; j++) {\n\t\t\t\tconst nextItem = cart[j];\n\t\t\t\tif (nextItem?.is_part_of_bundle) {\n\t\t\t\t\titemBundle.push(nextItem);\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t$cartRow = renderCartItem(itemBundle);\n\t\t}\n\n\t\tif (!$cartRow) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Add a separator border if wanted here\n\t\tif (i !== 0) {\n\t\t\t$cartRow.classList.add('pp-order-summary-item-border');\n\t\t}\n\n\t\t$tbody.append($cartRow);\n\t\t$tbodyMobile.append($cartRow.cloneNode(true));\n\t}\n}\n\nfunction renderBundleItem(item: WCCartItem) {\n\tconst $imgDiv = getImgQtyDiv(item);\n\n\tconst $labelDiv = document.createElement('div');\n\t$labelDiv.className = 'pp-bundle-label';\n\t$labelDiv.innerHTML = `${cartItemLabel(item)}${bundleQuantityLabel(item)}`;\n\n\tconst $bundleItemTopRow = document.createElement('div');\n\t$bundleItemTopRow.className = 'pp-cart-item-info';\n\t$bundleItemTopRow.appendChild($labelDiv);\n\n\tconst $amountDiv = document.createElement('div');\n\t$amountDiv.className = 'pp-item-amount';\n\tconst $amountP = document.createElement('p');\n\t$amountP.classList.add('pp-recalculate-blur'); // Connected to price-update-on-blur behavior\n\tconst $amount = cartItemDisplayAmount(item);\n\tif (parseFloat($amount.replace(/^.*;/, '')) > 0) {\n\t\t$amountP.innerHTML = $amount;\n\t} else {\n\t\t$amountP.innerHTML = '--';\n\t}\n\n\t$amountDiv.appendChild($amountP);\n\t$bundleItemTopRow.appendChild($amountDiv);\n\n\tconst $bundleItemSecondRow = document.createElement('div');\n\t$bundleItemSecondRow.className = 'pp-cart-item-info';\n\t$bundleItemSecondRow.innerHTML = cartItemVariationHTML(item);\n\n\tconst $bundleItemInfoDiv = document.createElement('div');\n\t$bundleItemInfoDiv.className = 'pp-cart-item-info-container';\n\t$bundleItemInfoDiv.appendChild($bundleItemTopRow);\n\t$bundleItemInfoDiv.appendChild($bundleItemSecondRow);\n\n\tconst $bundleItem = document.createElement('div');\n\t$bundleItem.className = 'pp-bundle-summary-item';\n\t$bundleItem.appendChild($imgDiv);\n\t$bundleItem.appendChild($bundleItemInfoDiv);\n\treturn $bundleItem;\n}\n\nfunction renderCartItem(itemBundle: WCCartItem[]): HTMLDivElement | null {\n\tconst item = itemBundle[0];\n\tconst $cartRow = document.createElement('div');\n\n\tif (!item) {\n\t\treturn null;\n\t}\n\n\tconst imageSrc = item.image?.[0] ?? '';\n\tconst showImage = Feature.enabled(FeatureFlag.PRODUCT_IMAGES) && imageSrc && imageSrc !== 'unknown' && imageSrc !== '(unknown)';\n\t$cartRow.className = 'pp-order-summary-item';\n\n\tif (!showImage) {\n\t\t$cartRow.style.gap = '16px';\n\t}\n\n\t// $imgQtyDiv and $itemInfoContainer are the 2 members of the outer flex container ($cartRow)\n\tconst $imgQtyDiv = getImgQtyDiv(item);\n\t// $itemInfoContainer is a vertical flex box that contains $itemInfo, $variationInfo, and each $bundleItem as its flex items\n\tconst $itemInfoContainer = document.createElement('div');\n\t$itemInfoContainer.className = 'pp-cart-item-info-container';\n\t// $itemInfo is a horizontal flexbox that contains all the current item's info\n\tconst $itemInfo = document.createElement('div');\n\t$itemInfo.className = 'pp-cart-item-info';\n\n\tconst $labelDiv = document.createElement('div');\n\t$labelDiv.className = 'pp-item-label';\n\t$labelDiv.innerHTML = cartItemLabel(item);\n\t$itemInfo.appendChild($labelDiv);\n\n\tconst $amountDiv = document.createElement('div');\n\t$amountDiv.className = 'pp-item-amount';\n\tconst $amountP = document.createElement('p');\n\t$amountP.classList.add('pp-recalculate-blur'); // Connected to price-update-on-blur behavior\n\t$amountP.innerHTML = cartItemDisplayAmount(item);\n\t$amountDiv.appendChild($amountP);\n\t$itemInfo.appendChild($amountDiv);\n\n\tconst $removerDiv = document.createElement('div');\n\t$removerDiv.className = 'pp-item-remover';\n\t$removerDiv.innerHTML = `<button class=\"pp-item-remover-btn\" data-qid=\"${item.item_key ?? ''}\">\n\t<img src=\"${trashcanURL}\" class=\"pp-item-remover-img\"/>\n\t<img src=\"${trashcanRedURL}\" class=\"pp-item-remover-hover-img\"/>\n\t</button>`;\n\t$itemInfo.appendChild($removerDiv);\n\n\t$itemInfoContainer.appendChild($itemInfo);\n\n\t// Render variation info\n\tconst $variationInfo = document.createElement('div');\n\t$variationInfo.className = 'pp-cart-item-info';\n\t$variationInfo.innerHTML = cartItemVariationHTML(item);\n\t$itemInfoContainer.appendChild($variationInfo);\n\n\t// Render bundle items\n\tfor (let i = 1; i < itemBundle.length; i++) {\n\t\tconst bundleItem = itemBundle[i];\n\t\tif (!bundleItem) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst $bundleItem = renderBundleItem(bundleItem);\n\t\t$itemInfoContainer.appendChild($bundleItem);\n\t}\n\n\tif ($imgQtyDiv.innerHTML !== '') {\n\t\t$cartRow.appendChild($imgQtyDiv);\n\t}\n\n\t$cartRow.appendChild($itemInfoContainer);\n\treturn $cartRow;\n}\n\nfunction clearOrderSummary(): void {\n\tfor (const $item of $qsAll('.pp-order-summary-item')) {\n\t\t$item.remove();\n\t}\n}\n\nfunction getImgQtyDiv(item: WCCartItem) {\n\tconst imageSrc = item.image?.[0] ?? '';\n\tconst showImage = Feature.enabled(FeatureFlag.PRODUCT_IMAGES) && imageSrc && imageSrc !== 'unknown' && imageSrc !== '(unknown)';\n\tconst showQuantityChanger = Feature.enabled(FeatureFlag.QUANTITY_CHANGER) && !item.is_part_of_bundle;\n\n\tconst $div = document.createElement('div');\n\t$div.className = 'pp-cart-img-qty';\n\n\tif (!showImage && !showQuantityChanger) {\n\t\tif (item.is_part_of_bundle) {\n\t\t\t$div.className = 'pp-cart-img';\n\t\t\treturn $div;\n\t\t}\n\n\t\t$div.className = 'pp-cart-img-qty-empty';\n\t\t$div.innerHTML += buildQuantityChanger(showImage, item);\n\t\treturn $div;\n\t}\n\n\tif (showImage) {\n\t\tif (item.is_part_of_bundle) {\n\t\t\t$div.className = 'pp-cart-img';\n\t\t\t$div.innerHTML = `<div class=\"product-img-td-b0\"><img class=\"pp-bundle-img-size\" src=\"${item.image?.[0] ?? ''}\"/></div>`;\n\t\t\treturn $div;\n\t\t}\n\n\t\t$div.innerHTML = `<div class=\"product-img-td-b0\"><img class=\"pp-product-img-size\" src=\"${item.image?.[0] ?? ''}\"/></div>`;\n\n\t\t$div.innerHTML += buildQuantityChanger(showImage, item);\n\t} else {\n\t\tconst $qtyContainer = document.createElement('div');\n\t\t$qtyContainer.className = 'pp-cart-img-qty-empty';\n\t\t$qtyContainer.innerHTML = buildQuantityChanger(showImage, item);\n\t\t$div.append($qtyContainer);\n\t}\n\n\treturn $div;\n}\n\nfunction buildQuantityChanger(showImage: boolean | string, item: WCCartItem) {\n\tconst width = `${cartItemQuantity(item)}`.length + 1;\n\tconst showQuantityChanger = Feature.enabled(FeatureFlag.QUANTITY_CHANGER) && !item.is_part_of_bundle;\n\tconst quantityNumber = `<div class=\"pp-qty-changer-disabled ${showImage ? 'pp-qty-changer-with-img' : ''}\">${cartItemQuantity(item)}</div>`;\n\tconst quantityChanger = `\n\t<div class=\"quantity-changer ${showImage ? 'pp-qty-changer-with-img' : ''}\">\n\t\t<button type=\"button\" class=\"flex-center qty-btn decrease-qty ${cartItemQuantity(item) <= 1 ? 'pp-qty-scroll-end' : 'pp-qty-btn-hide'}\" data-qid=\"${item.item_key ?? ''}\">\n\t\t\t<img class=\"pp-qty-symbol\" src=\"${qtyMinusImageURL}\">\n\t\t</button>\n\t\t<input type=\"number\" min=\"0\" max=\"${item.stock_qty ? item.stock_qty : ''}\" class=\"qty-fs\" value=\"${cartItemQuantity(item)}\" data-qid=\"${item.item_key ?? ''}\" required style=\"width: ${width}ch;\" role=\"presentation\"/>\n\t\t<button type=\"button\" class=\"flex-center qty-btn increase-qty ${(item.stock_qty && cartItemQuantity(item) >= item.stock_qty) ? 'pp-qty-scroll-end' : 'pp-qty-btn-hide'}\" data-qid=\"${item\n\t.item_key ?? ''}\">\n\t\t\t<img class=\"pp-qty-symbol\" src=\"${qtyPlusImageURL}\">\n\t\t</button>\n\t</div>`;\n\treturn showQuantityChanger ? quantityChanger : quantityNumber;\n}\n","import {$qsAll} from '../../../@shared/ts/dom';\nimport {type IDictionary} from '../../../@type/dictionary';\n\n/**\n * Clears a input of a given query selector\n */\nexport function clearInput(selector: string): void {\n\tfor (const $element of $qsAll<HTMLInputElement>(selector)) {\n\t\t$element.value = '';\n\t}\n}\n\n/**\n * Generates a dropdown html select list from an array of strings as the select data\n */\nexport function renderDropDownList(data: IDictionary, defaultOption = ''): string {\n\tif (!data) {\n\t\tdata = {};\n\t}\n\n\tconst list = Object.entries(data).map(([key, value]) => `<option value=\"${key}\"> ${value} </option>`);\n\n\tif (defaultOption) {\n\t\treturn `<option hidden disabled selected value=\"\">${defaultOption}</option>${list.join('')}`;\n\t}\n\n\treturn list.join('');\n}\n\n/**\n * Selects a HTML select list value or if the value does not exist defaults to the default option.\n */\nexport function selectDropdown($select: HTMLSelectElement | null, value: string): void {\n\tif (!$select) {\n\t\treturn;\n\t}\n\n\t$select.value = value;\n}\n","import {clearInput} from '../util/ui';\nimport {renderOrderNotice, requestCartCalculation} from '../payment/order';\nimport {store} from '../store';\nimport {Feature, startModalLoading, stopModalLoading} from '../reducers/environmentReducer';\nimport {eventClick} from '../util/dom';\nimport {$qsAll, $qs} from '../../../@shared/ts/dom';\nimport {FeatureFlag} from '../../../@type/features';\nimport {type Maybe} from '../../../@shared/ts/maybe';\nimport {getLocaleText} from '../util/translation';\nimport {getErrorString} from '../../../@shared/ts/error';\n\nexport function initCouponInput() {\n\tif (!Feature.enabled(FeatureFlag.COUPON_INPUT)) {\n\t\treturn;\n\t}\n\n\tdisplayCouponFeature();\n\n\thandleCouponInputEvents();\n\thandleCouponRemoval();\n}\n\n/**\n * Shows the coupon inputs. By default the coupon feature is not displayed.\n */\nfunction displayCouponFeature() {\n\tfor (const $form of $qsAll('.coupon-code-option')) {\n\t\t$form.classList.remove('hide');\n\t}\n\n\t$qs('#coupon-code-section')?.classList.remove('hide');\n}\n\nfunction handleCouponInputEvents() {\n\t// For submitting coupon input\n\tfor (const $form of $qsAll<HTMLFormElement>('form.wc-coupon-code')) {\n\t\t$form.addEventListener('submit', async event => {\n\t\t\tevent.preventDefault();\n\n\t\t\tconst data = new FormData((event.target as HTMLFormElement) ?? undefined);\n\t\t\tconst code = (data.get('coupon_code') as string)?.trim() ?? '';\n\n\t\t\tstartCouponLoading();\n\n\t\t\tawait applyCoupon(code);\n\t\t\tawait requestCartCalculation();\n\n\t\t\tstopCouponLoading();\n\t\t});\n\t}\n\n\t// For opening coupon input\n\tfor (const $openCoupon of $qsAll('.coupon-code-option')) {\n\t\t$openCoupon.addEventListener('click', showCouponInput);\n\t\t$openCoupon.addEventListener('keypress', showCouponInput);\n\t}\n}\n\nfunction handleCouponRemoval() {\n\t$qsAll('#pp-summary-lines-body, #pp-summary-lines-body-mobile', $removeButtons => {\n\t\t$removeButtons.addEventListener('click', async (event: Event) => {\n\t\t\tconst $target = event.target as HTMLElement;\n\t\t\tif (!$target) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst $removeButton = $target.closest<HTMLButtonElement>('.pp-coupon-remove-button[data-coupon]');\n\t\t\tif (!$removeButton) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst {coupon} = $removeButton.dataset;\n\t\t\tif (!coupon) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tstore.dispatch(startModalLoading());\n\n\t\t\tawait removeCoupon(coupon);\n\t\t\tawait requestCartCalculation();\n\n\t\t\tstore.dispatch(stopModalLoading());\n\t\t});\n\t});\n}\n\nasync function applyCoupon(code: string): Promise<void> {\n\tconst applyCouponURL = Feature.metadata<string>(FeatureFlag.COUPON_INPUT, 'apply_coupon_url');\n\tconst applyCouponNonce = Feature.dynamicMetadata<string>(FeatureFlag.COUPON_INPUT, 'apply_coupon_nonce');\n\n\tif (!applyCouponURL || !applyCouponNonce) {\n\t\trenderOrderNotice(getLocaleText('Something went wrong. Please try again.'));\n\t\treturn;\n\t}\n\n\tconst formData = new FormData();\n\tformData.append('security', applyCouponNonce);\n\tformData.append('coupon_code', code);\n\n\tconst {error, result} = await fetch(applyCouponURL, {\n\t\tmethod: 'POST',\n\t\tcredentials: 'include',\n\t\tbody: formData,\n\t})\n\t\t.then(async response => response.text())\n\t\t.then(data => ({result: data}))\n\t\t.catch((error: unknown) => ({error})) as Maybe<string>;\n\n\tif (error || !result) {\n\t\tconst errorMessage = getErrorString(error) || getLocaleText('Something went wrong. Please try again.');\n\t\trenderOrderNotice(errorMessage);\n\t\treturn;\n\t}\n\n\tif (result.includes('woocommerce-error')) {\n\t\trenderOrderNotice(result);\n\t\treturn;\n\t}\n\n\trenderOrderNotice(result);\n\thideCouponInput();\n}\n\nasync function removeCoupon(code: string): Promise<boolean> {\n\tconst removeCouponURL = Feature.metadata<string>(FeatureFlag.COUPON_INPUT, 'remove_coupon_url');\n\tconst removeCouponNonce = Feature.dynamicMetadata<string>(FeatureFlag.COUPON_INPUT, 'remove_coupon_nonce');\n\n\tif (!removeCouponNonce || !removeCouponURL) {\n\t\trenderOrderNotice(getLocaleText('Something went wrong. Please try again.'));\n\t\treturn false;\n\t}\n\n\tconst formData = new FormData();\n\tformData.append('security', removeCouponNonce);\n\tformData.append('coupon', code);\n\n\tconst {error, result} = await fetch(removeCouponURL, {\n\t\tmethod: 'POST',\n\t\tcredentials: 'include',\n\t\tbody: formData,\n\t})\n\t\t.then(async response => response.text())\n\t\t.then(data => ({result: data}))\n\t\t.catch((error: unknown) => ({error})) as Maybe<string>;\n\n\tif (error || !result) {\n\t\tconst errorMessage = getErrorString(error) || getLocaleText('Something went wrong. Please try again.');\n\t\trenderOrderNotice(errorMessage);\n\t\treturn false;\n\t}\n\n\tif (result.includes('woocommerce-error')) {\n\t\trenderOrderNotice(result);\n\t\treturn false;\n\t}\n\n\trenderOrderNotice(result);\n\treturn true;\n}\n\nfunction startCouponLoading() {\n\tstore.dispatch(startModalLoading());\n\n\t$qsAll('form.wc-coupon-code input[type=\"submit\"]', (element: HTMLInputElement) => {\n\t\telement.disabled = true;\n\t});\n\n\tfor (const $spinner of $qsAll('.wc-coupon-spinner')) {\n\t\t$spinner.classList.remove('hide');\n\t}\n\n\t// Replace right border of wc-coupon-code-input with spinner\n\tfor (const $border of $qsAll('.wc-coupon-code-input')) {\n\t\t$border.classList.add('remove-right-border');\n\t}\n\n\tfor (const $applyButton of $qsAll<HTMLInputElement>('.wc-coupon-code-apply')) {\n\t\t$applyButton.disabled = true;\n\t}\n}\n\nfunction stopCouponLoading() {\n\tstore.dispatch(stopModalLoading());\n\n\t$qsAll('form.wc-coupon-code input[type=\"submit\"]', (element: HTMLInputElement) => {\n\t\telement.disabled = false;\n\t});\n\n\tfor (const $spinner of $qsAll('.wc-coupon-spinner')) {\n\t\t$spinner.classList.add('hide');\n\t}\n\n\tfor (const $border of $qsAll('.wc-coupon-code-input')) {\n\t\t$border.classList.remove('remove-right-border');\n\t}\n\n\tfor (const $applyButton of $qsAll<HTMLInputElement>('.wc-coupon-code-apply')) {\n\t\t$applyButton.disabled = false;\n\t}\n}\n\nfunction showCouponInput(event: MouseEvent | KeyboardEvent) {\n\tif (!eventClick(event)) {\n\t\treturn;\n\t}\n\n\tfor (const $coupon of $qsAll('form.wc-coupon-code')) {\n\t\t$coupon.classList.remove('hide');\n\t}\n\n\tfor (const $option of $qsAll('.coupon-code-option')) {\n\t\t$option.classList.add('hide');\n\t}\n\n\t$qsAll('.pp-dropdown', ($dd: HTMLElement) => {\n\t\t$dd?.classList.add('shorten');\n\t});\n\n\t$qs('#pp-modal-content')?.addEventListener('mousedown', detectExitTap);\n}\n\nfunction hideCouponInput() {\n\tfor (const $coupon of $qsAll('form.wc-coupon-code')) {\n\t\t$coupon.classList.add('hide');\n\t}\n\n\tfor (const $option of $qsAll('.coupon-code-option')) {\n\t\t$option.classList.remove('hide');\n\t}\n\n\tfor (const $invalid of $qsAll('.wc-invalid-coupon')) {\n\t\t$invalid.classList.add('hide');\n\t}\n\n\t$qsAll('.pp-dropdown', ($dd: HTMLElement) => {\n\t\t$dd?.classList.remove('shorten');\n\t});\n\n\t$qs('#pp-modal-content')?.removeEventListener('mousedown', detectExitTap);\n\tclearInput('.wc-coupon-code-input');\n}\n\nfunction detectExitTap(e: Event) {\n\tfor (const $el of $qsAll('form.wc-coupon-code')) {\n\t\tif ($el.contains(e.target as HTMLElement)) {\n\t\t\treturn;\n\t\t}\n\t}\n\n\thideCouponInput();\n}\n","import {$qsAll} from '../../../@shared/ts/dom';\nimport {type CheckoutData} from '../models/CheckoutData';\nimport {MerchantConfiguration, updateMerchantCurrencyConfig} from '../reducers/merchantConfigurationReducer';\nimport {store} from '../store';\n\nexport function initCurrency(checkoutData: CheckoutData) {\n\tinitCurrencyEvents();\n\n\tstore.dispatch(updateMerchantCurrencyConfig({\n\t\tname: checkoutData.currency_info?.name ?? 'United States Dollar',\n\t\tcode: checkoutData.currency_info?.code ?? 'USD',\n\t\tsymbol: checkoutData?.currency_info?.symbol ?? '$',\n\t\tthousands_separator: checkoutData.currency_info?.thousands_separator ?? ',',\n\t\tdecimal_separator: checkoutData.currency_info?.decimal_separator ?? '.',\n\t\tnumber_of_decimals: checkoutData.currency_info?.number_of_decimals ?? 2,\n\t\tposition: checkoutData.currency_info?.position ?? 'left',\n\t\trounding: checkoutData.currency_info?.rounding ?? 'disabled',\n\t\thidden: checkoutData.currency_info?.hidden ?? false,\n\t}));\n}\n\nfunction initCurrencyEvents() {\n\t// Set currency symbols whenever the modal currency state changes.\n\tstore.subscribe(() => {\n\t\trenderCurrencySymbols();\n\t});\n}\n\n/**\n * Renders the text content of all elements with the class\n * \".currency-symbol,.currency-symbol-after\" with the\n * current currency values.\n */\nfunction renderCurrencySymbols() {\n\tconst {position, symbol} = MerchantConfiguration.currency.configuration();\n\n\tconst right = position === 'right' || position === 'right_space';\n\tfor (const $element of $qsAll(`.currency-symbol${right ? '-after' : ''}`)) {\n\t\t$element.innerHTML = symbol;\n\t}\n}\n","function peachpayUpdateCurrencyCookie(newCurrency: string) {\n\tdocument.cookie = `pp_active_currency=${newCurrency};path=/`;\n}\n\nexport {peachpayUpdateCurrencyCookie};\n","import {selectDropdown} from '../util/ui';\nimport {type ICurrencyConfiguration} from '../../../@type/woocommerce/currency-configuration';\nimport {type IDictionary} from '../../../@type/dictionary';\nimport {Feature, setFeatureSupport, startModalLoading, stopModalLoading} from '../reducers/environmentReducer';\nimport {store} from '../store';\nimport {MerchantConfiguration, updateMerchantCurrencyConfig} from '../reducers/merchantConfigurationReducer';\nimport {requestCartCalculation} from '../payment/order';\nimport {getLocaleText} from '../util/translation';\nimport {PeachPayCustomer} from '../reducers/peachPayCustomerReducer';\nimport {type CurrencyDefaultsTo, type ICurrencySwitcherFeatureConfig} from '../models/ICurrencySwitcherFeatureConfig';\nimport {$qsAll, $qs} from '../../../@shared/ts/dom';\nimport {FeatureFlag} from '../../../@type/features';\nimport {setSelectedPaymentGateway} from '../reducers/paymentConfigurationReducer';\nimport {SDKFlags} from '../sdk';\nimport {peachpayUpdateCurrencyCookie} from '../../../@shared/ts/currency';\nimport {captureSentryException} from '../../../@shared/ts/sentry';\nimport {type IResponse} from '../../../@type/response';\n\n/**\n * Initializes the currency switch function for peachpay\n */\nexport function initCurrencySwitcher() {\n\tif (!Feature.enabled(FeatureFlag.CURRENCY_SWITCHER_INPUT)) {\n\t\treturn;\n\t}\n\n\twindow.addEventListener('pp-update-currency-switcher-feature', updateCurrencySwitcherFeature);\n\trenderCurrencySelector();\n}\n\n/**\n * Renders the currency selector in the modal with all it's options\n */\nfunction renderCurrencySelector(): void {\n\t// Make sure any previous versions of the dropdown are deleted on render\n\t$qsAll('#pp_currency_select, #pp_currency_select_div', $removeSelector => {\n\t\t$removeSelector.remove();\n\t});\n\n\t// Insertion locations\n\tconst $insertionLocationNew = $qs('#pp-summary-body')?.parentElement;\n\tconst $insertionLocationMobile = $qs('#pp-pms-new-container');\n\n\t// Required globals\n\tconst currencyInfo = Feature.metadata<Record<string, ICurrencyConfiguration>>(FeatureFlag.CURRENCY_SWITCHER_INPUT, 'currency_info');\n\tif (!currencyInfo || Object.keys(currencyInfo).length < 2) {\n\t\treturn;\n\t}\n\n\t$insertionLocationNew?.insertAdjacentElement('afterend', buildCurrencySelectDiv(currencyInfo));\n\t$insertionLocationMobile?.insertAdjacentElement('afterend', buildCurrencySelectDiv(currencyInfo, 'pp-currency-mobile'));\n}\n\nfunction buildCurrencySelectDiv(data: Record<string, ICurrencyConfiguration>, customClasses = ''): Element {\n\tconst $options = renderCurrencyList(getCurrencyDropDownInfo(data), MerchantConfiguration.currency.code());\n\n\t// Selector div and title creation\n\tconst currencyContainer = document.createElement('div');\n\tconst $currencySelectTitle = document.createElement('span');\n\t$currencySelectTitle.innerHTML = getLocaleText('Currency');\n\t$currencySelectTitle.setAttribute('class', 'pp-title');\n\tcurrencyContainer.id = 'pp_currency_select_div';\n\tcurrencyContainer.setAttribute('class', 'pp-section-mb ' + customClasses);\n\tcurrencyContainer.append($currencySelectTitle);\n\n\tconst $currencySelect = document.createElement('select');\n\t$currencySelect.innerHTML = $options;\n\t$currencySelect.classList.add('pp-currency-selector');\n\tselectDropdown($currencySelect, MerchantConfiguration.currency.code());\n\tconst selectContainer = document.createElement('div');\n\tselectContainer.classList.add('pp-currency-selector-container');\n\tselectContainer.append($currencySelect);\n\tcurrencyContainer.append(selectContainer);\n\n\t// Event listeners for the dropdowns\n\t$currencySelect.addEventListener('change', currencyEventListener);\n\n\treturn currencyContainer as Element;\n}\n\nfunction getCurrencyDropDownInfo(currencyInfo: Record<string, ICurrencyConfiguration>): Record<string, string> {\n\t// Dropdown list data\n\tconst mappedCurrencies = {} as Record<string, string>;\n\tfor (const [key, currency] of Object.entries(currencyInfo)) {\n\t\tif (currency?.hidden) {\n\t\t\tmappedCurrencies[key + ' disabled'] = `(${currency.symbol}) - ${currency.name}`;\n\t\t} else {\n\t\t\tmappedCurrencies[key] = `(${currency.symbol}) - ${currency.name}`;\n\t\t}\n\t}\n\n\treturn mappedCurrencies;\n}\n\n/**\n * This function fires off a new Type of peachpay event called the currency Switch Event\n * This event will update the cookie on the woocommerce side allowing recalculation of Cart totals and order values to be correctly\n * Displayed\n * @param currency (the currency we will past to the window)\n */\nfunction sendCurrencySwitchMessage(currency: string): void {\n\tpeachpayUpdateCurrencyCookie(currency);\n\tSDKFlags.setReload();\n}\n\nasync function currencyEventListener(event: Event) {\n\tevent.preventDefault();\n\n\tconst currencyInfo = Feature.metadata<Record<string, ICurrencyConfiguration>>(FeatureFlag.CURRENCY_SWITCHER_INPUT, 'currency_info');\n\tconst $target = event.target as HTMLSelectElement;\n\t$target.blur();\n\tif (currencyInfo?.[$target.value] && $target.value !== MerchantConfiguration.currency.code()) {\n\t\tstore.dispatch(startModalLoading());\n\n\t\tstore.dispatch(updateMerchantCurrencyConfig({\n\t\t\t...MerchantConfiguration.currency.configuration(),\n\t\t\tcode: (currencyInfo?.[$target.value]?.code ?? MerchantConfiguration.currency.code()),\n\t\t}));\n\n\t\t// This event is to update the currency on the php side so we get the right currency in the modal\n\t\tsendCurrencySwitchMessage($target.value);\n\n\t\tawait requestCartCalculation();\n\n\t\tconst config = currencyInfo?.[$target.value];\n\t\tif (config) {\n\t\t\tstore.dispatch(updateMerchantCurrencyConfig(config));\n\t\t}\n\n\t\tstore.dispatch(stopModalLoading());\n\t}\n}\n\n/**\n * Generates a dropdown html select list for currencies since the default should not be the printed value it should be the selected value\n */\nfunction renderCurrencyList(data: IDictionary, defaultOption = ''): string {\n\tif (!data) {\n\t\tdata = {};\n\t}\n\n\tconst list = Object.entries(data).map(([key, value]) => `<option value=${key} ${(key === defaultOption) ? 'selected' : ''}> ${value} </option>`);\n\n\treturn list.join('');\n}\n\n/**\n * Syncs merchant currency config info with currency cookie if cookie changed\n * since last time site reloaded.\n */\nfunction refreshCurrencySelected() {\n\tconst currency = MerchantConfiguration.currency.code();\n\tconst currencyInfo = Feature.metadata<Record<string, ICurrencyConfiguration>>(FeatureFlag.CURRENCY_SWITCHER_INPUT, 'currency_info');\n\n\tif (!currency || currencyInfo === null || !(currency in currencyInfo)) {\n\t\treturn;\n\t}\n\n\tsendCurrencySwitchMessage(currency);\n}\n\n/**\n * Returns false if feature enabled, otherwise returns CurrencyDefaultsTo\n */\nfunction getCurrencyDefaultTo(): CurrencyDefaultsTo | null {\n\treturn Feature.metadata<CurrencyDefaultsTo>(FeatureFlag.CURRENCY_SWITCHER_INPUT, 'how_currency_defaults');\n}\n\n/**\n * Retrieves and updates selected currency and currency switcher to new modal data for a given country\n * @param country Country code string\n */\nasync function updateCurrencySwitcherForCountry(country: string) {\n\tconst response = await fetch('/?wc-ajax=pp-get-modal-currency-data', {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\tcredentials: 'same-origin',\n\t\t\t'currency-country': country,\n\t\t},\n\t});\n\n\tif (!response.ok) {\n\t\tconst error = new Error('Unable to retrieve country currency');\n\t\tcaptureSentryException(error);\n\t\tthrow error;\n\t}\n\n\tconst result = await response.json() as IResponse<ICurrencySwitcherFeatureConfig>;\n\tif (!result.success && !result.data) {\n\t\treturn;\n\t}\n\n\tconst countryCSinput = result.data;\n\n\tif (!countryCSinput) {\n\t\treturn;\n\t}\n\n\tconst switcherEnabledForCountry = countryCSinput.enabled;\n\tconst curFeatureState = store.getState().environment.plugin.featureSupport;\n\n\tcurFeatureState['currency_switcher_input'] = countryCSinput;\n\tstore.dispatch(setFeatureSupport(curFeatureState));\n\n\tif (!switcherEnabledForCountry && countryCSinput.metadata.active_currency) {\n\t\tsendCurrencySwitchMessage(countryCSinput.metadata.active_currency.code);\n\t\tstore.dispatch(updateMerchantCurrencyConfig(countryCSinput.metadata.active_currency));\n\t} else if (switcherEnabledForCountry && !(MerchantConfiguration.currency.code() in countryCSinput.metadata.currency_info)) {\n\t\tsendCurrencySwitchMessage(countryCSinput.metadata.set_cur);\n\t\tconst config = countryCSinput.metadata.currency_info?.[countryCSinput.metadata.set_cur];\n\t\tif (config) {\n\t\t\tstore.dispatch(updateMerchantCurrencyConfig(config));\n\t\t}\n\t} else {\n\t\tsendCurrencySwitchMessage(MerchantConfiguration.currency.code());\n\t}\n}\n\n/**\n * Handles the pp-update-currency-switcher-feature event. Refreshes currency switcher data\n * as needed.\n */\nasync function updateCurrencySwitcherFeature() {\n\tstore.dispatch(startModalLoading());\n\n\tif (getCurrencyDefaultTo() === 'billing_country' && PeachPayCustomer.billing.country() && PeachPayCustomer.billing.country() !== '') {\n\t\tpeachpayUpdateCurrencyCookie(PeachPayCustomer.billing.country());\n\n\t\tawait updateCurrencySwitcherForCountry(PeachPayCustomer.billing.country());\n\t}\n\n\tawait requestCartCalculation();\n\trenderCurrencySelector();\n\n\trefreshCurrencySelected();\n\tstore.dispatch(stopModalLoading());\n}\n\nfunction setupCurrencyFallbackEvents() {\n\t$qs('body')?.addEventListener('click', async event => {\n\t\tconst $target = event.target as HTMLElement;\n\t\tconst $button = $target?.closest<HTMLElement>('.currency-fallback-button');\n\t\tif (!$button) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst gatewayId = $button.dataset['gateway'] ?? '';\n\t\tconst defaultCurrency = $button.dataset['currency'] ?? '';\n\n\t\tconst currencyInfo = Feature.metadata<Record<string, ICurrencyConfiguration>>(FeatureFlag.CURRENCY_SWITCHER_INPUT, 'currency_info');\n\t\tconst config = currencyInfo?.[defaultCurrency];\n\t\tif (!config) {\n\t\t\treturn;\n\t\t}\n\n\t\tstore.dispatch(startModalLoading());\n\t\tstore.dispatch(updateMerchantCurrencyConfig(config));\n\t\tpeachpayUpdateCurrencyCookie(defaultCurrency);\n\n\t\tstore.dispatch(setSelectedPaymentGateway(gatewayId));\n\n\t\tawait requestCartCalculation();\n\n\t\t$qsAll<HTMLSelectElement>('.pp-currency-selector', $el => {\n\t\t\tselectDropdown($el, defaultCurrency);\n\t\t});\n\n\t\tstore.dispatch(stopModalLoading());\n\t});\n}\n\nexport {\n\tsetupCurrencyFallbackEvents,\n};\n","import {$qsAll} from '../../../@shared/ts/dom';\nimport {FeatureFlag} from '../../../@type/features';\nimport {Feature} from '../reducers/environmentReducer';\nimport {store} from '../store';\n\nexport function initCustomOrderMessaging() {\n\tif (Feature.enabled(FeatureFlag.STORE_SUPPORT_MESSAGE)) {\n\t\tstore.subscribe(() => {\n\t\t\trenderCustomOrderMessaging();\n\t\t});\n\t}\n}\n\nfunction renderCustomOrderMessaging() {\n\tconst text = Feature.metadata<string>(FeatureFlag.STORE_SUPPORT_MESSAGE, 'text');\n\tconst type = Feature.metadata<string>(FeatureFlag.STORE_SUPPORT_MESSAGE, 'type');\n\n\tif (text && type) {\n\t\tif (type === 'inline') {\n\t\t\t$qsAll('.pp-custom-order-message-inline').forEach(($el: HTMLElement) => {\n\t\t\t\t$el.classList.remove('hide');\n\t\t\t});\n\t\t} else {\n\t\t\t$qsAll('#pp-custom-order-message-hover', ($el: HTMLElement) => {\n\t\t\t\t$el.classList.remove('hide');\n\t\t\t});\n\t\t}\n\n\t\tconst $temp = document.createElement('div');\n\t\t$temp.innerHTML = text;\n\t\t// Links in the modal can break stuff so always target a new tab.\n\t\t$temp.querySelectorAll('a').forEach($a => {\n\t\t\t$a.setAttribute('target', '_blank');\n\t\t});\n\n\t\t/**\n         * Removes all elements that are not allowed in the custom order message. Mutates the element passed in.\n         */\n\t\tconst cleanSupportMessageHTML = (element: HTMLElement) => {\n\t\t\tconst childrenElements = Array.from(element.children);\n\t\t\tfor (const child of childrenElements) {\n\t\t\t\tif (!['A', 'BR', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'P', 'DIV', 'LI', 'UL', 'OL', 'SPAN', 'IMG'].includes(child.tagName)) {\n\t\t\t\t\tchild.remove();\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (child.children.length > 0) {\n\t\t\t\t\tcleanSupportMessageHTML(child as HTMLElement);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tcleanSupportMessageHTML($temp);\n\n\t\t$qsAll('.pp-custom-order-message', ($el: HTMLElement) => {\n\t\t\t$el.innerHTML = $temp.innerHTML;\n\t\t});\n\t} else {\n\t\t$qsAll('.pp-custom-order-message-inline').forEach(($el: HTMLElement) => {\n\t\t\t$el.classList.add('hide');\n\t\t});\n\t\t$qsAll('#pp-custom-order-message-hover', ($el: HTMLElement) => {\n\t\t\t$el.classList.add('hide');\n\t\t});\n\t}\n}\n","import {clearInput} from '../util/ui';\nimport {renderOrderNotice, requestCartCalculation} from '../payment/order';\nimport {store} from '../store';\nimport {Feature, startModalLoading, stopModalLoading} from '../reducers/environmentReducer';\nimport {$qsAll, $qs} from '../../../@shared/ts/dom';\nimport {FeatureFlag} from '../../../@type/features';\nimport {maybeFetchWP} from '../../../@shared/ts/maybe';\nimport {getErrorString} from '../../../@shared/ts/error';\nimport {getLocaleText} from '../util/translation';\nimport {eventClick} from '../util/dom';\n\nexport function initGiftCardInput() {\n\tif (!Feature.enabled(FeatureFlag.GIFTCARD_INPUT)) {\n\t\treturn;\n\t}\n\n\tdisplayGiftCardFeature();\n\n\thandleGiftcardInputEvents();\n}\n\nfunction displayGiftCardFeature() {\n\tfor (const $form of $qsAll('.gift-card-option')) {\n\t\t$form.classList.remove('hide');\n\t}\n\n\t$qs('#gift-card-section')?.classList.remove('hide');\n}\n\nasync function applyGiftCard(giftCardNumber: string): Promise<void> {\n\tconst ajaxURL = Feature.metadata<string>(FeatureFlag.EXPRESS_CHECKOUT, 'admin_ajax_url');\n\tconst applyGiftcardNonce = Feature.dynamicMetadata<string>(FeatureFlag.GIFTCARD_INPUT, 'pw_gift_cards_apply_nonce');\n\tif (!ajaxURL || !applyGiftcardNonce) {\n\t\trenderOrderNotice(getLocaleText('Something went wrong. Please try again.'));\n\t\treturn;\n\t}\n\n\tconst formData = new FormData();\n\tformData.append('action', 'pw-gift-cards-redeem');\n\tformData.append('card_number', giftCardNumber);\n\tformData.append('security', applyGiftcardNonce);\n\n\tconst {error, result} = await maybeFetchWP<{success: boolean; data?: {message: string}}>(ajaxURL, {\n\t\tmethod: 'POST',\n\t\tbody: formData,\n\t});\n\n\tconst defaultErrorMessage = getLocaleText('Something went wrong. Please try again.');\n\tif (error || !result) {\n\t\tconst errorMessage = getErrorString(error) || defaultErrorMessage;\n\t\trenderOrderNotice(errorMessage);\n\t\treturn;\n\t}\n\n\tif (!result.success) {\n\t\trenderOrderNotice(result.data?.message ? result.data.message : defaultErrorMessage);\n\t\treturn;\n\t}\n\n\tif (result.data?.message) {\n\t\trenderOrderNotice(result.data.message);\n\t}\n\n\thideGiftCardInput();\n}\n\nfunction handleGiftcardInputEvents() {\n\t// For submitting gift card input\n\tfor (const $form of $qsAll<HTMLFormElement>('form.pw-wc-gift-card')) {\n\t\t$form.addEventListener('submit', async event => {\n\t\t\tevent.preventDefault();\n\n\t\t\tif (!$form.checkValidity()) {\n\t\t\t\t$form.reportValidity();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tshowGiftCardLoadingState();\n\n\t\t\tconst data = new FormData(event.target as HTMLFormElement);\n\t\t\tconst giftCardNumber = (data.get('card_number') as string)?.trim() ?? '';\n\n\t\t\tawait applyGiftCard(giftCardNumber);\n\t\t\tawait requestCartCalculation();\n\n\t\t\thideGiftCardLoadingState();\n\t\t});\n\t}\n\n\t// For opening gift card input\n\tfor (const $giftCard of $qsAll('.gift-card-option')) {\n\t\t$giftCard.addEventListener('click', showGiftCardInput);\n\t\t$giftCard.addEventListener('keypress', showGiftCardInput);\n\t}\n}\n\nfunction showGiftCardInput(event: MouseEvent | KeyboardEvent) {\n\tif (!eventClick(event)) {\n\t\treturn;\n\t}\n\n\tfor (const $coupon of $qsAll('form.pw-wc-gift-card')) {\n\t\t$coupon.classList.remove('hide');\n\t}\n\n\tfor (const $option of $qsAll('.gift-card-option')) {\n\t\t$option.classList.add('hide');\n\t}\n\n\t$qsAll('.pp-dropdown', ($dd: HTMLElement) => {\n\t\t$dd?.classList.add('shorten');\n\t});\n\n\t$qs('#pp-modal-content')?.addEventListener('mousedown', detectExitTap);\n}\n\nfunction hideGiftCardInput() {\n\tfor (const $giftCard of $qsAll('form.pw-wc-gift-card')) {\n\t\t$giftCard.classList.add('hide');\n\t}\n\n\tfor (const $option of $qsAll('.gift-card-option')) {\n\t\t$option.classList.remove('hide');\n\t}\n\n\t$qsAll('.pp-dropdown', ($dd: HTMLElement) => {\n\t\t$dd?.classList.remove('shorten');\n\t});\n\n\t$qs('#pp-modal-content')?.removeEventListener('mousedown', detectExitTap);\n\tclearInput('.wc-gift-card-input');\n}\n\nfunction detectExitTap(e: Event) {\n\tfor (const $el of $qsAll('form.pw-wc-gift-card')) {\n\t\tif ($el.contains(e.target as HTMLElement)) {\n\t\t\treturn;\n\t\t}\n\t}\n\n\thideGiftCardInput();\n}\n\nfunction hideGiftCardLoadingState() {\n\tstore.dispatch(stopModalLoading());\n\n\tfor (const $spinner of $qsAll('.wc-coupon-spinner')) {\n\t\t$spinner.classList.add('hide');\n\t}\n\n\tfor (const $border of $qsAll('.wc-gift-card-input')) {\n\t\t$border.classList.remove('remove-right-border');\n\t}\n\n\tfor (const $applyButton of $qsAll<HTMLInputElement>('.gift-card-apply')) {\n\t\t$applyButton.disabled = false;\n\t}\n}\n\nfunction showGiftCardLoadingState() {\n\tstore.dispatch(startModalLoading());\n\n\tfor (const $spinner of $qsAll('.wc-coupon-spinner')) {\n\t\t$spinner.classList.remove('hide');\n\t}\n\n\t// Replace right border of gift-card-input with spinner\n\tfor (const $border of $qsAll('.wc-gift-card-input')) {\n\t\t$border.classList.add('remove-right-border');\n\t}\n\n\tfor (const $applyButton of $qsAll<HTMLInputElement>('.gift-card-apply')) {\n\t\t$applyButton.disabled = true;\n\t}\n}\n","import {Feature, startModalLoading, stopModalLoading} from '../reducers/environmentReducer';\nimport {FeatureFlag} from '../../../@type/features';\nimport {addAction} from '../../../@shared/ts/hooks';\nimport {captureSentryException} from '../../../@shared/ts/sentry';\nimport {$qs, $qsAll} from '../../../@shared/ts/dom';\nimport {store} from '../store';\nimport {requestCartCalculation} from '../payment/order';\nimport {addProductToCart} from '../util/cart';\nimport spinnerImageURL from '../../img/spinner.svg';\n\ntype UpsellFlow = 'pp_button' | 'before_payment';\ntype UpsellProduct = {\n\t'id': string;\n\t'name': string;\n\t'price': string;\n\t'image': string;\n};\n\nexport function initOneClickUpsell() {\n\tif (!Feature.enabled(FeatureFlag.ONE_CLICK_UPSELL)) {\n\t\treturn;\n\t}\n\n\tconst upsellFlow = Feature.metadata<UpsellFlow>(FeatureFlag.ONE_CLICK_UPSELL, 'pp_ocu_flow');\n\tif (!upsellFlow) {\n\t\tthrow new Error('Invalid OCU flow action. Expected a non empty string. Received: ' + String(upsellFlow));\n\t}\n\n\tconst shownProducts: string[] = [];\n\tconst oneClickUpsell = async () => {\n\t\ttry {\n\t\t\tconst upsellProduct = Feature.dynamicMetadata<UpsellProduct>(FeatureFlag.ONE_CLICK_UPSELL, 'pp_ocu_products');\n\t\t\tif (!upsellProduct) {\n\t\t\t\tthrow new Error(`Invalid OCU product. Expected an object. Received: ${String(upsellProduct)}`);\n\t\t\t}\n\n\t\t\tif (shownProducts.includes(upsellProduct.id)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tshownProducts.push(upsellProduct.id);\n\n\t\t\tstore.dispatch(stopModalLoading());\n\t\t\tawait promptOneClickUpsell(upsellProduct);\n\t\t\tstore.dispatch(startModalLoading());\n\t\t} catch (err: unknown) {\n\t\t\tif (err instanceof Error) {\n\t\t\t\tconsole.error('Handled error:', err);\n\t\t\t\tcaptureSentryException(err);\n\t\t\t}\n\t\t}\n\t};\n\n\tif (upsellFlow === 'pp_button') {\n\t\taddAction('after_modal_open', oneClickUpsell);\n\t} else if (upsellFlow === 'before_payment') {\n\t\taddAction('after_payment_page', oneClickUpsell);\n\t}\n}\n\nasync function promptOneClickUpsell(upsellProduct: UpsellProduct): Promise<void> {\n\tconst headline = Feature.metadata<string>(FeatureFlag.ONE_CLICK_UPSELL, 'headline_text');\n\tif (!headline) {\n\t\tthrow new Error(`Invalid OCU headline text. Expected a non empty string. Received: ${String(headline)}`);\n\t}\n\n\tconst subHeadline = Feature.metadata<string>(FeatureFlag.ONE_CLICK_UPSELL, 'sub_headline_text');\n\tif (subHeadline && typeof subHeadline !== 'string') {\n\t\tthrow new Error(`Invalid OCU sub headline text. Expected a non empty string. Received: ${String(subHeadline)}`);\n\t}\n\n\tconst acceptText = Feature.metadata<string>(FeatureFlag.ONE_CLICK_UPSELL, 'accept_button_text');\n\tif (!acceptText) {\n\t\tthrow new Error(`Invalid OCU accept button text. Expected a non empty string. Received: ${String(acceptText)}`);\n\t}\n\n\tconst declineText = Feature.metadata<string>(FeatureFlag.ONE_CLICK_UPSELL, 'decline_button_text');\n\tif (!declineText) {\n\t\tthrow new Error(`Invalid OCU decline button text. Expected a non empty string. Received: ${String(declineText)}`);\n\t}\n\n\tconst customDescription = Feature.metadata<string>(FeatureFlag.ONE_CLICK_UPSELL, 'custom_description');\n\tif (customDescription && typeof customDescription !== 'string') {\n\t\tthrow new Error(`Invalid OCU custom description. Expected a string. Received: ${String(customDescription)}`);\n\t}\n\n\treturn new Promise((resolve, _reject) => {\n\t\tconst $container = document.createElement('div');\n\t\t$container.id = 'pp-ocu-container';\n\n\t\t// eslint-disable-next-line spaced-comment\n\t\t$container.innerHTML = /*html*/`\n\t\t<div id=\"pp-ocu-backdrop\" data-close-ocu>\n\t\t\t<div id=\"pp-ocu-body\">\n\t\t\t\t<button class=\"pp-ocu-x\" data-close-ocu>&times;</button>\n\n\t\t\t\t<div class=\"pp-ocu-headline\">${headline}</div>\n\t\t\t\t<div class=\"pp-ocu-sub-headline ${subHeadline ? '' : 'hide'}\">${subHeadline ?? ''}</div>\n\n\t\t\t\t<img class=\"pp-ocu-product-img\" src=\"${upsellProduct.image}\">\n\n\t\t\t\t<div class=\"pp-ocu-product-name\">${upsellProduct.name}</div>\n\t\t\t\t<div class=\"pp-ocu-product-description ${customDescription ? '' : 'hide'}\">${customDescription ?? ''}</div>\n\t\t\t\t\n\t\t\t\t<div class=\"pp-ocu-product-price\">${upsellProduct.price}</div>\n\n\t\t\t\t<button class=\"pp-ocu-accept-button\" data-ocu-product-id=\"${upsellProduct.id}\">${acceptText}</button>\n\t\t\t\t<button class=\"pp-ocu-decline-button\">${declineText}</button>\n\t\t\t</div>\n\t\t</div>`;\n\n\t\tdocument.body.appendChild($container);\n\n\t\tconst destroyPrompt = () => {\n\t\t\t$container.remove();\n\t\t};\n\n\t\t// Add listener for closing the OCU page either by clicking the \"x\"\n\t\t// button or by the \"Decline\" button.\n\t\t$qsAll('.pp-ocu-x,.pp-ocu-decline-button', $el => {\n\t\t\t$el.addEventListener('click', e => {\n\t\t\t\te.preventDefault();\n\n\t\t\t\tdestroyPrompt();\n\t\t\t\tresolve();\n\t\t\t});\n\t\t});\n\n\t\t// Event listener for the \"Accept\" button.\n\t\t$qs('.pp-ocu-accept-button')?.addEventListener('click', async e => {\n\t\t\te.preventDefault();\n\n\t\t\tconst $target = e.target as HTMLButtonElement;\n\t\t\tconst productId = Number.parseInt(upsellProduct.id);\n\n\t\t\tconst markup = $target.innerHTML;\n\t\t\t$target.disabled = true;\n\t\t\t$target.innerHTML = `<img src=\"${spinnerImageURL}\" style=\"height: 1em;\"/>`;\n\n\t\t\tawait addProductToCart(productId);\n\t\t\tawait requestCartCalculation();\n\n\t\t\t$target.disabled = false;\n\t\t\t$target.innerHTML = markup;\n\n\t\t\tdestroyPrompt();\n\t\t\tresolve();\n\t\t});\n\t});\n}\n","import {type GatewayConfiguration, GatewayEligibility} from '../models/GatewayConfiguration';\nimport {startModalLoading, stopModalLoading} from '../reducers/environmentReducer';\nimport {type GatewayEligibilityContext, PaymentConfiguration, setSelectedPaymentGateway} from '../reducers/paymentConfigurationReducer';\nimport {store} from '../store';\nimport {getLocaleText} from '../util/translation';\nimport {requestCartCalculation} from '../payment/order';\nimport {$qs, $qsAll} from '../../../@shared/ts/dom';\n\nimport ellipsisImageURL from '../../img/dot-dot-dot.svg';\nimport helpImageURL from '../../img/property-help.svg';\nimport {setupCurrencyFallbackEvents} from './currencySwitch';\n\nfunction initPaymentGatewaySelector() {\n\tsetupPrimaryOptionsEvents();\n\tsetupSecondaryOptionsEvents();\n\tsetupCurrencyFallbackEvents();\n\n\tstore.subscribe(() => {\n\t\tconst sortedEligibilityContext = PaymentConfiguration.sortGatewaysByEligibility();\n\t\tconst unmountedElements = (selector: string) => $qsAll<HTMLDivElement>(selector).reduce<Record<string, HTMLDivElement>>((acc, $el) => {\n\t\t\tconst gatewayId = $el.dataset['gateway'] ?? '';\n\t\t\t$el.remove();\n\n\t\t\tacc[gatewayId] = $el;\n\n\t\t\treturn acc;\n\t\t}, {});\n\n\t\t// Render/rerender primary gateway options\n\t\tconst unmountedPrimaryElements = unmountedElements('.pp-pms .primary-option[data-gateway]');\n\t\tfor (const context of sortedEligibilityContext) {\n\t\t\trenderPrimaryOption(context, unmountedPrimaryElements[context.config.gatewayId]);\n\t\t}\n\n\t\t// Render/rerender primary more option\n\t\trenderPrimaryMoreOption();\n\n\t\t// Render/rerender secondary gateway options\n\t\tconst unmountedSecondaryElements = unmountedElements('.pp-pms .secondary-option[data-gateway]');\n\t\tfor (const context of sortedEligibilityContext) {\n\t\t\trenderSecondaryOption(context, unmountedSecondaryElements[context.config.gatewayId]);\n\t\t}\n\n\t\t// Render/rerender gateway descriptions\n\t\tfor (const context of sortedEligibilityContext) {\n\t\t\trenderGatewayDescription(context);\n\t\t}\n\n\t\trenderEligibilityDescription(PaymentConfiguration.gatewayConfig(PaymentConfiguration.selectedGateway()));\n\t});\n}\n\nfunction setupPrimaryOptionsEvents() {\n\t$qs('.pp-pms')?.addEventListener('click', async e => {\n\t\tconst $target = e.target as HTMLElement | null;\n\t\tconst $pmType = $target?.closest<HTMLDivElement>('.pp-pm-type:not(.pp-more-options)');\n\n\t\tif (!$pmType) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst gatewayId = $pmType.dataset['gateway'] ?? '';\n\n\t\tstore.dispatch(startModalLoading());\n\t\tstore.dispatch(setSelectedPaymentGateway(gatewayId));\n\t\tawait requestCartCalculation();\n\t\tstore.dispatch(stopModalLoading());\n\t});\n\n\t$qs('.pp-pms')?.addEventListener('keydown', e => {\n\t\tif (e.key === 'Enter') {\n\t\t\tconst $target = e.target as HTMLDivElement;\n\t\t\t$target.click();\n\t\t}\n\t});\n}\n\nfunction renderPrimaryOption(context: GatewayEligibilityContext, $el: HTMLDivElement | undefined) {\n\tconst {config, eligibility, displayIndex} = context;\n\tconst isSelected = PaymentConfiguration.selectedGateway() === config.gatewayId;\n\tconst isHidden = !eligibility || displayIndex === undefined || displayIndex >= 3;\n\n\tif ($el) {\n\t\t$el.classList.toggle('selected', isSelected);\n\t\t$el.classList.toggle('hide', isHidden);\n\t\t$el.classList.toggle('pp-pm-alert', eligibility !== GatewayEligibility.Eligible);\n\n\t\t// Add element back to the DOM in the new order\n\t\t$qs('.pp-pm-type.pp-more-options')?.insertAdjacentElement('beforebegin', $el);\n\t} else {\n\t\t$qs('.pp-pm-type.pp-more-options')?.insertAdjacentHTML('beforebegin', `\n\t\t\t<div class=\"pp-pm-type primary-option ${isSelected ? 'selected' : ''} ${isHidden ? 'hide' : ''}\" tabindex=\"0\" role=\"button\" data-gateway=\"${config.gatewayId}\" >\n\t\t\t\t<img class=\"pp-pm-full-badge\" src=\"${config.assets.badge.src}\" draggable=\"false\">\n\t\t\t\t<div class=\"pp-pm-type-content\" style=\"display:flex;gap:4px\">\n\t\t\t\t\t<span>${config.name}</span>\n\t\t\t\t</div>\n\t\t\t</div>`,\n\t\t);\n\t}\n}\n\nfunction renderPrimaryMoreOption() {\n\tconst isHidden = PaymentConfiguration.eligibleGatewayCount() <= 3;\n\n\tconst $el = $qs<HTMLElement>('.pp-pm-type.pp-more-options');\n\tif ($el) {\n\t\t$el.classList.toggle('hide', isHidden);\n\t} else {\n\t\t$qs('.pp-pms div.header')?.insertAdjacentHTML('beforeend', `\n\t\t\t<div class=\"pp-pm-type pp-more-options ${isHidden ? 'hide' : ''}\" tabindex=\"0\" role=\"button\">\n\t\t\t\t<img class=\"pp-pm-more-options\" src=\"${ellipsisImageURL}\" draggable=\"false\">\n\t\t\t\t<span class=\"pp-pm-more-container hide\">\n\t\t\t\t\t<ul class=\"pp-pm-more\"></ul>\n\t\t\t\t</span>\n\t\t\t\t<span class=\"pp-question-mark hide\">\n\t\t\t\t\t<img class=\"pp-pm-help-badge\" src=\"${helpImageURL}\">\n\t\t\t\t</span>\n\t\t\t</div>`,\n\t\t);\n\t}\n}\n\nfunction setupSecondaryOptionsEvents() {\n\t// Hide secondary options overlay if clicking anywhere outside of it.\n\t$qs('body')?.addEventListener('click', e => {\n\t\tconst $target = e.target as HTMLElement | null;\n\t\tconst $pmOptionSelector = $target?.closest<HTMLElement>('.pp-pm-more-container');\n\n\t\tif (!$pmOptionSelector) {\n\t\t\t$qsAll('.secondary-option').forEach($el => {\n\t\t\t\t$el.setAttribute('tabindex', '-1');\n\t\t\t});\n\t\t\t$qs('.pp-pm-more-container')?.classList.add('hide');\n\t\t}\n\t});\n\n\t$qs('.pp-pms')?.addEventListener('click', async e => {\n\t\tconst $target = e.target as HTMLElement | null;\n\t\tconst $pmType = $target?.closest<HTMLDivElement>('.pp-pm-type.pp-more-options');\n\t\tif (!$pmType) {\n\t\t\t$qsAll('.secondary-option').forEach($el => {\n\t\t\t\t$el.setAttribute('tabindex', '-1');\n\t\t\t});\n\t\t\t$qs('.pp-pm-more-container')?.classList.add('hide');\n\t\t\treturn;\n\t\t}\n\n\t\t$pmType.querySelector('.pp-pm-more-container')?.classList.toggle('hide');\n\t\tif (!$pmType.querySelector('.pp-pm-more-container')?.classList.contains('hide')) {\n\t\t\t$qsAll('.secondary-option').forEach($el => {\n\t\t\t\t$el.setAttribute('tabindex', '0');\n\t\t\t});\n\t\t}\n\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\n\t\tconst $option = $target?.closest<HTMLLIElement>('li[data-gateway]');\n\t\tif (!$option) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst gatewayId = $option?.dataset['gateway'];\n\n\t\tif (!gatewayId) {\n\t\t\treturn;\n\t\t}\n\n\t\tstore.dispatch(startModalLoading());\n\t\tstore.dispatch(setSelectedPaymentGateway(gatewayId));\n\t\tawait requestCartCalculation();\n\t\tstore.dispatch(stopModalLoading());\n\t});\n}\n\nfunction renderSecondaryOption(context: GatewayEligibilityContext, $el: HTMLDivElement | undefined) {\n\tconst {config, eligibility, displayIndex} = context;\n\tconst isHidden = !eligibility || displayIndex === undefined || displayIndex <= 2;\n\n\tif ($el) {\n\t\t$el.classList.toggle('hide', isHidden);\n\t\t$el.querySelector('img')?.setAttribute('src', config.assets.badge.src);\n\n\t\tconst $span = $el.querySelector('span');\n\t\tif ($span) {\n\t\t\t$span.innerHTML = config.name;\n\t\t}\n\n\t\t// Add element back to the DOM in the new order\n\t\t$qs('.pp-pm-more')?.insertAdjacentElement('beforeend', $el);\n\t} else {\n\t\t$qs('.pp-pm-more')?.insertAdjacentHTML('beforeend', /* html */ `\n\t\t\t<li class=\"secondary-option ${isHidden ? 'hide' : ''}\" data-gateway=\"${config.gatewayId}\" role=\"button\" tabindex=\"-1\">\n\t\t\t\t<img class=\"pp-more-option-badge\" src=\"${config.assets.badge.src}\" draggable=\"false\">\n\t\t\t\t<span>${config.name}</span>\n\t\t\t</li>`,\n\t\t);\n\t}\n}\n\nfunction renderGatewayDescription(context: GatewayEligibilityContext) {\n\tconst isSelected = PaymentConfiguration.selectedGateway() === context.config.gatewayId;\n\tconst isHidden = !isSelected || context.eligibility !== GatewayEligibility.Eligible;\n\n\tconst $el = $qs<HTMLDivElement>(`.pp-pm-saved-option[data-gateway=\"${context.config.gatewayId}\"]`);\n\tif ($el) {\n\t\t$el.classList.toggle('selected', isSelected);\n\t\t$el.parentElement?.classList.toggle('hide', isHidden);\n\t} else {\n\t\t$qs('.pp-pms div.body')?.insertAdjacentHTML('beforeend', `\n\t\t\t<div class=\"${isHidden ? 'hide' : ''}\">\n\t\t\t\t<div class=\"pp-pm-saved-option ${isSelected ? 'selected' : ''}\" data-gateway=\"${context.config.gatewayId}\">\n\t\t\t\t\t${context.config.description}\n\t\t\t\t</div>\n\t\t\t</div>`,\n\t\t);\n\t}\n}\n\nfunction renderEligibilityDescription(config: GatewayConfiguration | null) {\n\tconst $el = $qs<HTMLDivElement>('.currency-fallback-description');\n\n\tif (!config) {\n\t\t$el?.classList.add('hide');\n\t\treturn;\n\t}\n\n\tconst eligibility = PaymentConfiguration.eligibleGateway(config.gatewayId);\n\tconst eligibilityDetails = PaymentConfiguration.eligibleGatewayDetails(config.gatewayId) ?? {};\n\tconst eligibilityExplanations = Object.values(eligibilityDetails).map(detail => detail.explanation).join('<br/>');\n\n\tconst isHidden = eligibility === GatewayEligibility.Eligible;\n\n\tconst defaultCurrency = eligibilityDetails.currency?.fallback_option ?? '';\n\n\tif (isHidden || !eligibilityExplanations) {\n\t\t$el?.classList.add('hide');\n\t\treturn;\n\t}\n\n\tif ($el) {\n\t\t$el.classList.remove('hide');\n\t\t$el.querySelector('img')?.setAttribute('src', config.assets?.title?.src ?? config?.assets.badge.src);\n\t\t$el.querySelectorAll('.name').forEach($span => {\n\t\t\t$span.innerHTML = config.name ?? '';\n\t\t});\n\t\t$el.querySelectorAll('.explanations').forEach($span => {\n\t\t\t$span.innerHTML = eligibilityExplanations ?? '';\n\t\t});\n\n\t\t$el.querySelector('button')?.classList.toggle('hide', !defaultCurrency);\n\t\t$el.querySelector('button')?.setAttribute('data-gateway', config.gatewayId);\n\t\t$el.querySelector('button')?.setAttribute('data-currency', defaultCurrency ?? '');\n\t\t$el.querySelectorAll('button .currency').forEach($span => {\n\t\t\t$span.innerHTML = defaultCurrency ?? '';\n\t\t});\n\t} else {\n\t\t$qs('.pp-pms div.body')?.insertAdjacentHTML('beforeend', `\n\t\t\t<div class=\"pp-pm-saved-option currency-fallback-description\" >\n\t\t\t\t<img style=\"display: block; text-align: left; height: 1.5rem; \" src=\"${config.assets?.title?.src ?? config?.assets.badge.src}\">\n\t\t\t\t<p style=\"text-align: left; margin: 0.5rem 0;\">\n\t\t\t\t\t<span class=\"name\">${config?.name}</span> ${getLocaleText('is not available for checkout.')}\n\t\t\t\t</p>\n\t\t\t\t<hr/>\n\t\t\t\t<p style=\"text-align: left; margin: 0.5rem 0 0;\" class=\"muted explanations\">\n\t\t\t\t\t${eligibilityExplanations}\n\t\t\t\t<p>\n\t\t\t\t<button type=\"button\" class=\"button btn currency-fallback-button ${defaultCurrency ? '' : 'hide'}\" data-gateway=\"${config.gatewayId}\" data-currency=\"${defaultCurrency}\">\n\t\t\t\t\t${getLocaleText('Update currency to')} <span class=\"currency\">${defaultCurrency}</span>\n\t\t\t\t</button>\n\t\t\t</div>`,\n\t\t);\n\t}\n}\n\nexport {initPaymentGatewaySelector};\n","import {store} from '../store';\nimport {Feature, stopModalLoading} from '../reducers/environmentReducer';\nimport {getLocaleText} from '../util/translation';\nimport {startModalLoading} from '../reducers/environmentReducer';\nimport {DefaultCart} from '../reducers/cartReducer';\nimport {MerchantConfiguration} from '../reducers/merchantConfigurationReducer';\nimport {type IRecommendedProduct} from '../models/IRecommendedProducts';\nimport {addProductToCart, cartItemQuantity} from '../util/cart';\nimport {initQuantityChangerEvent} from './quantityChanger';\nimport {$qsAll, $qs} from '../../../@shared/ts/dom';\nimport {FeatureFlag} from '../../../@type/features';\nimport saleImageURL from '../../img/sale.svg';\nimport darkSpinnerImageURL from '../../img/spinner-dark.svg';\nimport plusImageURL from '../../img/plus.svg';\nimport minusImageURL from '../../img/minus.svg';\nimport {renderOrderNotice, requestCartCalculation} from '../payment/order';\n\nexport function initRelatedProducts() {\n\tif (!Feature.enabled(FeatureFlag.RECOMMENDED_PRODUCTS)) {\n\t\treturn;\n\t}\n\n\tlet previousCurrencyData = '';\n\tlet previousCartData = '';\n\n\tstore.subscribe(() => {\n\t\tconst header = Feature.metadata<string>(FeatureFlag.RECOMMENDED_PRODUCTS, 'rp_header')\n\t\t\t? Feature.metadata<string>(FeatureFlag.RECOMMENDED_PRODUCTS, 'rp_header')\n\t\t\t: getLocaleText('Recommended for you');\n\t\tconst recommendedProducts = Feature.dynamicMetadata<IRecommendedProduct[]>(FeatureFlag.RECOMMENDED_PRODUCTS, 'recommended_products');\n\t\tconst cartData = JSON.stringify(DefaultCart.contents());\n\t\tconst currencyData = JSON.stringify(MerchantConfiguration.currency.configuration());\n\n\t\tif (recommendedProducts && recommendedProducts.length > 0 && header) {\n\t\t\tif (cartData !== previousCartData || currencyData !== previousCurrencyData) {\n\t\t\t\tpreviousCartData = cartData;\n\t\t\t\tpreviousCurrencyData = currencyData;\n\t\t\t\trenderRecommendedProductsMiniSlider(recommendedProducts, header);\n\t\t\t}\n\t\t}\n\t});\n\n\t$qsAll('#pp-products-list-related', $el => {\n\t\t$el.addEventListener('scroll', () => {\n\t\t\tconst $elName = $el.id ? '#' + $el.id : '.' + $el.className;\n\t\t\tfadeAdjuster(\n\t\t\t\t$elName,\n\t\t\t\t$el.scrollLeft === 0,\n\t\t\t\tMath.round($el.offsetWidth + $el.scrollLeft) >= $el.scrollWidth,\n\t\t\t);\n\t\t});\n\t});\n}\n\n/**\n * Function for rendering recommended product's mini slider in the checkout window\n * @param relatedProducts Recommended products data\n * @param title Recommended products title\n */\nfunction renderRecommendedProductsMiniSlider(products: IRecommendedProduct[], title: string) {\n\t// For clearing the related product section after each refresh\n\t$qsAll('.pp-related-product-body', $el => {\n\t\t$el.remove();\n\t});\n\t$qs('.pp-rp-spacer')?.remove();\n\t$qs('#pp-related-products-section')?.classList.remove('hide');\n\tfor (const element of $qsAll('.related-products-title')) {\n\t\telement.innerHTML = title;\n\t\telement.classList.remove('hide');\n\t}\n\n\tconst relatedList = $qs('#pp-products-list-related-main');\n\tconst relatedListMobile = $qs('.pp-products-list-related-mobile');\n\tfor (const item of products) {\n\t\tconst isBundleOrVariable = item.bundle || item.variable;\n\t\tconst rpBody = document.createElement('div');\n\t\trpBody.id = String(item.id);\n\t\trpBody.className = 'pp-related-product-body';\n\t\trpBody.innerHTML = `<div class=\"pp-rp-content\">\n\t\t\t\t\t\t\t\t<img class=\"pp-related-product-img ${item.img_src ? '' : 'hide'}\" src=${item.img_src as unknown as string}>\n\t\t\t\t\t\t\t\t<div class=\"flex col\">\n\t\t\t\t\t\t\t\t\t<span class=\"pp-rp-title\">${item.name}</span>\n\t\t\t\t\t\t\t\t\t<div class=\"flex\">\n\t\t\t\t\t\t\t\t\t\t<img src=\"${saleImageURL}\" class=\"${item.sale ? 'pp-rp-sale' : 'hide'}\"></img>\n\t\t\t\t\t\t\t\t\t\t<span class=\"pp-rp-price${(item.sale && !isBundleOrVariable) ? ' pp-rp-price-sale' : (item.sale && isBundleOrVariable) ? ' pp-rp-bv-sale' : ''}\">\n\t\t\t\t\t\t\t\t\t\t\t${isBundleOrVariable ? item.price.replace(' &ndash; ', '<span> - </span>') : item.price}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>`;\n\n\t\tif (item.variable) {\n\t\t\trpBody.append(renderVariationFields(item));\n\t\t}\n\n\t\tconst qtyChanger = renderQuantityChanger(item.id);\n\n\t\tif (qtyChanger) {\n\t\t\trpBody.append(qtyChanger);\n\t\t} else {\n\t\t\trpBody.innerHTML += `<div>\n            ${item.bundle ? `<a href=\"${item.permalink}\" class=\"pp-lp-btn\" target=\"_parent\">${getLocaleText('View options')}</a>`\n\t\t: `<button class=\"pp-lp-btn ${item.variable ? 'pp-js-display' : 'pp-js-add-btn'}\" data-pid=${item.id}>\n                        ${item.variable ? '' : '<span style=\"pointer-events: none;\">+</span>'}\n                        <span style=\"pointer-events: none;\">${item.variable ? getLocaleText('Customize') : getLocaleText('Add')}</span>\n                    </button>`}\n            </div>`;\n\t\t}\n\n\t\trelatedList?.append(rpBody);\n\t\trelatedListMobile?.append(rpBody.cloneNode(true));\n\t}\n\n\tvariationFieldsUI();\n\n\tinitQuantityChangerEvent();\n\n\tfor (const addBtn of $qsAll('.pp-js-add-btn')) {\n\t\taddBtn.addEventListener('click', async event => {\n\t\t\tconst $target = event.target as HTMLInputElement;\n\t\t\tstore.dispatch(startModalLoading());\n\n\t\t\t$target.disabled = true;\n\t\t\tconst targetMarkup = $target.innerHTML;\n\t\t\t$target.innerHTML = `<img src=\"${darkSpinnerImageURL}\" class=\"linked-product-spinner\"/>`;\n\n\t\t\tconst productId = $target.dataset['pid'];\n\t\t\tif (!productId || Number.isNaN(Number(productId))) {\n\t\t\t\trenderOrderNotice(getLocaleText('Something went wrong. Please refresh the page and try again.'));\n\t\t\t}\n\n\t\t\tawait addProductToCart(Number(productId));\n\n\t\t\t$target.disabled = false;\n\t\t\t$target.innerHTML = targetMarkup;\n\n\t\t\t// Note:  Any adding to cart errors will be reported by the cart calculation request as a notice\n\t\t\tawait requestCartCalculation();\n\t\t\tstore.dispatch(stopModalLoading());\n\t\t});\n\t}\n}\n\nfunction fadeAdjuster(elementName: string, isAtLeftEnd: boolean, isAtRightEnd: boolean) {\n\tif (isAtLeftEnd) {\n\t\t$qs(`${elementName}+.pp-rp-fade-left`)?.classList.add('pp-rp-fade-left-hide');\n\t} else {\n\t\t$qs(`${elementName}+.pp-rp-fade-left`)?.classList.remove('pp-rp-fade-left-hide');\n\t}\n\n\tif (isAtRightEnd) {\n\t\t$qs(`${elementName}+.pp-rp-fade-left+.pp-rp-fade-right`)?.classList.add('pp-rp-fade-right-hide');\n\t} else {\n\t\t$qs(`${elementName}+.pp-rp-fade-left+.pp-rp-fade-right`)?.classList.remove('pp-rp-fade-right-hide');\n\t}\n}\n\n/**\n * Renders variation fields and buttons for variable product.\n * @param linkedItem Recommended product\n * @returns DOM element\n */\nfunction renderVariationFields(item: IRecommendedProduct) {\n\tconst formContainer = document.createElement('div');\n\tformContainer.setAttribute('data-pid', (item.id).toString());\n\tformContainer.classList.add('flex', 'col', 'hide', 'pp-lp-form-container');\n\n\tconst variationForm = document.createElement('form');\n\tvariationForm.setAttribute('data-pid', (item.id).toString());\n\tvariationForm.className = 'pp-variation-form';\n\tfor (const attr of item.attributes) {\n\t\tconst container = document.createElement('div');\n\t\tcontainer.className = 'pp-variation-select-field';\n\t\tconst label = document.createElement('label');\n\t\tlabel.setAttribute('for', attr.name);\n\t\tlabel.innerHTML = attr.label;\n\t\tconst select = document.createElement('select');\n\t\tselect.name = 'attribute_' + attr.name;\n\t\tselect.setAttribute('data-attribute_name', 'attribute_' + attr.name);\n\t\tfor (const option of attr.options) {\n\t\t\tconst opt = document.createElement('option');\n\t\t\topt.value = option;\n\t\t\topt.text = option.charAt(0).toUpperCase() + option.slice(1);\n\t\t\tselect.add(opt, null);\n\t\t}\n\n\t\tcontainer.append(label);\n\t\tcontainer.append(select);\n\t\tvariationForm.append(container);\n\t}\n\n\tconst addToCartButton = document.createElement('button');\n\taddToCartButton.classList.add('pp-lp-btn', 'pp-variable-add-btn');\n\taddToCartButton.setAttribute('data-pid', (item.id).toString());\n\taddToCartButton.innerHTML = `<span style=\"pointer-events: none;\">+</span><span style=\"pointer-events: none;\">${getLocaleText('ADD')}</span>`;\n\n\tconst cancelButton = document.createElement('button');\n\tcancelButton.classList.add('pp-variation-cancel-btn', 'pp-js-cancel-btn');\n\tcancelButton.setAttribute('data-pid', (item.id).toString());\n\tcancelButton.innerText = getLocaleText('Close');\n\n\tformContainer.append(variationForm);\n\tformContainer.append(addToCartButton);\n\tformContainer.append(cancelButton);\n\n\treturn formContainer;\n}\n\n/**\n * Check if linked item is in cart, then render the quantity changer button to replace the add button.\n * @param linkedID Linked product's ID\n * @param cart Cart items\n * @returns DOM element\n */\nfunction renderQuantityChanger(id: number) {\n\tconst cart = DefaultCart.contents();\n\tfor (let i = cart.length - 1; i >= 0; i--) {\n\t\tconst item = cart[i];\n\t\tif (item && id === item.product_id) {\n\t\t\tconst $div = document.createElement('div');\n\t\t\t$div.innerHTML += `\n\t\t\t\t<div class=\"pp-quantity-changer\" style=\"justify-content: center;\">\n\t\t\t\t\t<button type=\"button\" class=\"flex-center decrease-qty qty-btn ${cartItemQuantity(item) <= 1 ? 'scroll-end' : ''}\" data-qid=\"${item\n\t.item_key ?? ''}\"><img src=\"${minusImageURL}\" /></button>\n\t\t\t\t\t<input style=\"color: black;\" type=\"number\" min=\"0\" max=\"${item.stock_qty ? item.stock_qty : ''}\" class=\"qty-fs\" value=\"${cartItemQuantity(item)}\" data-qid=\"${item.item_key ?? ''}\" required/>\n\t\t\t\t\t<button type=\"button\" class=\"flex-center increase-qty qty-btn ${(item.stock_qty && cartItemQuantity(item) >= item.stock_qty) ? 'scroll-end' : ''}\" data-qid=\"${item\n\t.item_key ?? ''}\"><img src=\"${plusImageURL}\" /></button>\n\t\t\t\t</div>`;\n\t\t\treturn $div;\n\t\t}\n\t}\n\n\treturn '';\n}\n\n/**\n * For handling UI for variable product.\n */\nfunction variationFieldsUI() {\n\t// For opening the variation form\n\tfor (const button of $qsAll('.pp-js-display')) {\n\t\tbutton.addEventListener('click', event => {\n\t\t\tconst id = (event.target as HTMLElement).dataset['pid'];\n\t\t\tconst container = $qsAll('.pp-lp-form-container[data-pid=\\'' + id + '\\']');\n\t\t\tcontainer?.forEach(element => {\n\t\t\t\telement.classList.remove('hide');\n\t\t\t});\n\t\t\t$qsAll('.pp-js-display[data-pid=\\'' + id + '\\']', element => {\n\t\t\t\telement?.classList.add('hide');\n\t\t\t});\n\t\t});\n\t}\n\n\t// For closing the variation form\n\tfor (const button of $qsAll('.pp-js-cancel-btn')) {\n\t\tbutton.addEventListener('click', event => {\n\t\t\tconst id = (event.target as HTMLElement).dataset['pid'];\n\t\t\tconst container = $qsAll('.pp-lp-form-container[data-pid=\\'' + id + '\\']');\n\t\t\tcontainer?.forEach(element => {\n\t\t\t\telement.classList.add('hide');\n\t\t\t});\n\t\t\t$qsAll('.pp-js-display[data-pid=\\'' + id + '\\']', element => {\n\t\t\t\telement?.classList.remove('hide');\n\t\t\t});\n\t\t});\n\t}\n\n\t// For adding variation product to cart\n\tfor (const variationBtn of $qsAll('.pp-variable-add-btn')) {\n\t\tvariationBtn.addEventListener('click', async event => {\n\t\t\tconst $target = event.target as HTMLInputElement;\n\t\t\tconst productId = Number($target.dataset['pid']);\n\t\t\tconst recommendedProducts = Feature.dynamicMetadata<IRecommendedProduct[]>(FeatureFlag.RECOMMENDED_PRODUCTS, 'recommended_products');\n\n\t\t\tif (!productId || Number.isNaN(productId) || !recommendedProducts || recommendedProducts.length === 0) {\n\t\t\t\trenderOrderNotice(getLocaleText('Something went wrong. Please refresh the page and try again.'));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tstore.dispatch(startModalLoading());\n\t\t\t$target.disabled = true;\n\t\t\tconst targetMarkup = $target.innerHTML;\n\t\t\t$target.innerHTML = `<img src=\"${darkSpinnerImageURL}\" class=\"linked-product-spinner\"/>`;\n\n\t\t\tconst variationForm = $qs<HTMLFormElement>('.pp-variation-form[data-pid=\\'' + productId + '\\']');\n\t\t\tconst variationAttributes = Array.from((variationForm?.elements ?? []) as HTMLInputElement[])\n\t\t\t\t.map(input => [input.name, input.value] satisfies [name:string, value:string ]);\n\n\t\t\tconst variationId = recommendedProducts\n\t\t\t\t.find(product => product.id === productId)?.variations\n\t\t\t\t.find(variation => {\n\t\t\t\t\tfor (const [name, value] of variationAttributes) {\n\t\t\t\t\t\tif (variation.attributes[name] !== value) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\t\t\t\t})\n\t\t\t\t?.variation_id;\n\n\t\t\tawait addProductToCart(productId, 1, {variationId, variationAttributes});\n\n\t\t\t$target.disabled = false;\n\t\t\t$target.innerHTML = targetMarkup;\n\n\t\t\t// Note:  Any adding to cart errors will be reported by the cart calculation request as a notice\n\t\t\tawait requestCartCalculation();\n\t\t\tstore.dispatch(stopModalLoading());\n\t\t});\n\t}\n}\n","import {type ICartMetaData} from '../../../@type/woocommerce/cart-calculation';\nimport {Environment} from '../reducers/environmentReducer';\nimport {getLocaleText} from '../util/translation';\n\n/**\n * Builds a renewing price string If a cart meta data includes subscription information.\n */\nexport function buildSubscriptionPriceMetaData(meta: ICartMetaData, short = false) {\n\tif (!meta.subscription) {\n\t\treturn '';\n\t}\n\n\t/**\n\t * Since the subscription period strings are being displayed in the modal but coming from third party plugin, we need to hardcode these strings' values\n\t * so they can be captured by the gettext parser and be given translations.\n\t */\n\tconst subscriptionPeriodStrings: Record<string, string> = {\n\t\tday: getLocaleText('day'),\n\t\tweek: getLocaleText('week'),\n\t\tmonth: getLocaleText('month'),\n\t\tyear: getLocaleText('year'),\n\t};\n\n\tconst subscriptionPeriod = subscriptionPeriodStrings[meta.subscription.period] ?? meta.subscription.period;\n\n\tif (Number.parseInt(String(meta.subscription.period_interval)) === 1) {\n\t\treturn ` / ${subscriptionPeriod}`;\n\t}\n\n\tif (short) {\n\t\treturn ` every ${meta.subscription.period_interval} ${subscriptionPeriod}s`;\n\t}\n\n\treturn ` every ${meta.subscription.period_interval} ${subscriptionPeriod}s for ${meta.subscription.length} ${subscriptionPeriod}s`;\n}\n\n/**\n * Formats a date string into a subscription first renewal string.\n */\nexport function buildSubscriptionFirstRenewalString(meta: ICartMetaData) {\n\tif (!meta.subscription?.first_renewal) {\n\t\treturn '';\n\t}\n\n\tconst date = new Date(meta.subscription.first_renewal);\n\tconst options: Intl.DateTimeFormatOptions = {\n\t\tyear: 'numeric', // Ex: 2021\n\t\tmonth: 'long', // Ex: July\n\t\tday: 'numeric', // Ex: 12\n\t};\n\n\treturn `${getLocaleText('First renewal')}: ${date.toLocaleString(Environment.language(), options)}`;\n}\n","import {store} from '../store';\nimport {formatCurrencyString} from '../util/currency';\nimport {DefaultCart, cartSummaryViewData} from '../reducers/cartReducer';\nimport {updateMerchantTaxConfig} from '../reducers/merchantConfigurationReducer';\nimport {type ICartMetaData} from '../../../@type/woocommerce/cart-calculation';\nimport {buildSubscriptionFirstRenewalString, buildSubscriptionPriceMetaData} from '../util/subscription';\nimport {$qs, $qsAll} from '../../../@shared/ts/dom';\nimport {getLocaleText} from '../util/translation';\nimport {type CheckoutData} from '../models/CheckoutData';\n\nexport function initSummary(checkoutData: CheckoutData) {\n\tinitSummaryEvents();\n\n\t// Setup tax\n\tstore.dispatch(updateMerchantTaxConfig({\n\t\tdisplayPricesInCartAndCheckout: (checkoutData.wc_tax_price_display === 'incl') ? 'includeTax' : 'excludeTax',\n\t}));\n}\n\nfunction initSummaryEvents() {\n\t// OrderSummaryDropdown has been combined with the code in slideUpView.ts because it is close in format to the existing slide-up views.\n\n\t// Keep summary related rendering up to date.\n\tstore.subscribe(() => {\n\t\trenderSummaries();\n\t\trenderCartTotals();\n\t});\n}\n\n/**\n * Rerenders the subtotal -> total list.\n */\nfunction renderSummaries() {\n\tclearRenderedSummaries();\n\n\tlet cartSummariesHTML = '';\n\n\tfor (const cartKey of Object.keys(store.getState().calculatedCarts)) {\n\t\tlet summaryHTML = '';\n\t\tconst {cartSummary, cartMeta} = cartSummaryViewData(cartKey)();\n\n\t\tconst summaryTitleHTML = cartKey === '0' ? '' : `\n<li class=\"summary-title\">\n\t<div>${getLocaleText('Recurring totals')}</div>\n\t<div></div>\n</li>`;\n\n\t\tfor (const line of cartSummary) {\n\t\t\t// Insert border before total\n\t\t\tsummaryHTML += line === cartSummary[cartSummary.length - 1] ? '<hr>' : '';\n\t\t\tsummaryHTML += renderSummaryLine(line.key, line.value, cartMeta);\n\t\t}\n\n\t\tcartSummariesHTML += `\n<div class=\"cart-summary\" data-cart-key=\"${cartKey}\">\n\t<ul class=\"cart-summary-list\">\n\t\t<hr>\n\t\t${summaryTitleHTML}\n\t\t${summaryHTML}\n\t</ul>\n\t<p class=\"first-renewal muted\">${buildSubscriptionFirstRenewalString(cartMeta)}</p>\n</div>`;\n\t}\n\n\t// New\n\t$qs('#pp-summary-lines-body')?.insertAdjacentHTML('beforeend', cartSummariesHTML);\n\t// Mobile\n\t$qs('#pp-summary-lines-body-mobile')?.insertAdjacentHTML('beforeend', cartSummariesHTML);\n}\n\n/**\n * Clears all existing summary lines from the html dom before rerendering the summary view.\n */\nfunction clearRenderedSummaries() {\n\tfor (const $summary of $qsAll('.cart-summary')) {\n\t\t$summary.remove();\n\t}\n}\n\n/**\n * Renders a single summary line\n * @param name The name of the summary line.\n * @param amount The value of the summary line.\n * @param options Optional css class customization object.\n */\nfunction renderSummaryLine(name: string, amount: number, cartMeta: ICartMetaData): string {\n\tlet priceMetaHTML = '';\n\tif (cartMeta.subscription) {\n\t\tpriceMetaHTML = `<span class=\"muted\">${buildSubscriptionPriceMetaData(cartMeta)}</span>`;\n\t}\n\n\treturn `\n<li class=\"summary-line\" data-raw-cost=\"${amount}\">\n\t<div>${name}</div>\n\t<div class=\"pp-recalculate-blur\" >${formatCurrencyString(amount)}${priceMetaHTML}</div>\n</li>`;\n}\n\n/**\n * Renders the total on the pay button and some other areas.\n */\nfunction renderCartTotals(): void {\n\t// Clear totals.\n\t$qsAll('.pp-summary-total', $element => {\n\t\t$element.innerHTML = '';\n\t});\n\n\t$qsAll('.pp-summary-total', $element => {\n\t\t$element.innerHTML += `<span>${formatCurrencyString(DefaultCart.total())}</span>`;\n\t});\n\n\tif (Object.keys(store.getState().calculatedCarts).length > 1) {\n\t\t$qsAll('.pp-summary-total', $element => {\n\t\t\t$element.innerHTML += `<span class=\"flex pp-gap-2\"><span class=\"muted\"> + </span><span class=\"muted\">${getLocaleText('Recurring')}</span></span>`;\n\t\t});\n\t}\n}\n","/**\n * Checks if the country is part of the European Union\n */\nexport function isEUCountry(countryCode: string): boolean {\n\tconst EUCountries: string[] = ['AT', 'BE', 'BG', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];\n\n\tif (EUCountries.includes(countryCode)) {\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n","import {$qs} from '../../../@shared/ts/dom';\nimport {GLOBAL} from '../deprecated/global';\nimport {type CheckoutData} from '../models/CheckoutData';\nimport {PeachPayCustomer} from '../reducers/peachPayCustomerReducer';\nimport {isEUCountry} from '../util/country';\nimport {getLocaleText} from '../util/translation';\n\nexport function initVAT(checkoutData: CheckoutData) {\n\tinitVatEvents();\n\n\t// Check if self verify is required by vat plugin\n\tif (checkoutData.vat_self_verify === '1') {\n\t\trenderVerifyLocation();\n\t}\n\n\tconst vatTypesRequiringID = checkoutData.vat_required === '1' || (checkoutData.vat_required === '2' && isEUCountry(PeachPayCustomer.shipping.country()));\n\n\tif (vatTypesRequiringID) {\n\t\trenderVATIDInput();\n\t}\n}\n\nfunction initVatEvents() {\n\t$qs('#pp-billing-form')?.addEventListener('submit', (event: Event) => {\n\t\tevent.preventDefault();\n\t\tconst vatTypesRequiringID = GLOBAL.checkoutData?.vat_required === '1' || (GLOBAL.checkoutData?.vat_required === '2' && isEUCountry(PeachPayCustomer.shipping.country()));\n\n\t\tif (vatTypesRequiringID) {\n\t\t\trenderVATIDInput();\n\t\t}\n\t});\n}\n\n/**\n * If vat verification is required this function will render a vat verification textbox in the\n * peachpay modal allowing a deeper integration with EU_Vat\n */\nfunction renderVATIDInput(): void {\n\t// Since we have to place the div depending on the country sometimes remove old div on new cusotmer checkout page\n\tconst $previousDivs = document.querySelector('#newEUVatDiv');\n\t$previousDivs?.remove();\n\n\t// Create Vat input box\n\tconst $EUVatDiv = document.createElement('div');\n\tconst $vatForm = document.createElement('form');\n\tconst $vatNumber = document.createElement('input');\n\t$vatNumber.setAttribute('placeholder', 'required');\n\t$vatNumber.setAttribute('class', 'vat-input');\n\tconst $prompt = document.createElement('span');\n\t$prompt.innerHTML = 'Vat Number';\n\t// Appending all the information to div\n\t$vatForm.append($vatNumber);\n\t$EUVatDiv.append($prompt);\n\t$EUVatDiv.append($vatForm);\n\t$EUVatDiv.setAttribute('id', 'EuVatDiv');\n\t$EUVatDiv.setAttribute('class', 'color-change-text');\n\n\tconst $insertionLocation = document.querySelector('#payment-methods');\n\n\t$vatNumber.setAttribute('id', 'ppVatNumNew');\n\t$EUVatDiv.setAttribute('class', 'x-large');\n\t$EUVatDiv.setAttribute('id', 'newEUVatDiv');\n\t$insertionLocation?.insertAdjacentElement('afterend', $EUVatDiv);\n}\n\n/**\n * Renders a checkbox that allows the user to self verify that their location is indeed the one they reside in\n */\nfunction renderVerifyLocation(): void {\n\tconst $verifyDiv = document.createElement('div');\n\tconst $verifyCheckbox = document.createElement('input');\n\tconst $descriptor = document.createElement('label');\n\t$verifyCheckbox.setAttribute('id', 'pp_verify_country');\n\t$verifyCheckbox.setAttribute('type', 'checkbox');\n\t$verifyCheckbox.setAttribute('value', '1');\n\t$descriptor.setAttribute('for', 'pp_verify_country');\n\t$descriptor.innerHTML = getLocaleText('I verify that the country I have entered is the one I reside in');\n\t$verifyDiv.append($verifyCheckbox);\n\t$verifyDiv.append($descriptor);\n\tconst $divClone = ($verifyDiv.cloneNode(true)) as Element;\n\n\tconst $insertLocation2 = $qs('#payment-methods');\n\t$insertLocation2?.insertAdjacentElement('afterend', $divClone);\n}\n","import {type LoadingMode, type ModalPage} from '../../models/IEnvironment';\nimport {DefaultCart} from '../../reducers/cartReducer';\nimport {Environment} from '../../reducers/environmentReducer';\nimport {store} from '../../store';\nimport {getLocaleText} from '../../util/translation';\nimport {formatCurrencyString} from '../../util/currency';\nimport {PaymentConfiguration} from '../../reducers/paymentConfigurationReducer';\nimport {$qsAll} from '../../../../@shared/ts/dom';\n\n/**\n * This button is reused by several peachpay payment methods.\n */\nexport function setupPeachpayButton() {\n\tstore.subscribe(() => {\n\t\trenderButtonDisplay(\n\t\t\tPaymentConfiguration.selectedGateway(),\n\t\t\tEnvironment.modalUI.page(),\n\t\t\tEnvironment.modalUI.loadingMode(),\n\t\t);\n\n\t\trenderButtonLoading(\n\t\t\tEnvironment.modalUI.loadingMode(),\n\t\t);\n\t});\n}\n\n/**\n * Renders the button display state.\n */\nfunction renderButtonDisplay(gatewayId: string, page: ModalPage, loadingMode: LoadingMode) {\n\t// Show/hide button container\n\tif (['cod', 'bacs', 'cheque', 'peachpay_purchase_order'].includes(gatewayId) && page === 'payment') {\n\t\t$qsAll('.peachpay-integrated-btn-container', $element => {\n\t\t\t$element.classList.remove('hide');\n\t\t});\n\t} else {\n\t\t$qsAll('.peachpay-integrated-btn-container', $element => {\n\t\t\t$element.classList.add('hide');\n\t\t});\n\t}\n\n\t// Hide/Show button\n\tif (loadingMode === 'loading') {\n\t\t$qsAll('.peachpay-integrated-btn', $element => {\n\t\t\t$element.classList.add('hide');\n\t\t});\n\t} else {\n\t\t$qsAll('.peachpay-integrated-btn', $element => {\n\t\t\t$element.classList.remove('hide');\n\t\t});\n\t}\n}\n\n/**\n * Renders the peachpay order button loading state.\n */\nfunction renderButtonLoading(mode: LoadingMode) {\n\t// Show/hide the external spinner\n\tif (mode === 'loading') {\n\t\t$qsAll('.peachpay-integrated-spinner-container', $element => {\n\t\t\t$element.classList.remove('hide');\n\t\t});\n\t} else {\n\t\t$qsAll('.peachpay-integrated-spinner-container', $element => {\n\t\t\t$element.classList.add('hide');\n\t\t});\n\t}\n\n\t// Show/hide the internal spinner\n\tif (mode === 'processing') {\n\t\t$qsAll('.peachpay-integrated-btn-spinner', $element => {\n\t\t\t$element.classList.remove('hide');\n\t\t});\n\t} else {\n\t\t$qsAll('.peachpay-integrated-btn-spinner', $element => {\n\t\t\t$element.classList.add('hide');\n\t\t});\n\t}\n\n\t// Show/hide processing message\n\tif (mode === 'processing') {\n\t\t$qsAll('.peachpay-integrated-btn > .button-text', $element => {\n\t\t\t$element.innerHTML = getLocaleText('Processing');\n\t\t});\n\t} else {\n\t\t$qsAll('.peachpay-integrated-btn > .button-text', $element => {\n\t\t\t$element.innerHTML = `${getLocaleText('Pay')} ${formatCurrencyString(DefaultCart.total())}`;\n\t\t});\n\t}\n\n\t// Enable/disable the button\n\tif (mode === 'finished') {\n\t\t$qsAll<HTMLInputElement>('.peachpay-integrated-btn', $element => {\n\t\t\t$element.disabled = false;\n\t\t});\n\t} else {\n\t\t$qsAll<HTMLInputElement>('.peachpay-integrated-btn', $element => {\n\t\t\t$element.disabled = true;\n\t\t});\n\t}\n}\n","import {displayPaymentErrorMessage, type OrderService} from '../order';\nimport {Feature, stopModalLoading} from '../../reducers/environmentReducer';\nimport {getLocaleText} from '../../util/translation';\nimport {addButtonListener, defaultOrderFlow} from './peachpay';\nimport {$qs} from '../../../../@shared/ts/dom';\nimport {FeatureFlag} from '../../../../@type/features';\nimport purchaseOrderImageURL from '../../../img/marks/purchase-order.svg';\nimport {type GatewayConfiguration} from '../../models/GatewayConfiguration';\nimport {getErrorString} from '../../../../@shared/ts/error';\nimport {store} from '../../store';\n\nexport function initPurchaseOrderSupport(orderService: OrderService) {\n\tif (!Feature.enabled(FeatureFlag.PEACHPAY_PURCHASE_ORDER_GATEWAY)) {\n\t\treturn;\n\t}\n\n\tinjectPurchaseOrderFields();\n\n\taddButtonListener(getPurchaseOrderMethodConfiguration().gatewayId, async event => {\n\t\tconst $form = $qs<HTMLFormElement>('#pp-pms-new form.pp-purchase-order-field');\n\t\tconst $input = $qs<HTMLInputElement>('#pp-pms-new input[name=\"purchase_order_number\"]');\n\n\t\tconst {error: transactionError, result: transaction} = await orderService.startTransaction(getPurchaseOrderMethodConfiguration().gatewayId);\n\t\tif (transactionError || !transaction) {\n\t\t\tconst errorMessage = transactionError ? getErrorString(transactionError) : getLocaleText('An unknown error occured while starting the transaction. Please refresh the page and try again.');\n\t\t\tdisplayPaymentErrorMessage(errorMessage);\n\n\t\t\tstore.dispatch(stopModalLoading());\n\t\t\treturn;\n\t\t}\n\n\t\tif (!$input || !$form) {\n\t\t\tawait transaction.complete({note: 'Failed to find the Purchase Order input and form.'});\n\t\t\treturn;\n\t\t}\n\n\t\tconst purchaseOrderNumber = $input.value;\n\t\tif (!purchaseOrderNumber || !$form.checkValidity()) {\n\t\t\tawait transaction.complete({note: 'Purchase Order number was missing or invalid.'});\n\n\t\t\t$form.reportValidity();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst $target = event.target as HTMLElement | null;\n\t\tconst $button = $target?.closest<HTMLButtonElement>('button');\n\t\tif (!$button) {\n\t\t\tawait transaction.complete({note: 'Purchase Order button was not found.'});\n\t\t\treturn;\n\t\t}\n\n\t\tawait defaultOrderFlow(orderService, transaction, {\n\t\t\tpurchase_order_number: purchaseOrderNumber,\n\t\t});\n\t});\n}\n\nexport function getPurchaseOrderMethodConfiguration(): GatewayConfiguration {\n\treturn {\n\t\tname: getFieldName(),\n\t\tgatewayId: 'peachpay_purchase_order',\n\t\tdescription: `<span>${getDescription()}</span>`,\n\t\tassets: {\n\t\t\ttitle: {src: purchaseOrderImageURL},\n\t\t\tbadge: {src: purchaseOrderImageURL},\n\t\t},\n\t};\n}\n\nfunction injectPurchaseOrderFields() {\n\tconst newCustomerDiv = $qs('#pp-pms-new div.pp-pm-saved-option[data-gateway=\"peachpay_purchase_order\"]');\n\n\tnewCustomerDiv?.insertAdjacentHTML(\n\t\t'beforeend',\n\t\t/* Html */\n\t\t`<form class=\"pp-purchase-order-field\" onsubmit=\"event.preventDefault()\">\n\t\t\t<input id=\"pp-new-purchase-order-input\" name=\"purchase_order_number\" type=\"text\" class=\"text-input\" placeholder=\" \" required>\n\t\t\t<label for=\"pp-new-purchase-order-input\" class=\"pp-form-label\">${getFieldName()}</label>\n\t\t</form>`,\n\t);\n}\n\nfunction getFieldName(): string {\n\treturn Feature.metadata(FeatureFlag.PEACHPAY_PURCHASE_ORDER_GATEWAY, 'field_name') ?? getLocaleText('Purchase order');\n}\n\nfunction getDescription(): string {\n\treturn Feature.metadata(FeatureFlag.PEACHPAY_PURCHASE_ORDER_GATEWAY, 'description') ?? '';\n}\n","import {$qsAll} from '../../../../@shared/ts/dom';\nimport {type LoadingMode} from '../../models/IEnvironment';\nimport {Carts, DefaultCart} from '../../reducers/cartReducer';\nimport {Environment} from '../../reducers/environmentReducer';\nimport {store} from '../../store';\nimport {getLocaleText} from '../../util/translation';\n\nexport function setupFreeOrderButton() {\n\tstore.subscribe(() => {\n\t\trenderFreeOrderButtonDisplay(\n\t\t\tDefaultCart.contents().length,\n\t\t\tCarts.total(),\n\t\t\tEnvironment.modalUI.loadingMode(),\n\t\t);\n\n\t\trenderFreeOrderButtonLoading(\n\t\t\tEnvironment.modalUI.loadingMode(),\n\t\t);\n\t});\n}\n\n/**\n * Renders the free button display state.\n */\nfunction renderFreeOrderButtonDisplay(cartSize: number, allCartsTotal: number, loadingMode: LoadingMode) {\n\t// Hide show button container\n\tif (cartSize > 0 && allCartsTotal === 0) {\n\t\t$qsAll('.free-btn-container', $element => {\n\t\t\t$element.classList.remove('hide');\n\t\t});\n\t} else {\n\t\t$qsAll('.free-btn-container', $element => {\n\t\t\t$element.classList.add('hide');\n\t\t});\n\t}\n\n\t// Hide/Show button\n\tif (loadingMode !== 'loading' && allCartsTotal === 0) {\n\t\t$qsAll('.free-btn', $element => {\n\t\t\t$element.classList.remove('hide');\n\t\t});\n\t} else {\n\t\t$qsAll('.free-btn', $element => {\n\t\t\t$element.classList.add('hide');\n\t\t});\n\t}\n}\n\n/**\n * Renders the free button loading state.\n */\nfunction renderFreeOrderButtonLoading(mode: LoadingMode) {\n\t// Enable/Disable button\n\tif (mode === 'finished') {\n\t\t$qsAll<HTMLInputElement>('.free-btn', $element => {\n\t\t\t$element.disabled = false;\n\t\t});\n\t} else {\n\t\t$qsAll<HTMLInputElement>('.free-btn', $element => {\n\t\t\t$element.disabled = true;\n\t\t});\n\t}\n\n\t// Show/Hide shipping spinner\n\tif (mode === 'loading') {\n\t\t$qsAll('.pp-btn-spinner-container', $element => {\n\t\t\t$element.classList.remove('hide');\n\t\t});\n\t} else {\n\t\t$qsAll('.pp-btn-spinner-container ', $element => {\n\t\t\t$element.classList.add('hide');\n\t\t});\n\t}\n\n\t// Add/Remove Processing message + Payment Spinner\n\tif (mode === 'processing') {\n\t\t$qsAll('.free-btn > .button-text', $element => {\n\t\t\t$element.innerHTML = getLocaleText('Processing');\n\t\t});\n\t\t$qsAll('.free-btn-spinner', $element => {\n\t\t\t$element.classList.remove('hide');\n\t\t});\n\t} else {\n\t\t$qsAll('.free-btn > .button-text', $element => {\n\t\t\t$element.innerHTML = getLocaleText('Place order');\n\t\t});\n\t\t$qsAll('.free-btn-spinner', $element => {\n\t\t\t$element.classList.add('hide');\n\t\t});\n\t}\n}\n","import {type GatewayConfiguration} from '../../models/GatewayConfiguration';\nimport {$qsAll} from '../../../../@shared/ts/dom';\nimport {startModalProcessing, stopModalLoading} from '../../reducers/environmentReducer';\nimport {store} from '../../store';\nimport {displayPaymentErrorMessage, type OrderService} from '../order';\nimport {setupFreeOrderButton} from './button';\nimport {getErrorString} from '../../../../@shared/ts/error';\nimport {getLocaleText} from '../../util/translation';\nimport {PeachPayOrder} from '../../reducers/peachPayOrderReducer';\n\nexport function initFreeOrderSupport(orderService: OrderService) {\n\tconst confirm = async (event: MouseEvent) => {\n\t\tif (!await PeachPayOrder.reportValidity()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst $target = event.target as HTMLElement | null;\n\t\tconst $button = $target?.closest<HTMLButtonElement>('button');\n\t\tif (!$button) {\n\t\t\treturn;\n\t\t}\n\n\t\tawait freeOrderFlow(orderService);\n\t};\n\n\t$qsAll<HTMLElement>('.free-btn', $el => {\n\t\t$el.addEventListener('click', confirm);\n\t});\n\n\tsetupFreeOrderButton();\n}\n\nexport function getFreeMethodConfiguration(): GatewayConfiguration {\n\treturn {\n\t\tname: 'PeachPay Free',\n\t\tdescription: '',\n\t\tgatewayId: 'peachpay_free',\n\t\tassets: {\n\t\t\tbadge: {src: ''},\n\t\t},\n\t};\n}\n\nasync function freeOrderFlow(orderService: OrderService) {\n\tstore.dispatch(startModalProcessing());\n\n\tconst {error: transactionError, result: transaction} = await orderService.startTransaction('peachpay_free');\n\tif (transactionError || !transaction) {\n\t\tconst errorMessage = transactionError ? getErrorString(transactionError) : getLocaleText('An unknown error occured while starting the transaction. Please refresh the page and try again.');\n\t\tdisplayPaymentErrorMessage(errorMessage);\n\n\t\tstore.dispatch(stopModalLoading());\n\t\treturn;\n\t}\n\n\tconst {error: orderError, result: orderResult} = await orderService.placeOrder(transaction);\n\tif (orderError || !orderResult || orderResult.result !== 'success') {\n\t\tstore.dispatch(stopModalLoading());\n\t\treturn;\n\t}\n\n\tif (window.top) {\n\t\tawait transaction.complete({paymentStatus: 'success', orderStatus: 'success'});\n\t\twindow.top.location = orderResult.redirect;\n\t}\n}\n","import {displayPaymentErrorMessage, type OrderService} from '../order';\nimport {type GatewayConfiguration} from '../../models/GatewayConfiguration';\nimport {Feature, stopModalLoading} from '../../reducers/environmentReducer';\nimport {getLocaleText} from '../../util/translation';\nimport {addButtonListener, defaultOrderFlow} from './peachpay';\nimport {FeatureFlag} from '../../../../@type/features';\nimport codImageURL from '../../../img/marks/cash.svg';\nimport {getErrorString} from '../../../../@shared/ts/error';\nimport {store} from '../../store';\n\nexport function initCODSupport(orderService: OrderService) {\n\tif (!Feature.enabled(FeatureFlag.WOOCOMMERCE_COD_GATEWAY)) {\n\t\treturn;\n\t}\n\n\taddButtonListener(getCODMethodConfiguration().gatewayId, async () => {\n\t\tconst {error: transactionError, result: transaction} = await orderService.startTransaction(getCODMethodConfiguration().gatewayId);\n\t\tif (transactionError || !transaction) {\n\t\t\tconst errorMessage = transactionError ? getErrorString(transactionError) : getLocaleText('An unknown error occured while starting the transaction. Please refresh the page and try again.');\n\t\t\tdisplayPaymentErrorMessage(errorMessage);\n\n\t\t\tstore.dispatch(stopModalLoading());\n\t\t\treturn;\n\t\t}\n\n\t\tawait defaultOrderFlow(orderService, transaction);\n\t});\n}\n\nexport function getCODMethodConfiguration(): GatewayConfiguration {\n\treturn {\n\t\tname: getTitle(),\n\t\tgatewayId: 'cod',\n\t\tdescription: getDescription(),\n\t\tassets: {\n\t\t\ttitle: {src: codImageURL},\n\t\t\tbadge: {src: codImageURL},\n\t\t},\n\t};\n}\n\nfunction getTitle(): string {\n\treturn Feature.metadata(FeatureFlag.WOOCOMMERCE_COD_GATEWAY, 'title') ?? getLocaleText('Cheque');\n}\n\nfunction getDescription(): string {\n\tconst description = Feature.metadata<string>(FeatureFlag.WOOCOMMERCE_COD_GATEWAY, 'description') ?? getLocaleText('Pay with a cheque');\n\tconst instructions = Feature.metadata<string>(FeatureFlag.WOOCOMMERCE_COD_GATEWAY, 'instructions') ?? '';\n\tif (instructions) {\n\t\treturn /* html */ `\n\t\t\t<span>${description}</span>\n\t\t\t</br></br>\n\t\t\t<span>${instructions}</span>\n\t\t`;\n\t}\n\n\treturn description;\n}\n","import {displayPaymentErrorMessage, type OrderService} from '../order';\nimport {type GatewayConfiguration} from '../../models/GatewayConfiguration';\nimport {Feature, stopModalLoading} from '../../reducers/environmentReducer';\nimport {getLocaleText} from '../../util/translation';\nimport {addButtonListener, defaultOrderFlow} from './peachpay';\nimport {FeatureFlag} from '../../../../@type/features';\nimport checkImageURL from '../../../img/marks/check.svg';\nimport {getErrorString} from '../../../../@shared/ts/error';\nimport {store} from '../../store';\n\nexport function initChequeSupport(orderService: OrderService) {\n\tif (!Feature.enabled(FeatureFlag.WOOCOMMERCE_CHEQUE_GATEWAY)) {\n\t\treturn;\n\t}\n\n\taddButtonListener(getChequeMethodConfiguration().gatewayId, async () => {\n\t\tconst {error: transactionError, result: transaction} = await orderService.startTransaction(getChequeMethodConfiguration().gatewayId);\n\t\tif (transactionError || !transaction) {\n\t\t\tconst errorMessage = transactionError ? getErrorString(transactionError) : getLocaleText('An unknown error occured while starting the transaction. Please refresh the page and try again.');\n\t\t\tdisplayPaymentErrorMessage(errorMessage);\n\n\t\t\tstore.dispatch(stopModalLoading());\n\t\t\treturn;\n\t\t}\n\n\t\tawait defaultOrderFlow(orderService, transaction);\n\t});\n}\n\nexport function getChequeMethodConfiguration(): GatewayConfiguration {\n\treturn {\n\t\tname: getTitle(),\n\t\tgatewayId: 'cheque',\n\t\tdescription: getDescription(),\n\t\tassets: {\n\t\t\ttitle: {src: checkImageURL},\n\t\t\tbadge: {src: checkImageURL},\n\t\t},\n\t};\n}\n\nfunction getTitle(): string {\n\treturn Feature.metadata(FeatureFlag.WOOCOMMERCE_CHEQUE_GATEWAY, 'title') ?? getLocaleText('Cheque');\n}\n\nfunction getDescription(): string {\n\tconst description = Feature.metadata<string>(FeatureFlag.WOOCOMMERCE_CHEQUE_GATEWAY, 'description') ?? getLocaleText('Pay with a cheque');\n\tconst instructions = Feature.metadata<string>(FeatureFlag.WOOCOMMERCE_CHEQUE_GATEWAY, 'instructions') ?? '';\n\tif (instructions) {\n\t\treturn /* html */ `\n\t\t\t<span>${description}</span>\n\t\t\t</br></br>\n\t\t\t<span>${instructions}</span>\n\t\t`;\n\t}\n\n\treturn description;\n}\n","import {displayPaymentErrorMessage, type OrderService} from '../order';\nimport {type GatewayConfiguration} from '../../models/GatewayConfiguration';\nimport {Feature, stopModalLoading} from '../../reducers/environmentReducer';\nimport {getLocaleText} from '../../util/translation';\nimport {addButtonListener, defaultOrderFlow} from './peachpay';\nimport {FeatureFlag} from '../../../../@type/features';\nimport bacsImageURL from '../../../img/marks/transfer.svg';\nimport {getErrorString} from '../../../../@shared/ts/error';\nimport {store} from '../../store';\n\nexport function initBacsSupport(orderService: OrderService) {\n\tif (!Feature.enabled(FeatureFlag.WOOCOMMERCE_BACS_GATEWAY)) {\n\t\treturn;\n\t}\n\n\taddButtonListener(getBacsMethodConfiguration().gatewayId, async () => {\n\t\tconst {error: transactionError, result: transaction} = await orderService.startTransaction(getBacsMethodConfiguration().gatewayId);\n\t\tif (transactionError || !transaction) {\n\t\t\tconst errorMessage = transactionError ? getErrorString(transactionError) : getLocaleText('An unknown error occured while starting the transaction. Please refresh the page and try again.');\n\t\t\tdisplayPaymentErrorMessage(errorMessage);\n\n\t\t\tstore.dispatch(stopModalLoading());\n\t\t\treturn;\n\t\t}\n\n\t\tawait defaultOrderFlow(orderService, transaction);\n\t});\n}\n\nexport function getBacsMethodConfiguration(): GatewayConfiguration {\n\treturn {\n\t\tname: getTitle(),\n\t\tgatewayId: 'bacs',\n\t\tdescription: getDescription(),\n\t\tassets: {\n\t\t\ttitle: {src: bacsImageURL},\n\t\t\tbadge: {src: bacsImageURL},\n\t\t},\n\t};\n}\n\nfunction getTitle(): string {\n\treturn Feature.metadata(FeatureFlag.WOOCOMMERCE_BACS_GATEWAY, 'title') ?? getLocaleText('Wire/Bank Transfer');\n}\n\nfunction getDescription(): string {\n\tconst description = Feature.metadata<string>(FeatureFlag.WOOCOMMERCE_BACS_GATEWAY, 'description') ?? getLocaleText('Payment via Wire/Bank Transfer');\n\tconst instructions = Feature.metadata<string>(FeatureFlag.WOOCOMMERCE_BACS_GATEWAY, 'instructions') ?? '';\n\tif (instructions) {\n\t\treturn /* html */ `\n\t\t\t<span>${description}</span>\n\t\t\t</br></br>\n\t\t\t<span>${instructions}</span>\n\t\t`;\n\t}\n\n\treturn description;\n}\n","import {Feature, startModalProcessing, stopModalLoading} from '../../reducers/environmentReducer';\nimport {type GatewayConfiguration} from '../../models/GatewayConfiguration';\nimport {type Transaction, type OrderService} from '../order';\nimport {store} from '../../store';\nimport {setupPeachpayButton} from './button';\nimport {PaymentConfiguration, registerGatewayBatch} from '../../reducers/paymentConfigurationReducer';\nimport {getPurchaseOrderMethodConfiguration, initPurchaseOrderSupport} from './purchaseOrder';\nimport {getFreeMethodConfiguration, initFreeOrderSupport} from '../free/free';\nimport {getCODMethodConfiguration, initCODSupport} from './cod';\nimport {getChequeMethodConfiguration, initChequeSupport} from './cheque';\nimport {getBacsMethodConfiguration, initBacsSupport} from './bacs';\nimport {$qsAll} from '../../../../@shared/ts/dom';\nimport {FeatureFlag} from '../../../../@type/features';\n\n/**\n * Here is where peachpay provided payment methods hook into the shared button.\n */\nconst buttonListeners: Record<string, (event: MouseEvent) => void> = {};\n\nexport function initPeachPayMethods(orderService: OrderService) {\n\tsetupPeachpayButton();\n\n\t// Important that methods are registered before init\n\tregisterGateways();\n\n\t// Initialize the methods, these are expected to handle their feature flags on their own.\n\tinitPurchaseOrderSupport(orderService);\n\tinitCODSupport(orderService);\n\tinitChequeSupport(orderService);\n\tinitBacsSupport(orderService);\n\tinitFreeOrderSupport(orderService);\n\n\t$qsAll<HTMLElement>('.peachpay-integrated-btn', $el => {\n\t\t$el.addEventListener('click', (event: MouseEvent) => {\n\t\t\tconst $target = event.target as HTMLElement | null;\n\t\t\tconst $button = $target?.closest<HTMLButtonElement>('button');\n\t\t\tif (!$button) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Run the registered listener for the appropriate payment method\n\t\t\tconst listener = buttonListeners[PaymentConfiguration.selectedGateway()];\n\t\t\tif (listener) {\n\t\t\t\tlistener(event);\n\t\t\t}\n\t\t});\n\t});\n}\n\nexport function addButtonListener(gatewayId: string, listener: (event: MouseEvent) => void) {\n\tbuttonListeners[gatewayId] = listener;\n}\n\nfunction registerGateways() {\n\tconst gatewayConfigurations: Record<string, GatewayConfiguration> = {};\n\n\tif (Feature.enabled(FeatureFlag.PEACHPAY_PURCHASE_ORDER_GATEWAY)) {\n\t\tconst config = getPurchaseOrderMethodConfiguration();\n\t\tgatewayConfigurations[config.gatewayId] = config;\n\t}\n\n\tif (Feature.enabled(FeatureFlag.WOOCOMMERCE_COD_GATEWAY)) {\n\t\tconst config = getCODMethodConfiguration();\n\t\tgatewayConfigurations[config.gatewayId] = config;\n\t}\n\n\tif (Feature.enabled(FeatureFlag.WOOCOMMERCE_CHEQUE_GATEWAY)) {\n\t\tconst config = getChequeMethodConfiguration();\n\t\tgatewayConfigurations[config.gatewayId] = config;\n\t}\n\n\tif (Feature.enabled(FeatureFlag.WOOCOMMERCE_BACS_GATEWAY)) {\n\t\tconst config = getBacsMethodConfiguration();\n\t\tgatewayConfigurations[config.gatewayId] = config;\n\t}\n\n\tconst freeConfig = getFreeMethodConfiguration();\n\tgatewayConfigurations[freeConfig.gatewayId] = freeConfig;\n\n\tstore.dispatch(registerGatewayBatch(gatewayConfigurations));\n}\n\nexport async function defaultOrderFlow(orderService: OrderService, transaction: Transaction, extraFormData: Record<string, string> = {}) {\n\tstore.dispatch(startModalProcessing());\n\n\tconst {error: orderError, result: orderResult} = await orderService.placeOrder(transaction, extraFormData);\n\tif (orderError || !orderResult || orderResult.result !== 'success') {\n\t\tstore.dispatch(stopModalLoading());\n\t\treturn;\n\t}\n\n\tif (window.top) {\n\t\tawait transaction.complete({\n\t\t\tpaymentStatus: 'on-hold',\n\t\t\torderStatus: 'on-hold',\n\t\t});\n\n\t\twindow.top.location = orderResult.redirect;\n\t}\n}\n","declare const __PEACHPAY_GIT_VERSION__: string;\ndeclare const __PEACHPAY_GIT_COMMITHASH__: string;\ndeclare const __PEACHPAY_GIT_BRANCH__: string;\ndeclare const __PEACHPAY_GIT_LASTCOMMITDATETIME__: string;\ndeclare const __PLUGIN_VERSION__: string;\n\nconst VERSION = __PEACHPAY_GIT_VERSION__;\nconst COMMITHASH = __PEACHPAY_GIT_COMMITHASH__;\nconst BRANCH = __PEACHPAY_GIT_BRANCH__;\nconst LASTCOMMITDATETIME = __PEACHPAY_GIT_LASTCOMMITDATETIME__;\n\nconst PLUGIN_VERSION = __PLUGIN_VERSION__;\n\nexport {\n\tVERSION,\n\tCOMMITHASH,\n\tBRANCH,\n\tLASTCOMMITDATETIME,\n\tPLUGIN_VERSION,\n};\n","import {$qs} from '../../../../@shared/ts/dom';\nimport {type CheckoutData} from '../../models/CheckoutData';\nimport {getLocaleText} from '../../util/translation';\nimport {PeachPayCustomer} from '../../reducers/peachPayCustomerReducer';\nimport chevronImageURL from '../../../../../public/img/chevron-down-solid.svg';\n\ntype FieldLocale = {\n\tlabel?: string;\n\trequired?: boolean;\n\thidden?: boolean;\n\t// The below exists but are not used by WC frontend JS. We also do not make\n\t// use them.\n\tplaceholder?: string;\n\tpriority?: number;\n\tclass?: string[];\n\tlabel_class?: string[];\n\tautocomplete?: string;\n\tvalidate?: string[];\n\ttype?: string;\n};\n\n/**\n * Sets up events to adjust the address form fields based on the selected country\n * and locale.\n */\nfunction initFormLocaleEvents(checkoutData: CheckoutData, addressType: 'billing' | 'shipping') {\n\tconst states = JSON.parse(checkoutData.country_state_options) as Record<string, Record<string, string>>;\n\tconst locale = JSON.parse(checkoutData.country_field_locale) as Record<string, Record<string, FieldLocale>>;\n\n\tconst $countryField = $qs<HTMLSelectElement>(`#pp-${addressType}-form [name=\"${addressType}_country\"]`);\n\tif (!$countryField) {\n\t\treturn;\n\t}\n\n\tconst $form = $qs<HTMLFormElement>(`#pp-${addressType}-form`);\n\tif (!$form) {\n\t\tthrow new Error(`Failed to locate the ${addressType} form element using the selector \"#pp-${addressType}-form\"`);\n\t}\n\n\t/**\n\t * Handle rendering the field locale depending on the country value.\n\t *\n\t * Note: The country field may not exist if disabled so this will do nothing\n     * in that case.\n\t */\n\tadjustStateFieldToLocale(addressType, states[$countryField.value]);\n\tadjustAddressFieldsToLocale(addressType, locale[$countryField.value], locale['default']);\n\n\t$countryField.addEventListener('change', () => {\n\t\tconst country = $countryField.value;\n\n\t\tconst stateOptions = states[country];\n\t\tadjustStateFieldToLocale(addressType, stateOptions);\n\n\t\tadjustAddressFieldsToLocale(addressType, locale[country], locale['default']);\n\t});\n}\n\n/**\n * Renders the state field according to the selected country. This will change\n * the state input to be either hidden or visible. It will also convert the input\n * between a text/hidden input and a select input depending on the number of options.\n *\n * This is a copy of the WC logic located at: https://github.com/woocommerce/woocommerce/blob/d30c54ef846b086b96278375b71f7c379d9aa8e8/assets/js/frontend/country-select.js\n */\nfunction adjustStateFieldToLocale(addressType: 'billing' | 'shipping', stateOptions: Record<string, string> | undefined) {\n\tconst $stateContainer = $qs(`#${addressType}_state_field`);\n\tif (!$stateContainer) {\n\t\tthrow new Error(`Failed to locate the ${addressType} state field container element using the selector \"#${addressType}_state_field\"`);\n\t}\n\n\tlet $chevron = $stateContainer.querySelector<HTMLElement>('.pp-form-chevron');\n\tif (!$chevron) {\n\t\t$chevron = document.createElement('div');\n\t\t$chevron.classList.add('pp-form-chevron');\n\t\t$chevron.innerHTML = `<img src=\"${chevronImageURL}\" />`;\n\t\t$stateContainer.append($chevron);\n\t}\n\n\tlet $input = $stateContainer.querySelector<HTMLInputElement | HTMLSelectElement>('input,select');\n\tif (!$input) {\n\t\tthrow new Error(`Failed to locate the ${addressType} state field element using the selector \"#${addressType}_state_field input,select\"`);\n\t}\n\n\tconst inputId = $input.id;\n\tconst inputName = $input.name;\n\tconst inputValue = $input.value;\n\n\tif (stateOptions) {\n\t\tif (Object.keys(stateOptions).length === 0) {\n\t\t\t// Hide state field\n\t\t\t$stateContainer.style.display = 'none';\n\t\t\t$chevron.style.display = 'none';\n\n\t\t\tconst $hiddenInput = document.createElement('input');\n\t\t\t$hiddenInput.type = 'hidden';\n\t\t\t$hiddenInput.name = inputName;\n\t\t\t$hiddenInput.id = inputId;\n\t\t\t$input.replaceWith($hiddenInput);\n\t\t} else {\n\t\t\t// Show state field as a select input\n\t\t\t$stateContainer.style.display = 'flex';\n\t\t\t$chevron.style.display = 'flex';\n\n\t\t\tlet options = '';\n\t\t\tfor (const [stateCode, stateName] of Object.entries(stateOptions)) {\n\t\t\t\toptions += `<option value=\"${stateCode}\" ${stateCode === inputValue ? 'selected' : ''}>${stateName}</option>`;\n\t\t\t}\n\n\t\t\tif ($input.nodeName !== 'SELECT') {\n\t\t\t\tconst $selectInput = document.createElement('select');\n\t\t\t\t$selectInput.id = inputId;\n\t\t\t\t$selectInput.name = inputName;\n\t\t\t\t$selectInput.classList.add('state_select');\n\t\t\t\t$input.replaceWith($selectInput);\n\t\t\t\t$input = $selectInput;\n\t\t\t}\n\n\t\t\t$input.innerHTML = `<option value=\"\">${getLocaleText('Select an option...')}</option>` + options;\n\t\t\t$input.dispatchEvent(new Event('change'));\n\t\t}\n\t} else {\n\t\t// Show the state field as a text input\n\t\t$stateContainer.style.display = 'flex';\n\t\t$chevron.style.display = 'none';\n\n\t\tif ($input.nodeName === 'SELECT' || ($input.nodeName === 'INPUT' && $input.type !== 'text')) {\n\t\t\tconst $textInput = document.createElement('input');\n\t\t\t$textInput.id = inputId;\n\t\t\t$textInput.type = 'text';\n\t\t\t$textInput.name = inputName;\n\t\t\t$textInput.placeholder = ' ';\n\t\t\t$textInput.classList.add('text-input');\n\t\t\t$input.replaceWith($textInput);\n\t\t}\n\t}\n}\n\n/**\n * Adjusts the address fields order, labels, placeholders, etc. to the country\n * locale.\n *\n * This is a copy of the WC logic located at: https://github.com/woocommerce/woocommerce/blob/d30c54ef846b086b96278375b71f7c379d9aa8e8/assets/js/frontend/address-i18n.js\n */\nfunction adjustAddressFieldsToLocale(addressType: 'billing' | 'shipping', countryLocale: Record<string, FieldLocale> | undefined, defaultLocale: Record<string, FieldLocale> | undefined) {\n\tconst fields = [\n\t\t'address_1',\n\t\t'address_2',\n\t\t'state',\n\t\t'postcode',\n\t\t'city',\n\t];\n\n\tfor (const fieldKey of fields) {\n\t\tconst $fieldContainer = $qs(`#${addressType}_${fieldKey}_field`);\n\t\tif (!$fieldContainer) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (countryLocale?.[fieldKey]?.hidden) {\n\t\t\t$fieldContainer.style.display = 'none';\n\t\t\t$fieldContainer.querySelector('input,select')?.setAttribute('disabled', 'disabled');\n\t\t} else {\n\t\t\t$fieldContainer.style.display = 'flex';\n\t\t\t$fieldContainer.querySelector('input,select')?.removeAttribute('disabled');\n\t\t}\n\n\t\t// Adjust label to locale\n\t\tconst updateLabel = (label: string) => {\n\t\t\tconst fieldLabel = $fieldContainer.querySelector('label');\n\t\t\tif (fieldLabel) {\n\t\t\t\tfieldLabel.innerHTML = label;\n\t\t\t}\n\t\t};\n\n\t\tif (countryLocale?.[fieldKey]?.label !== undefined) {\n\t\t\tupdateLabel(countryLocale[fieldKey]!.label!);\n\t\t} else if (defaultLocale?.[fieldKey]?.label !== undefined) {\n\t\t\tupdateLabel(defaultLocale[fieldKey]!.label!);\n\t\t}\n\n\t\tif (countryLocale?.[fieldKey]?.required ?? defaultLocale?.[fieldKey]?.required) {\n\t\t\t$fieldContainer.querySelector('label abbr')?.remove();\n\t\t\t$fieldContainer.querySelector('label')?.insertAdjacentHTML('beforeend', ` <abbr class=\"required\" title=\"${getLocaleText('required')}\">*</abbr>`);\n\t\t\t$fieldContainer.querySelector('input,select')?.setAttribute('required', 'required');\n\t\t} else {\n\t\t\t$fieldContainer.querySelector('label abbr')?.remove();\n\t\t\t$fieldContainer.querySelector('input,select')?.removeAttribute('required');\n\t\t}\n\t}\n}\n\nfunction renderLongAddress(): void {\n\tconst $longAddress = $qs<HTMLSpanElement>('#long-address');\n\n\tif (!$longAddress) {\n\t\tthrow new Error('Failed to locate the long address element using the selector \"#long-address\"');\n\t}\n\n\tif (PeachPayCustomer.shipToDifferentAddress()) {\n\t\t$longAddress.innerText = PeachPayCustomer.shipping.formattedAddress().join('\\n');\n\t} else {\n\t\t$longAddress.innerText = PeachPayCustomer.billing.formattedAddress().join('\\n');\n\t}\n}\n\nexport {\n\tinitFormLocaleEvents,\n\trenderLongAddress,\n};\n","import {$qs} from '../../../../@shared/ts/dom';\nimport {FeatureFlag} from '../../../../@type/features';\nimport {cartCalculationAbortController, requestCartCalculation} from '../../payment/order';\nimport {Carts} from '../../reducers/cartReducer';\nimport {Feature, startModalLoading, stopModalLoading} from '../../reducers/environmentReducer';\nimport {PeachPayOrder} from '../../reducers/peachPayOrderReducer';\nimport {store} from '../../store';\nimport {debounce} from '../../util/debounce';\nimport {gotoPage} from '../modal';\nimport {renderLongAddress} from './addressLocale';\n\nconst BILLING_ADDRESS_FIELDS = [\n\t'billing_address_1',\n\t'billing_address_2',\n\t'billing_city',\n\t'billing_postcode',\n\t'billing_state',\n\t'billing_country',\n];\n\n/**\n * Setup event listeners for the billing form.\n */\nfunction initBillingFormEvents() {\n\tconst $billingForm = $qs<HTMLFormElement>('#pp-billing-form');\n\tif (!$billingForm) {\n\t\tthrow new Error('Failed to locate the billing form element using the selector \"#pp-billing-form\"');\n\t}\n\n\t/**\n     * Handle rendering the long address display that is shown on the shipping\n     * page\n     */\n\t$billingForm.addEventListener('change', () => {\n\t\trenderLongAddress();\n\t});\n\n\t/**\n\t * Handle recalculating the checkout whenever specific billing fields are\n\t * changed. Callback is debounced to reduce multiple requests.\n\t */\n\t$billingForm.addEventListener('change',\n\t\tdebounce(async (e: Event) => {\n\t\t\tconst $target = e.target as HTMLInputElement | null;\n\t\t\tif (!$target) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!BILLING_ADDRESS_FIELDS.includes($target.getAttribute('name') ?? '')) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tstore.dispatch(startModalLoading());\n\t\t\tawait requestCartCalculation();\n\t\t\tstore.dispatch(stopModalLoading());\n\t\t}, 1000, cartCalculationAbortController));\n\n\t/**\n\t * Prevent the form from submitting when the enter key is pressed unless the\n\t * element is a button or textarea.\n\t */\n\t$billingForm.addEventListener('keydown', e => {\n\t\tif (e.key !== 'Enter') {\n\t\t\treturn;\n\t\t}\n\n\t\tconst $target = e.target as HTMLInputElement;\n\t\tif ($target.tagName === 'BUTTON'\n\t\t\t|| $target.tagName === 'TEXTAREA'\n\t\t\t|| ($target.tagName === 'INPUT' && $target.type === 'submit')) {\n\t\t\treturn;\n\t\t}\n\n\t\te.preventDefault();\n\t});\n\n\t/**\n\t * Handle validating the billing fields when the form is submitted. Changes\n\t * to the next valid page if there are no errors.\n\t */\n\t$billingForm.addEventListener('submit', async (event: Event) => {\n\t\tevent.preventDefault();\n\n\t\tif (!await PeachPayOrder.billing.reportValidity()) {\n\t\t\treturn;\n\t\t}\n\n\t\tstore.dispatch(startModalLoading());\n\t\tif (!await gotoPage('shipping')) {\n\t\t\tstore.dispatch(stopModalLoading());\n\t\t\treturn;\n\t\t}\n\n\t\tawait requestCartCalculation();\n\n\t\tstore.dispatch(stopModalLoading());\n\t});\n\n\t/**\n\t * Handle showing/hiding the billing address fields based on whether the\n\t * \"Hide the shipping/billing fields for virtual products\" setting is enabled.\n\t */\n\tif (Feature.enabled(FeatureFlag.VIRTUAL_PRODUCT_FIELDS)) {\n\t\tlet previousIsVirtual = false;\n\t\tstore.subscribe(() => {\n\t\t\tconst isVirtual = !Carts.needsShipping();\n\t\t\tif (previousIsVirtual === isVirtual) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tpreviousIsVirtual = isVirtual;\n\n\t\t\tconst disabledFields = [...BILLING_ADDRESS_FIELDS, 'billing_phone'];\n\n\t\t\tfor (const name of disabledFields) {\n\t\t\t\tconst fieldContainer = $qs<HTMLDivElement>(`#${name}_field`);\n\t\t\t\tconst fieldInput = $qs<HTMLInputElement>(`[name=\"${name}\"]`);\n\n\t\t\t\tif (isVirtual) {\n\t\t\t\t\tfieldContainer?.classList.add('hide');\n\t\t\t\t\tfieldInput?.setAttribute('disabled', 'true');\n\t\t\t\t} else {\n\t\t\t\t\tfieldContainer?.classList.remove('hide');\n\t\t\t\t\tfieldInput?.removeAttribute('disabled');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport {\n\tinitBillingFormEvents,\n};\n","import {store} from '../../store';\nimport {Carts, updateCartPackageShippingMethod} from '../../reducers/cartReducer';\nimport {startModalLoading, stopModalLoading} from '../../reducers/environmentReducer';\nimport {type ICartCalculationRecord, type ICartMetaData, type IShippingMethod, type IShippingPackage} from '../../../../@type/woocommerce/cart-calculation';\nimport {formatCurrencyString} from '../../util/currency';\nimport {requestCartCalculation} from '../../payment/order';\nimport {buildSubscriptionPriceMetaData} from '../../util/subscription';\nimport {getLocaleText} from '../../util/translation';\nimport {$qs, $qsAll} from '../../../../@shared/ts/dom';\nimport {SDKFlags} from '../../sdk';\nimport {PeachPayCustomer} from '../../reducers/peachPayCustomerReducer';\n\nfunction initShippingOptionsFormEvents() {\n\t/**\n     * Handle shipping option selection.\n     */\n\t$qs('#pp-shipping-options')?.addEventListener('change', async (e: Event) => {\n\t\tconst $target = e.target as HTMLInputElement;\n\t\tconst $targetContainer = $target.closest<HTMLElement>('[data-cart-key]');\n\n\t\tconst shippingMethodId = $target.value ?? '';\n\t\tconst cartKey = $targetContainer?.dataset?.['cartKey'] ?? '';\n\t\tconst packageKey = $targetContainer?.dataset?.['packageKey'] ?? '';\n\n\t\tstore.dispatch(updateCartPackageShippingMethod({\n\t\t\tcartKey,\n\t\t\tshippingPackageKey: packageKey,\n\t\t\tpackageMethodId: shippingMethodId,\n\t\t}));\n\n\t\t// Update the tax and other values that may change with different shipping cost.\n\t\tstore.dispatch(startModalLoading());\n\n\t\tawait requestCartCalculation();\n\n\t\tSDKFlags.setRefresh();\n\n\t\tstore.dispatch(stopModalLoading());\n\t});\n\n\t/**\n     * Handle rerendering the shipping options when the cart changes.\n     */\n\tstore.subscribe(() => {\n\t\t$qsAll('.hide-for-virtual-carts').forEach($element => {\n\t\t\t$element.classList.toggle('hide', !Carts.needsShipping());\n\t\t});\n\n\t\t$qsAll('.show-for-virtual-carts').forEach($element => {\n\t\t\t$element.classList.toggle('hide', Carts.needsShipping());\n\t\t});\n\n\t\tif (Carts.needsShipping()) {\n\t\t\trenderCartShippingOptions(store.getState().calculatedCarts);\n\n\t\t\t$qs('#pp-shipping-address-error', $element => {\n\t\t\t\t$element.classList.toggle('hide', Carts.anyShippingMethodsAvailable());\n\n\t\t\t\tif (Carts.anyShippingMethodsAvailable()) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst formattedAddress = PeachPayCustomer.shipToDifferentAddress()\n\t\t\t\t\t? PeachPayCustomer.shipping.formattedAddress()\n\t\t\t\t\t: PeachPayCustomer.billing.formattedAddress();\n\n\t\t\t\t$element.innerHTML = `${getLocaleText('No shipping options were found for')} <strong>${formattedAddress.join(', ')}</strong>. ${getLocaleText('Please ensure that your address has been entered correctly, choose a different shipping address, or contact us if you need any help.')}`;\n\t\t\t});\n\t\t}\n\t});\n}\n\n/**\n * Renders all possible shipping options based on all calculated carts\n */\nfunction renderCartShippingOptions(calculatedCarts: ICartCalculationRecord) {\n\tlet shippingOptionsHTML = '';\n\tfor (const [cartKey, cartCalculation] of Object.entries(calculatedCarts)) {\n\t\tif (!cartCalculation) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tfor (const [shippingPackageKey, shippingPackage] of Object.entries(cartCalculation.package_record)) {\n\t\t\tif (!shippingPackage) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tshippingOptionsHTML += renderShippingPackageOptions(cartKey, shippingPackageKey, shippingPackage, cartCalculation.cart_meta, Object.entries(calculatedCarts).length > 1);\n\t\t}\n\t}\n\n\t$qs('#pp-shipping-options', $element => {\n\t\t$element.innerHTML = shippingOptionsHTML;\n\t});\n}\n\n/**\n * Builds the HTML needed for a single package shipping options.\n */\n// eslint-disable-next-line max-params\nfunction renderShippingPackageOptions(cartKey: string, shippingPackageKey: string, shippingPackage: IShippingPackage, cartMeta: ICartMetaData, shouldShowPackageName: boolean): string {\n\tconst methodOptionBuilder = (methodKey: string, method: IShippingMethod, selected: boolean) => `\n<div class=\"pp-disabled-loading pp-radio-line pp-shipping-option-row${selected ? ' fill' : ''}\" for=\"shipping_method_${shippingPackageKey}_${methodKey.replace(/:/g, '')}\">\n\t<div class=\"pp-shipping-option-bg\"></div>\n\t<input class=\"pp-disabled-loading\" id=\"shipping_method_${shippingPackageKey}_${methodKey.replace(/:/g, '')}\" name=\"shipping_method[${shippingPackageKey}]\" value=\"${methodKey}\" type=\"radio\" ${\n\tselected ? 'checked' : ''\n} required>\n\t${\n\tmethod.description\n\t\t? `<div class=\"flex col w-100\">\n\t\t\t\t<label for=\"shipping_method_${shippingPackageKey}_${methodKey.replace(/:/g, '')}\">\n\t\t\t\t\t<span>${method.title}</span>\n\t\t\t\t\t<span class=\"shipping-price pp-currency-blur\">\n\t\t\t\t\t\t${formatCurrencyString(method.total)}\n\t\t\t\t\t\t<span class=\"muted\">${buildSubscriptionPriceMetaData(cartMeta)}</span>\n\t\t\t\t\t</span>\n\t\t\t\t</label>\n\t\t\t<div>${method.description}</div>\n\t\t</div>`\n\t\t: `<label style=\"width: 100%;\" for=\"shipping_method_${shippingPackageKey}_${methodKey.replace(/:/g, '')}\">\n\t\t\t\t<span>${method.title}</span> <span class=\"shipping-price pp-currency-blur\">${formatCurrencyString(method.total)}\n\t\t\t\t<span class=\"muted\">${buildSubscriptionPriceMetaData(cartMeta)}</span></span>\n\t\t\t\t</label>`\n}\n</div>`;\n\n\t/**\n\t * Since the package name string is being displayed in the modal but coming from Woocommerce, we need to hardcode these strings' values\n\t * so they can be captured by the gettext parser and be given translations.\n\t */\n\tconst packageNameTranslations: Record<string, string> = {\n\t\tShipping: getLocaleText('Shipping'),\n\t\t'Initial Shipment': getLocaleText('Initial Shipment'),\n\t\t'Recurring Shipment': getLocaleText('Recurring Shipment'),\n\t};\n\tconst packageName = packageNameTranslations[shippingPackage.package_name] ?? shippingPackage.package_name;\n\tconst packageNameHTML = `<div class=\"pp-title\">${packageName}</div>`;\n\tconst packageMethodOptionsHTML: string = Object.entries(shippingPackage.methods).map(([shippingMethodKey, shippingMethod]) =>\n\t\tshippingMethod ? methodOptionBuilder(shippingMethodKey, shippingMethod, shippingPackage.selected_method === shippingMethodKey) : '',\n\t).join('');\n\n\treturn `${shouldShowPackageName ? packageNameHTML : ''}\n\t<div class=\"pp-shipping-options-container\" data-cart-key=\"${cartKey}\" data-package-key=\"${shippingPackageKey}\">\n\t${packageMethodOptionsHTML}\n\t</div>`;\n}\n\nexport {\n\tinitShippingOptionsFormEvents,\n};\n","import {GLOBAL} from './deprecated/global';\nimport {initMerchantAccount} from './features/account';\nimport {initAddressAutocomplete} from './features/addressAutocomplete';\nimport {initCart} from './features/cart';\nimport {initCouponInput} from './features/coupon';\nimport {initCurrency} from './features/currency';\nimport {initCurrencySwitcher} from './features/currencySwitch';\nimport {initCustomOrderMessaging} from './features/customOrderMessaging';\nimport {initGiftCardInput} from './features/giftCard';\nimport {initLanguage} from './features/language';\nimport {initMerchantLogo} from './features/merchantLogo';\nimport {initModal} from './features/modal';\nimport {initOneClickUpsell} from './features/oneClickUpsell';\nimport {initPaymentGatewaySelector} from './features/paymentSelector';\nimport {initRelatedProducts} from './features/relatedProducts';\nimport {initSummary} from './features/summary';\nimport {initVAT} from './features/vat';\nimport {initBotProtection} from './features/botProtection';\nimport {consumeCartCalculationResponse, getOrderService, type OrderService} from './payment/order';\nimport {initPeachPayMethods} from './payment/peachpay/peachpay';\nimport {FeatureFlag} from '../../@type/features';\nimport {Feature, setFeatureSupport, startModalLoading, stopModalLoading} from './reducers/environmentReducer';\nimport {store} from './store';\nimport {initSentry} from '../../@shared/ts/sentry';\nimport {PLUGIN_VERSION} from '../../git';\nimport {type CheckoutData} from './models/CheckoutData';\nimport {initSDKEvents} from './sdk';\nimport {initBillingFormEvents} from './features/fields/billingForm';\nimport {initShippingFormEvents} from './features/fields/shippingForm';\nimport {initShippingOptionsFormEvents} from './features/fields/shippingOptionsForm';\nimport {initFormLocaleEvents} from './features/fields/addressLocale';\nimport {doAction} from '../../@shared/ts/hooks';\n\ndeclare const checkout_data: CheckoutData;\n(window as any).store = store;\n\ninitSentry(`peachpay-checkout@${PLUGIN_VERSION}`, 'https://39b5a2e17e264bb5a6ea5abe9bc6cf61@o470066.ingest.sentry.io/5660513');\n\nconst importGateway = {\n\tauthnet: {\n\t\tfeatureFlag: FeatureFlag.AUTHNET_GATEWAY,\n\t\timport_: async () => import('./payment/authnet/authnet'),\n\t},\n\tstripe: {\n\t\tfeatureFlag: FeatureFlag.STRIPE_GATEWAYS,\n\t\timport_: async () => import('./payment/stripe/stripe'),\n\t},\n\tsquare: {\n\t\tfeatureFlag: FeatureFlag.SQUARE_GATEWAYS,\n\t\timport_: async () => import('./payment/square/square'),\n\t},\n\tpaypal: {\n\t\tfeatureFlag: FeatureFlag.PAYPAL_GATEWAYS,\n\t\timport_: async () => import('./payment/paypal/paypal'),\n\t},\n\tpoynt: {\n\t\tfeatureFlag: FeatureFlag.POYNT_GATEWAYS,\n\t\timport_: async () => import('./payment/poynt/poynt'),\n\t},\n} satisfies Record<string, GatewayIntegrationImport>;\n\n/**\n * Entry point for the peachpay checkout.\n */\nasync function main() {\n\tinitSDKEvents();\n\n\tstore.dispatch(startModalLoading());\n\n\tGLOBAL.checkoutData = checkout_data;\n\n\t// We first need to initialize the language for use in the form fields\n\tstore.dispatch(setFeatureSupport(checkout_data.feature_support));\n\tinitLanguage();\n\n\t/**\n\t * Feature callbacks to perform a action or insert data into the redux store once the data is available.\n\t */\n\tinitBillingFormEvents();\n\tinitFormLocaleEvents(checkout_data, 'billing');\n\n\tinitShippingFormEvents();\n\tinitFormLocaleEvents(checkout_data, 'shipping');\n\n\tinitShippingOptionsFormEvents();\n\tinitOneClickUpsell();\n\tinitCart();\n\tinitBotProtection();\n\tinitSummary(checkout_data);\n\tinitCouponInput();\n\tinitGiftCardInput();\n\tinitCurrency(checkout_data);\n\tinitMerchantAccount(checkout_data);\n\tinitVAT(checkout_data);\n\tinitRelatedProducts();\n\tinitCurrencySwitcher();\n\tinitPaymentGatewaySelector();\n\tinitModal(checkout_data);\n\tinitAddressAutocomplete();\n\tinitCustomOrderMessaging();\n\tinitMerchantLogo();\n\n\t// Payment Processor support\n\tconst orderService = getOrderService();\n\n\tinitPeachPayMethods(orderService);\n\n\tconst initPaymentIntegrationResponse = await Promise.allSettled([\n\t\timportPaymentIntegration(importGateway.stripe, orderService),\n\t\timportPaymentIntegration(importGateway.authnet, orderService),\n\t\timportPaymentIntegration(importGateway.square, orderService),\n\t\timportPaymentIntegration(importGateway.paypal, orderService),\n\t\timportPaymentIntegration(importGateway.poynt, orderService),\n\t]);\n\n\tinitPaymentIntegrationResponse.forEach(response => {\n\t\tif (response.status === 'fulfilled') {\n\t\t\treturn;\n\t\t}\n\n\t\tconsole.error(response.reason);\n\t});\n\n\tconsumeCartCalculationResponse(checkout_data.cart_calculation_response);\n\n\twindow.dispatchEvent(new CustomEvent('pp-update-afterpay-branding'));\n\n\tawait doAction('after_modal_open');\n\tstore.dispatch(stopModalLoading());\n}\n\ndocument.addEventListener('DOMContentLoaded', main);\n\ntype GatewayIntegrationImport = {\n\tfeatureFlag: FeatureFlag;\n\timport_: () => Promise<{default: (orderService: OrderService) => Promise<void> | void}>;\n};\n\n/**\n * Import payment dynamically based on given information.\n *\n * @param importGateway\n * @param orderService\n */\nasync function importPaymentIntegration(importGateway: GatewayIntegrationImport, orderService: OrderService) {\n\tif (!Feature.enabled(importGateway.featureFlag)) {\n\t\treturn null;\n\t}\n\n\treturn new Promise((resolve, reject) => {\n\t\timportGateway.import_()\n\t\t\t.then(gateway => {\n\t\t\t\tresolve(gateway.default(orderService));\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tconsole.error(`Failed to import payment integration: ${importGateway.featureFlag}`, e);\n\t\t\t\treject(e);\n\t\t\t});\n\t});\n}\n","import {type IDictionary} from '../../../@type/dictionary';\nimport {updateTranslatedModalTerms} from '../reducers/environmentReducer';\nimport {store} from '../store';\nimport {Feature} from '../reducers/environmentReducer';\nimport {FeatureFlag} from '../../../@type/features';\n\nexport function initLanguage() {\n\tconst translatedModalTerms = Feature.metadata<IDictionary>(FeatureFlag.TRANSLATED_MODAL_TERMS, 'selected_language');\n\tstore.dispatch(updateTranslatedModalTerms(translatedModalTerms ?? {}));\n}\n","import {$qs} from '../../../../@shared/ts/dom';\nimport {cartCalculationAbortController, requestCartCalculation} from '../../payment/order';\nimport {startModalLoading, stopModalLoading} from '../../reducers/environmentReducer';\nimport {PeachPayOrder} from '../../reducers/peachPayOrderReducer';\nimport {store} from '../../store';\nimport {debounce} from '../../util/debounce';\nimport {gotoPage} from '../modal';\nimport {renderLongAddress} from './addressLocale';\n\n/**\n * Setup event listeners for the shipping form.\n */\nfunction initShippingFormEvents() {\n\tconst $shippingFieldset = $qs<HTMLFieldSetElement>('#pp-shipping-fieldset');\n\tif (!$shippingFieldset) {\n\t\tthrow new Error('Failed to locate the shipping fieldset element using the selector \"#pp-shipping-fieldset\"');\n\t}\n\n\tconst $longAddress = $qs<HTMLSpanElement>('#long-address');\n\tif (!$longAddress) {\n\t\tthrow new Error('Failed to locate the long address element using the selector \"#long-address\"');\n\t}\n\n\t/**\n\t * Handle rendering the shipping fields depending on the \"ship_to_different_address\"\n\t * checkbox checked state.\n\t */\n\t$qs('#pp-shipping-form [name=\"ship_to_different_address\"]')?.addEventListener('change', async e => {\n\t\tconst $target = e.target as HTMLInputElement;\n\t\tif (!$target) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ($target.checked) {\n\t\t\t$shippingFieldset.classList.remove('hide');\n\t\t\t$shippingFieldset.disabled = false;\n\n\t\t\t$longAddress.classList.add('hide');\n\t\t} else {\n\t\t\t$shippingFieldset.classList.add('hide');\n\t\t\t$shippingFieldset.disabled = true;\n\n\t\t\t$longAddress.classList.remove('hide');\n\t\t}\n\n\t\trenderLongAddress();\n\n\t\tstore.dispatch(startModalLoading());\n\t\tawait requestCartCalculation();\n\t\tstore.dispatch(stopModalLoading());\n\t});\n\n\tconst $shippingForm = $qs<HTMLFormElement>('#pp-shipping-form');\n\tif (!$shippingForm) {\n\t\tthrow new Error('Failed to locate the shipping form element using the selector \"#pp-shipping-form\"');\n\t}\n\n\t/**\n\t * Handle recalculating the checkout whenever specific shipping fields are\n\t * changed. Callback is debounced to reduce multiple requests.\n\t */\n\t$shippingForm.addEventListener('change',\n\t\tdebounce(async (e: Event) => {\n\t\t\tconst $target = e.target as HTMLInputElement | null;\n\t\t\tif (!$target) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst recalculateOn = [\n\t\t\t\t// For address recalculation\n\t\t\t\t'shipping_address_1',\n\t\t\t\t'shipping_address_2',\n\t\t\t\t'shipping_city',\n\t\t\t\t'shipping_postcode',\n\t\t\t\t'shipping_state',\n\t\t\t\t'shipping_country',\n\t\t\t];\n\n\t\t\tif (!recalculateOn.includes($target.getAttribute('name') ?? '')) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tstore.dispatch(startModalLoading());\n\t\t\tawait requestCartCalculation();\n\t\t\tstore.dispatch(stopModalLoading());\n\t\t}, 1500, cartCalculationAbortController));\n\n\t/**\n\t * Prevent the form from submitting when the enter key is pressed unless the\n\t * element is a button or textarea.\n\t */\n\t$shippingForm.addEventListener('keydown', e => {\n\t\tif (e.key !== 'Enter') {\n\t\t\treturn;\n\t\t}\n\n\t\tconst $target = e.target as HTMLInputElement;\n\t\tif ($target.tagName === 'BUTTON'\n\t\t\t|| $target.tagName === 'TEXTAREA'\n\t\t\t|| ($target.tagName === 'INPUT' && $target.type === 'submit')) {\n\t\t\treturn;\n\t\t}\n\n\t\te.preventDefault();\n\t});\n\n\t/**\n\t * Handle validating the shipping fields when the form is submitted. Changes\n\t * to the next page if there are no errors.\n\t */\n\t$shippingForm.addEventListener('submit', async (event: Event) => {\n\t\tevent.preventDefault();\n\n\t\tif (!await PeachPayOrder.shipping.reportValidity() || !await PeachPayOrder.additional.reportValidity()) {\n\t\t\treturn;\n\t\t}\n\n\t\tstore.dispatch(startModalLoading());\n\t\tif (!await gotoPage('payment')) {\n\t\t\tstore.dispatch(stopModalLoading());\n\t\t\treturn;\n\t\t}\n\n\t\tawait requestCartCalculation();\n\n\t\tstore.dispatch(stopModalLoading());\n\t});\n\n\trenderLongAddress();\n}\n\nexport {\n\tinitShippingFormEvents,\n};\n","import {$qsAll, $qs} from '../../../@shared/ts/dom';\nimport {FeatureFlag} from '../../../@type/features';\nimport {Feature} from '../reducers/environmentReducer';\n\nfunction initMerchantLogo() {\n\tconst logoSrc = Feature.metadata<string>(FeatureFlag.MERCHANT_LOGO, 'logo_src');\n\tif (Feature.enabled(FeatureFlag.MERCHANT_LOGO) && logoSrc) {\n\t\t$qsAll('.pp-merchant-logo-container', $el => {\n\t\t\t$el.insertAdjacentHTML('afterbegin', /* html */ `<img class=\"pp-merchant-logo\" src=\"${logoSrc}\">`);\n\t\t\t$el.style.opacity = '1';\n\t\t\t$el.classList.remove('hide');\n\t\t});\n\n\t\t$qs('#pp-checkout-status-container')?.classList.remove('center');\n\t\t$qs('#pp-checkout-status-container')?.classList.add('merchant-logo');\n\t} else {\n\t\t$qsAll('.pp-merchant-logo-container', $el => {\n\t\t\t$el.style.opacity = '0';\n\t\t});\n\t}\n}\n\nexport {initMerchantLogo};\n"],"names":["inProgress","dataWebpackPrefix","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","Symbol","iterator","v","op","TypeError","pop","push","create","__values","o","m","__read","r","ar","error","__spreadArray","to","from","pack","l","Array","slice","concat","self","ampersandTest","nativeURLSearchParams","URLSearchParams","get","isSupportObjectConstructor","a","toString","decodesPlusesCorrectly","__URLSearchParams__","encodesAmpersandsCorrectly","append","URLSearchParamsPolyfill","iterable","propValue","name","appendTo","dict","has","getAll","set","key","query","encode","join","Proxy","construct","target","args","Function","bind","defineProperty","USPProto","polyfill","forEach","callback","parseToDict","getOwnPropertyNames","sort","k","j","keys","values","items","item","makeIterator","entries","search","str","replace","encodeURIComponent","match","decode","decodeURIComponent","arr","shift","undefined","isArray","indexOf","pairs","split","index","val","JSON","stringify","obj","prop","window","$qs","selector","cb","$element","document","querySelector","$qsAll","querySelectorAll","loadScript","src","scriptWindowObject","$script","createElement","type","onreadystatechange","onload","onerror","head","appendChild","stripHtml","html","preFilterSelector","temporalDivElement","innerHTML","$el","remove","textContent","innerText","trim","isMobile","innerWidth","getErrorString","Error","stack","errorString","getErrorName","_isErrorWithName","actionEvents","addAction","priority","b","doAction","actionList","maybeFetchWP","input","init","regexSelector","fetch","response","text","jsonText","parse","extractedJSONText","exec","console","log","catch","initSentry","release","dsn","isDevelopmentMode","test","location","hostname","Sentry","onLoad","environment","beforeSend","event","hint","originalException","includes","ignoreErrors","captureSentryException","extra","fingerprint","withScope","scope","setExtra","setFingerprint","captureException","initBotProtection","script","enabled","setAttribute","metadata","async","defer","getCaptchaToken","grecaptcha","ready","execute","action","token","handleResponsiveness","ppModalContent","mobileWidth","classList","contains","matchMedia","matches","add","style","height","overflow","removeProperty","openSlideUpView","modalName","backgroundElement","backarrow","scrollIntoView","addEventListener","setTimeout","tapToClose","stopImmediatePropagation","closeSlideUpView","removeEventListener","dropDown","closeCartWithKeyPress","openCartWithKeyPress","openCart","cancelAndClose","formID","modalUI","page","infoFormValidity","checkValidity","hasAttribute","reportValidity","confirm","store","dispatch","preventDefault","renderModalPage","modalPage","buttonShadowClass","renderInfoPageDisplay","renderShippingPageDisplay","renderPaymentPageDisplay","validateCheckout","mode","validateURL","formData","billing","shippingFormData","shipping","additionalFormData","additional","maybe","method","success","error_messages","alert","initModal","checkoutData","prevCurrencyCode","subscribe","loadingMode","terms","merchantTermsConditions","cartCount","allCartsTotal","itemsHeight","shouldSkipShippingPage","renderModalPageIndicator","renderModalNavigation","renderContinueButtonDisplay","renderContinueButtonLoading","currencyChanged","element","ppBlurOnRecalculate","currency","code","wc_terms_conditions","contents","total","$parent","$children","$child","clientHeight","$target","closest","dataset","gotoPage","toPage","changePage","currentPage","targetPage","modalPageType","fromPage","shippingOptions","maybeGotoPage","desiredPage","needsShipping","GatewayEligibility","getOrderService","placeOrder","startTransaction","gatewayId","createPaymentTransaction","transactionId","complete","transactionUpdates","getId","update","options","reduce","pt","ct","updatePaymentTransaction","transaction","extraFormData","checkoutURL","checkoutNonce","dynamicMetadata","selectedGateway","credentials","orderError","orderResult","displayPaymentErrorMessage","note","messages","refresh","reload","requestCartCalculation","errorMessage","cartCalculationAbortController","sync","abort","cartUrl","FormData","email","firstName","lastName","phone","company","address1","address2","city","state","country","postal","shipToDifferentAddress","collectSelectedShipping","packageKey","methodKey","calculationError","calculationResult","consumeCartCalculationResponse","message","notices","pull","cartErrors","errorNotice","renderOrderNotice","notice","setOrderError","data","customer","dispatchEvent","Event","cart_calculation_record","gateway_availability_details","available_gateway_ids","checkEligibleOrFindAlternate","$noticeElement","insertAdjacentElement","paymentGateway","createTransactionURL","json","ok","transaction_id","updateTransactionURL","paymentStatus","orderStatus","responseBody","insertAdjacentHTML","createExpressCheckoutPaymentAttempt","orderService","paymentResult","getTransactionId","getOrderId","order_id","stopLoading","setPaymentMessage","submitOrder","_dataType","extraFields","peachpay_transaction_id","dataURL","URL","redirect","hash","atob","redirectCancel","top","href","cancel_url","redirectSuccess","success_url","createTransaction","completeTransaction","featureEnabled","feature","featureMetadata","cartReducer","payload","newState","cartKey","package_record","packageRecord","shippingPackageKey","selected_method","packageMethodId","updateCartCalculation","updateCartPackageShippingMethod","DefaultCart","selectedShippingMethod","getState","calculatedCarts","selectedShippingMethodDetails","cart","subtotal","summary","feeTotal","fee","fees_record","totalAppliedFees","previousValue","couponTotal","coupon","coupons_record","totalAppliedCoupons","couponRecord","giftCardTotal","giftCard","gift_card_record","totalAppliedGiftCards","totalShipping","total_shipping","totalTax","total_tax","shippingMethods","methods","map","id","Carts","anyShippingMethodsAvailable","calculatedCart","shippingPackage","needs_shipping","subscriptionPresent","cart_meta","subscription","cartSummaryViewData","cartSummary","cartMeta","is_virtual","amount","tax","displayMode","tax_lines","tax_line","parseFloat","environmentReducer","plugin","translated_modal_terms","featureSupport","updateEnvironment","Environment","modalLoading","setFeatureSupport","features","updateTranslatedModalTerms","startModalLoading","startModalProcessing","stopModalLoading","language","documentElement","lang","Feature","flag","feature_metadata","initialState","peachPayOrder","merchantConfiguration","general","symbol","position","thousands_separator","decimal_separator","rounding","number_of_decimals","hidden","shippingZones","displayPricesInCartAndCheckout","paymentConfiguration","availableGateways","gatewayAvailabilityDetails","gatewayConfigurations","createDispatchUpdate","merchantConfigurationReducer","updateMerchantCurrencyConfig","updateMerchantTaxConfig","MerchantConfiguration","wcLocationInfoData","configuration","paymentConfigurationReducer","registerGatewayBatch","setSelectedPaymentGateway","updateAvailableGateways","updateGatewayDetails","PaymentConfiguration","gatewayConfig","eligibleGatewayDetails","config","details","browser","explanation","initialized","sortGatewaysByEligibility","displayIndex","sortedEligibility","eligibility","eligibleGateway","context","selectedContextIndex","findIndex","selectedContext","splice","spliceIndex","NotEligible","availabilityDetails","minimum","maximum","EligibleWithChange","available_options","EligibleButErrored","Eligible","eligibleGatewayCount","count","firstEligibleMethod","gatewayContexts","fieldGetSet","changeEvent","fields","field","nodeName","$select","bubbles","selectedOptions","selectGetSet","$checkbox","checked","checkboxGetSet","$radios","_changeEvent","radioField","radioGetSet","$input","inputGetSet","PeachPayCustomer","fullName","first","last","formattedAddress","formatAddress","postalCountry","administrativeArea","locality","postalCode","organization","addressLines","stripeBillingDetails","address","line1","line2","postal_code","stripeShippingDetails","billingForm","shippingForm","additionalForm","PeachPayOrder","carts","selectedShippingMethodsRecord","rootReducer","render","flags","SDKFlags","getFlags","setRedirect","url","setReload","setRefresh","resetFlags","initSDKEvents","origin","postMessage","closeCheckout","reducer","preloadedState","isDispatching","currentReducer","currentState","currentListeners","nextListeners","listeners","listener","isSubscribed","createStore","capitalizeFirstLetter","string","stringToUpper","String","charAt","toUpperCase","cartItemQuantity","cartItem","quantity","Number","parseInt","bundleQuantityLabel","bundleItemQuantity","is_part_of_bundle","bundle","find","item_key","bundled_by","isNaN","cartItemLabel","formatted_item_data","name_with_variation","variationTitle","attributes","variation_title","cartItemDisplayAmount","is_subscription","stringAmount","subscription_price_string","display_price","price","is_bundle","filter","subItem","subItemPrice","cartItemVariationHTML","metaDataRowsHTML","formattedItemDataHTMLTemplate","variationRowHTML","formattedKey","formattedValue","meta_data","meta","keyText","addProductToCart","productId","addToCartURL","variationAttributes","variationId","headers","Accept","formatCurrencyString","cost","formattedCurrency","negSymbol","formattedCost","formatCostString","Math","abs","thousandsSeparator","decimalSeparator","decimals","numberOfDecimals","ceil","floor","round","toFixed","formattedPrice","currencySplit","centsAmount","reverse","debounce","func","timeout","abortController","timer","onAbort","clearTimeout","eventTarget","EventTarget","createDocumentFragment","getLocaleText","translatedModalTerms","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","getter","__esModule","d","definition","enumerable","chunkId","all","promises","u","miniCssF","globalThis","needAttach","scripts","getElementsByTagName","getAttribute","charset","nc","onScriptComplete","prev","doneFns","parentNode","removeChild","fn","toStringTag","installedChunks","installedChunkData","promise","errorType","realSrc","request","webpackJsonpCallback","parentChunkLoadingFunction","chunkIds","moreModules","runtime","some","chunkLoadingGlobal","support","Blob","viewClasses","isArrayBufferView","ArrayBuffer","isView","normalizeName","toLowerCase","normalizeValue","iteratorFor","Headers","header","consumed","bodyUsed","fileReaderReady","reader","readBlobAsArrayBuffer","blob","FileReader","readAsArrayBuffer","bufferClone","buf","view","Uint8Array","byteLength","buffer","Body","_initBody","_bodyInit","_bodyText","isPrototypeOf","_bodyBlob","_bodyFormData","DataView","_bodyArrayBuffer","arrayBuffer","isConsumed","byteOffset","readAsText","chars","fromCharCode","readArrayBufferAsText","oldValue","Request","upcased","signal","referrer","cache","reParamSearch","Date","getTime","form","bytes","Response","bodyInit","status","statusText","clone","redirectStatuses","RangeError","DOMException","err","constructor","aborted","xhr","XMLHttpRequest","abortXhr","rawHeaders","getAllResponseHeaders","substr","line","parts","responseURL","responseText","ontimeout","onabort","open","fixUrl","withCredentials","responseType","setRequestHeader","readyState","send","h","defineProperties","c","w","q","global","configurable","writable","A","random","setPrototypeOf","__proto__","B","C","D","E","F","G","H","return","J","throw","I","K","L","M","N","O","File","Q","R","S","T","U","navigator","sendBeacon","V","Element","W","lastModified","escape","X","elements","disabled","files","selected","delete","x","_asNative","_blob","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","ownerDocument","Y","MapShim","Map","getIndex","entry","class_1","__entries__","clear","ctx","_i","_a","isBrowser","global$1","requestAnimationFrame$1","requestAnimationFrame","now","transitionKeys","mutationObserverSupported","MutationObserver","ResizeObserverController","connected_","mutationEventsAdded_","mutationsObserver_","observers_","onTransitionEnd_","delay","leadingCall","trailingCall","lastCallTime","resolvePending","proxy","timeoutCallback","timeStamp","throttle","addObserver","observer","connect_","removeObserver","observers","disconnect_","updateObservers_","activeObservers","gatherActive","hasActive","broadcastActive","observe","childList","characterData","subtree","disconnect","_b","propertyName","getInstance","instance_","defineConfigurable","props","getWindowOf","defaultView","emptyRect","createRectInit","toFloat","getBordersSize","styles","positions","size","getHTMLElementContentRect","clientWidth","getComputedStyle","paddings","positions_1","getPaddings","horizPad","left","right","vertPad","bottom","width","boxSizing","isDocumentElement","vertScrollbar","horizScrollbar","isSVGGraphicsElement","SVGGraphicsElement","SVGElement","getBBox","getContentRect","bbox","getSVGContentRect","ResizeObservation","broadcastWidth","broadcastHeight","contentRect_","isActive","rect","broadcastRect","ResizeObserverEntry","rectInit","Constr","contentRect","DOMRectReadOnly","ResizeObserverSPI","controller","callbackCtx","activeObservations_","observations_","callback_","controller_","callbackCtx_","observations","unobserve","clearActive","_this","observation","WeakMap","ResizeObserver","allSettled","mappedPromises","reason","GLOBAL","initMerchantAccount","accountDetails","merchant_customer_account","logged_in","lostPasswordURL","checkout_login_enabled","$form","ajaxURL","loginNonce","loginError","loginResult","htmlString","setupLoginEvents","checkout_registration_enabled","checkout_registration_with_subscription_enabled","usernameHTML","displayed","auto_generate_password","passwordHTML","auto_generate_username","showRegistration","shouldShowRegistration","showRegistrationCheckbox","shouldShowRegistrationCheckbox","showRegistrationCredentials","shouldShowRegistrationCredentials","containerHTML","mountRegistrationHTML","toggleRegistrationCredentialsDisplay","setupRegistrationEvents","previousCartContainsSubscription","unsubscribe","currentCartContainsSubscription","show","toggle","toggleRegistrationDisplay","toggleRegistrationCheckboxDisplay","allow_guest_checkout","removeAttribute","equal","RegExp","source","valueOf","DEFAULT_ID","LoaderStatus","Loader","apiKey","authReferrerPolicy","channel","client","libraries","mapIds","nonce","region","retries","version","instance","isEqual","errors","FAILURE","SUCCESS","loading","LOADING","INITIALIZED","failed","createUrl","deleteScript","getElementById","load","loadPromise","loadCallback","google","importLibrary","maps","callbacks","setScript","params","Set","warn","libraryPromises","library","ErrorEvent","loadErrorCallback","reset","onerrorEvent","resetIfRetryingFailed","initAddressAutocomplete","activeLocations","shouldEnableAddressAutocomplete","autocompleteOptions","types","billingInput","places","Autocomplete","addListener","fillInAddress","getPlace","shippingInput","place","addressType","streetNumber","address_components","component","long_name","route","subpremise","short_name","eventClick","initQuantityChangerEvent","$cartContainer","handleCartContainerEvent","$removeButtons","changeQuantity","once","activeElement","blur","$button","cartItemKey","quantityChangeURL","initCart","previousCartData","previousCurrencyData","cartData","currencyData","$tbody","$tbodyMobile","clearOrderSummary","$message","$cartRow","itemBundle","nextItem","renderCartItem","cloneNode","renderOrderSummaryItems","renderBundleItem","$imgDiv","getImgQtyDiv","$labelDiv","className","$bundleItemTopRow","$amountDiv","$amountP","$amount","$bundleItemSecondRow","$bundleItemInfoDiv","$bundleItem","imageSrc","image","showImage","gap","$imgQtyDiv","$itemInfoContainer","$itemInfo","$removerDiv","$variationInfo","bundleItem","showQuantityChanger","$div","buildQuantityChanger","$qtyContainer","quantityNumber","quantityChanger","stock_qty","clearInput","selectDropdown","initCouponInput","displayCouponFeature","startCouponLoading","applyCoupon","stopCouponLoading","$openCoupon","showCouponInput","handleCouponInputEvents","$removeButton","removeCoupon","handleCouponRemoval","applyCouponURL","applyCouponNonce","hideCouponInput","removeCouponURL","removeCouponNonce","$dd","detectExitTap","initCurrency","renderCurrencySymbols","currency_info","peachpayUpdateCurrencyCookie","newCurrency","cookie","renderCurrencySelector","$removeSelector","$insertionLocationNew","parentElement","$insertionLocationMobile","currencyInfo","buildCurrencySelectDiv","customClasses","$options","defaultOption","list","renderCurrencyList","mappedCurrencies","getCurrencyDropDownInfo","currencyContainer","$currencySelectTitle","$currencySelect","selectContainer","currencyEventListener","sendCurrencySwitchMessage","updateCurrencySwitcherForCountry","countryCSinput","switcherEnabledForCountry","curFeatureState","active_currency","set_cur","updateCurrencySwitcherFeature","refreshCurrencySelected","initCustomOrderMessaging","$a","childrenElements","children","child","tagName","renderCustomOrderMessaging","initGiftCardInput","displayGiftCardFeature","showGiftCardLoadingState","applyGiftCard","hideGiftCardLoadingState","$giftCard","showGiftCardInput","handleGiftcardInputEvents","giftCardNumber","applyGiftcardNonce","defaultErrorMessage","hideGiftCardInput","promptOneClickUpsell","upsellProduct","headline","subHeadline","acceptText","declineText","customDescription","_reject","$container","destroyPrompt","markup","initPaymentGatewaySelector","$pmType","click","setupPrimaryOptionsEvents","stopPropagation","$option","setupSecondaryOptionsEvents","defaultCurrency","setupCurrencyFallbackEvents","sortedEligibilityContext","unmountedElements","acc","unmountedPrimaryElements","renderPrimaryOption","isHidden","renderPrimaryMoreOption","unmountedSecondaryElements","renderSecondaryOption","renderGatewayDescription","eligibilityDetails","eligibilityExplanations","detail","fallback_option","assets","title","badge","$span","renderEligibilityDescription","isSelected","description","initRelatedProducts","recommendedProducts","products","relatedList","relatedListMobile","isBundleOrVariable","variable","rpBody","img_src","sale","renderVariationFields","qtyChanger","renderQuantityChanger","permalink","container","targetMarkup","variationForm","product","variations","variation","variation_id","variationFieldsUI","renderRecommendedProductsMiniSlider","elementName","isAtLeftEnd","isAtRightEnd","fadeAdjuster","scrollLeft","offsetWidth","scrollWidth","formContainer","attr","select","option","opt","addToCartButton","cancelButton","product_id","buildSubscriptionPriceMetaData","short","subscriptionPeriod","day","week","month","year","period","period_interval","buildSubscriptionFirstRenewalString","first_renewal","date","toLocaleString","initSummary","clearRenderedSummaries","cartSummariesHTML","summaryHTML","summaryTitleHTML","renderSummaryLine","renderSummaries","wc_tax_price_display","priceMetaHTML","isEUCountry","countryCode","initVAT","vat_required","renderVATIDInput","vat_self_verify","$verifyDiv","$verifyCheckbox","$descriptor","$divClone","$insertLocation2","renderVerifyLocation","$previousDivs","$EUVatDiv","$vatForm","$vatNumber","$prompt","$insertionLocation","setupPeachpayButton","renderButtonDisplay","renderButtonLoading","initPurchaseOrderSupport","newCustomerDiv","getFieldName","addButtonListener","getPurchaseOrderMethodConfiguration","transactionError","purchaseOrderNumber","defaultOrderFlow","purchase_order_number","setupFreeOrderButton","cartSize","renderFreeOrderButtonDisplay","renderFreeOrderButtonLoading","freeOrderFlow","getCODMethodConfiguration","instructions","getChequeMethodConfiguration","getBacsMethodConfiguration","buttonListeners","initPeachPayMethods","freeConfig","registerGateways","initCODSupport","initChequeSupport","initBacsSupport","initFreeOrderSupport","initFormLocaleEvents","states","country_state_options","locale","country_field_locale","$countryField","adjustStateFieldToLocale","adjustAddressFieldsToLocale","stateOptions","$stateContainer","$chevron","inputId","inputName","inputValue","display","$hiddenInput","replaceWith","stateCode","stateName","$selectInput","$textInput","placeholder","countryLocale","defaultLocale","fieldKey","$fieldContainer","updateLabel","fieldLabel","required","renderLongAddress","$longAddress","BILLING_ADDRESS_FIELDS","initShippingOptionsFormEvents","$targetContainer","shippingMethodId","shippingOptionsHTML","cartCalculation","renderShippingPackageOptions","renderCartShippingOptions","shouldShowPackageName","packageName","Shipping","package_name","packageNameHTML","packageMethodOptionsHTML","shippingMethodKey","shippingMethod","importGateway","authnet","featureFlag","import_","stripe","square","paypal","poynt","importPaymentIntegration","gateway","default","checkout_data","feature_support","$billingForm","isVirtual","disabledFields","fieldContainer","fieldInput","initBillingFormEvents","$shippingFieldset","$shippingForm","initShippingFormEvents","upsellFlow","shownProducts","oneClickUpsell","initOneClickUpsell","logoSrc","opacity","initMerchantLogo","cart_calculation_response","CustomEvent"],"sourceRoot":""}